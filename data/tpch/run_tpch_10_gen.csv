,query,index,c0,c1,t0,t1,error,improvement_whatif,improvement,query_plan_no_index,query_plan_index
0,"



-- using default substitutions


select
	ps_partkey,
	sum(ps_supplycost * ps_availqty) as value
from
	partsupp,
	supplier,
	nation
where
	ps_suppkey = s_suppkey
	and s_nationkey = n_nationkey
	and n_name = 'GERMANY'
group by
	ps_partkey having
		sum(ps_supplycost * ps_availqty) > (
			select
				sum(ps_supplycost * ps_availqty) * 0.0001000000
			from
				partsupp,
				supplier,
				nation
			where
				ps_suppkey = s_suppkey
				and s_nationkey = n_nationkey
				and n_name = 'GERMANY'
		)
order by
	value desc",['I(C partsupp.ps_suppkey)'],498913.66,94778.68,5895.239,1231.118,0.0188624808280656,0.8100298957539066,0.791167414925841,"[{'Plan': {'Node Type': 'Sort', 'Parallel Aware': False, 'Startup Cost': 498673.83, 'Total Cost': 498940.49, 'Plan Rows': 106667, 'Plan Width': 36, 'Sort Key': ['(sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric))) DESC'], 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Finalize', 'Parent Relationship': 'InitPlan', 'Subplan Name': 'InitPlan 1 (returns $1)', 'Parallel Aware': False, 'Startup Cost': 226082.98, 'Total Cost': 226082.99, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 226082.75, 'Total Cost': 226082.96, 'Plan Rows': 2, 'Plan Width': 32, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 225082.75, 'Total Cost': 225082.76, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 3079.09, 'Total Cost': 224082.75, 'Plan Rows': 133333, 'Plan Width': 10, 'Inner Unique': False, 'Hash Cond': '(partsupp_1.ps_suppkey = supplier_1.s_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'partsupp', 'Alias': 'partsupp_1', 'Startup Cost': 0.0, 'Total Cost': 207719.33, 'Plan Rows': 3333333, 'Plan Width': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 3049.68, 'Total Cost': 3049.68, 'Plan Rows': 2353, 'Plan Width': 4, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 1.32, 'Total Cost': 3049.68, 'Plan Rows': 2353, 'Plan Width': 4, 'Inner Unique': False, 'Hash Cond': '(supplier_1.s_nationkey = nation_1.n_nationkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier_1', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.31, 'Total Cost': 1.31, 'Plan Rows': 1, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'nation_1', 'Startup Cost': 0.0, 'Total Cost': 1.31, 'Plan Rows': 1, 'Plan Width': 4, 'Filter': ""(n_name = 'GERMANY'::bpchar)""}]}]}]}]}]}]}]}, {'Node Type': 'Aggregate', 'Strategy': 'Hashed', 'Partial Mode': 'Finalize', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 258082.67, 'Total Cost': 263682.67, 'Plan Rows': 106667, 'Plan Width': 36, 'Group Key': ['partsupp.ps_partkey'], 'Filter': '(sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric)) > $1)', 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 226416.08, 'Total Cost': 254749.35, 'Plan Rows': 266666, 'Plan Width': 36, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Hashed', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 225416.08, 'Total Cost': 227082.75, 'Plan Rows': 133333, 'Plan Width': 36, 'Group Key': ['partsupp.ps_partkey'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 3079.09, 'Total Cost': 224082.75, 'Plan Rows': 133333, 'Plan Width': 14, 'Inner Unique': False, 'Hash Cond': '(partsupp.ps_suppkey = supplier.s_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'partsupp', 'Alias': 'partsupp', 'Startup Cost': 0.0, 'Total Cost': 207719.33, 'Plan Rows': 3333333, 'Plan Width': 18}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 3049.68, 'Total Cost': 3049.68, 'Plan Rows': 2353, 'Plan Width': 4, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 1.32, 'Total Cost': 3049.68, 'Plan Rows': 2353, 'Plan Width': 4, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = nation.n_nationkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.31, 'Total Cost': 1.31, 'Plan Rows': 1, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.0, 'Total Cost': 1.31, 'Plan Rows': 1, 'Plan Width': 4, 'Filter': ""(n_name = 'GERMANY'::bpchar)""}]}]}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 49, 'Options': {'Inlining': False, 'Optimization': False, 'Expressions': True, 'Deforming': True}}}]","[{'Plan': {'Node Type': 'Sort', 'Parallel Aware': False, 'Startup Cost': 94517.51, 'Total Cost': 94784.18, 'Plan Rows': 106667, 'Plan Width': 36, 'Sort Key': ['(sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric))) DESC'], 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Finalize', 'Parent Relationship': 'InitPlan', 'Subplan Name': 'InitPlan 1 (returns $2)', 'Parallel Aware': False, 'Startup Cost': 29652.85, 'Total Cost': 29652.86, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 29652.73, 'Total Cost': 29652.84, 'Plan Rows': 1, 'Plan Width': 32, 'Workers Planned': 1, 'Single Copy': False, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 28652.73, 'Total Cost': 28652.74, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 1.38, 'Total Cost': 27240.97, 'Plan Rows': 188235, 'Plan Width': 10, 'Inner Unique': False, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 1.32, 'Total Cost': 3049.68, 'Plan Rows': 2353, 'Plan Width': 4, 'Inner Unique': False, 'Hash Cond': '(supplier_1.s_nationkey = nation_1.n_nationkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier_1', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.31, 'Total Cost': 1.31, 'Plan Rows': 1, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'nation_1', 'Startup Cost': 0.0, 'Total Cost': 1.31, 'Plan Rows': 1, 'Plan Width': 4, 'Filter': ""(n_name = 'GERMANY'::bpchar)""}]}]}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13411>btree_partsupp_ps_suppkey', 'Relation Name': 'partsupp', 'Alias': 'partsupp_1', 'Startup Cost': 0.06, 'Total Cost': 9.47, 'Plan Rows': 81, 'Plan Width': 14, 'Index Cond': '(ps_suppkey = supplier_1.s_suppkey)'}]}]}]}]}, {'Node Type': 'Aggregate', 'Strategy': 'Hashed', 'Partial Mode': 'Simple', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 50356.48, 'Total Cost': 55956.48, 'Plan Rows': 106667, 'Plan Width': 36, 'Group Key': ['partsupp.ps_partkey'], 'Filter': '(sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric)) > $2)', 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 1.38, 'Total Cost': 44756.48, 'Plan Rows': 320000, 'Plan Width': 14, 'Inner Unique': False, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 1.32, 'Total Cost': 3632.32, 'Plan Rows': 4000, 'Plan Width': 4, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = nation.n_nationkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 3216.0, 'Plan Rows': 100000, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.31, 'Total Cost': 1.31, 'Plan Rows': 1, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.0, 'Total Cost': 1.31, 'Plan Rows': 1, 'Plan Width': 4, 'Filter': ""(n_name = 'GERMANY'::bpchar)""}]}]}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13411>btree_partsupp_ps_suppkey', 'Relation Name': 'partsupp', 'Alias': 'partsupp', 'Startup Cost': 0.06, 'Total Cost': 9.47, 'Plan Rows': 81, 'Plan Width': 18, 'Index Cond': '(ps_suppkey = supplier.s_suppkey)'}]}]}]}}]"
1,"



-- using default substitutions


select
	sum(l_extendedprice* (1 - l_discount)) as revenue
from
	lineitem,
	part
where
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#12'
		and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')
		and l_quantity >= 1 and l_quantity <= 1 + 10
		and p_size between 1 and 5
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#23'
		and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')
		and l_quantity >= 10 and l_quantity <= 10 + 10
		and p_size between 1 and 10
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#34'
		and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')
		and l_quantity >= 20 and l_quantity <= 20 + 10
		and p_size between 1 and 15
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)","['I(C part.p_brand,C part.p_container)']",1953465.08,1914365.89,34203.915,4231.403,-0.856273627547375,0.02001530019671515,0.8762889277440902,"[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 1953502.4, 'Total Cost': 1953502.41, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1953502.18, 'Total Cost': 1953502.39, 'Plan Rows': 2, 'Plan Width': 32, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1952502.18, 'Total Cost': 1952502.19, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 76402.12, 'Total Cost': 1952499.01, 'Plan Rows': 422, 'Plan Width': 12, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Join Filter': '(((part.p_brand = \'Brand#12\'::bpchar) AND (part.p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (lineitem.l_quantity >= \'1\'::numeric) AND (lineitem.l_quantity <= \'11\'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = \'Brand#23\'::bpchar) AND (part.p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (lineitem.l_quantity >= \'10\'::numeric) AND (lineitem.l_quantity <= \'20\'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = \'Brand#34\'::bpchar) AND (part.p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (lineitem.l_quantity >= \'20\'::numeric) AND (lineitem.l_quantity <= \'30\'::numeric) AND (part.p_size <= 15)))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1874367.65, 'Plan Rows': 454972, 'Plan Width': 21, 'Filter': '((l_shipmode = ANY (\'{AIR,""AIR REG""}\'::bpchar[])) AND (l_shipinstruct = \'DELIVER IN PERSON\'::bpchar) AND (((l_quantity >= \'1\'::numeric) AND (l_quantity <= \'11\'::numeric)) OR ((l_quantity >= \'10\'::numeric) AND (l_quantity <= \'20\'::numeric)) OR ((l_quantity >= \'20\'::numeric) AND (l_quantity <= \'30\'::numeric))))'}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 76378.67, 'Total Cost': 76378.67, 'Plan Rows': 1876, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 76378.67, 'Plan Rows': 1876, 'Plan Width': 30, 'Filter': '((p_size >= 1) AND (((p_brand = \'Brand#12\'::bpchar) AND (p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = \'Brand#23\'::bpchar) AND (p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = \'Brand#34\'::bpchar) AND (p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (p_size <= 15))))'}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 21, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]","[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 1914404.17, 'Total Cost': 1914404.18, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1914403.94, 'Total Cost': 1914404.15, 'Plan Rows': 2, 'Plan Width': 32, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1913403.94, 'Total Cost': 1913403.95, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 37303.88, 'Total Cost': 1913400.78, 'Plan Rows': 422, 'Plan Width': 12, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Join Filter': '(((part.p_brand = \'Brand#12\'::bpchar) AND (part.p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (lineitem.l_quantity >= \'1\'::numeric) AND (lineitem.l_quantity <= \'11\'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = \'Brand#23\'::bpchar) AND (part.p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (lineitem.l_quantity >= \'10\'::numeric) AND (lineitem.l_quantity <= \'20\'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = \'Brand#34\'::bpchar) AND (part.p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (lineitem.l_quantity >= \'20\'::numeric) AND (lineitem.l_quantity <= \'30\'::numeric) AND (part.p_size <= 15)))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1874367.65, 'Plan Rows': 454972, 'Plan Width': 21, 'Filter': '((l_shipmode = ANY (\'{AIR,""AIR REG""}\'::bpchar[])) AND (l_shipinstruct = \'DELIVER IN PERSON\'::bpchar) AND (((l_quantity >= \'1\'::numeric) AND (l_quantity <= \'11\'::numeric)) OR ((l_quantity >= \'10\'::numeric) AND (l_quantity <= \'20\'::numeric)) OR ((l_quantity >= \'20\'::numeric) AND (l_quantity <= \'30\'::numeric))))'}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 37280.43, 'Total Cost': 37280.43, 'Plan Rows': 1876, 'Plan Width': 30, 'Plans': [{'Node Type': 'Bitmap Heap Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 934.57, 'Total Cost': 37280.43, 'Plan Rows': 1876, 'Plan Width': 30, 'Recheck Cond': '(((p_brand = \'Brand#12\'::bpchar) AND (p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[]))) OR ((p_brand = \'Brand#23\'::bpchar) AND (p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[]))) OR ((p_brand = \'Brand#34\'::bpchar) AND (p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[]))))', 'Filter': '((p_size >= 1) AND (((p_brand = \'Brand#12\'::bpchar) AND (p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = \'Brand#23\'::bpchar) AND (p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = \'Brand#34\'::bpchar) AND (p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (p_size <= 15))))', 'Plans': [{'Node Type': 'BitmapOr', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 934.57, 'Total Cost': 934.57, 'Plan Rows': 22655, 'Plan Width': 0, 'Plans': [{'Node Type': 'Bitmap Index Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Index Name': '<13411>btree_part_p_brand_p_container', 'Startup Cost': 0.0, 'Total Cost': 317.49, 'Plan Rows': 7728, 'Plan Width': 0, 'Index Cond': '((p_brand = \'Brand#12\'::bpchar) AND (p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])))'}, {'Node Type': 'Bitmap Index Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Index Name': '<13411>btree_part_p_brand_p_container', 'Startup Cost': 0.0, 'Total Cost': 316.89, 'Plan Rows': 7668, 'Plan Width': 0, 'Index Cond': '((p_brand = \'Brand#23\'::bpchar) AND (p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])))'}, {'Node Type': 'Bitmap Index Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Index Name': '<13411>btree_part_p_brand_p_container', 'Startup Cost': 0.0, 'Total Cost': 296.81, 'Plan Rows': 7259, 'Plan Width': 0, 'Index Cond': '((p_brand = \'Brand#34\'::bpchar) AND (p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])))'}]}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 23, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]"
2,"



-- using default substitutions


select
	sum(l_extendedprice* (1 - l_discount)) as revenue
from
	lineitem,
	part
where
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#12'
		and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')
		and l_quantity >= 1 and l_quantity <= 1 + 10
		and p_size between 1 and 5
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#23'
		and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')
		and l_quantity >= 10 and l_quantity <= 10 + 10
		and p_size between 1 and 10
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#34'
		and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')
		and l_quantity >= 20 and l_quantity <= 20 + 10
		and p_size between 1 and 15
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)","['I(C part.p_brand,C part.p_container)', 'I(C lineitem.l_shipmode,C lineitem.l_partkey)']",1953465.08,83532.83,34203.915,209.819,-0.0366270070531982,0.9572386366896305,0.9938656437428287,"[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 1953502.4, 'Total Cost': 1953502.41, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1953502.18, 'Total Cost': 1953502.39, 'Plan Rows': 2, 'Plan Width': 32, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1952502.18, 'Total Cost': 1952502.19, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 76402.12, 'Total Cost': 1952499.01, 'Plan Rows': 422, 'Plan Width': 12, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Join Filter': '(((part.p_brand = \'Brand#12\'::bpchar) AND (part.p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (lineitem.l_quantity >= \'1\'::numeric) AND (lineitem.l_quantity <= \'11\'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = \'Brand#23\'::bpchar) AND (part.p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (lineitem.l_quantity >= \'10\'::numeric) AND (lineitem.l_quantity <= \'20\'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = \'Brand#34\'::bpchar) AND (part.p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (lineitem.l_quantity >= \'20\'::numeric) AND (lineitem.l_quantity <= \'30\'::numeric) AND (part.p_size <= 15)))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1874367.65, 'Plan Rows': 454972, 'Plan Width': 21, 'Filter': '((l_shipmode = ANY (\'{AIR,""AIR REG""}\'::bpchar[])) AND (l_shipinstruct = \'DELIVER IN PERSON\'::bpchar) AND (((l_quantity >= \'1\'::numeric) AND (l_quantity <= \'11\'::numeric)) OR ((l_quantity >= \'10\'::numeric) AND (l_quantity <= \'20\'::numeric)) OR ((l_quantity >= \'20\'::numeric) AND (l_quantity <= \'30\'::numeric))))'}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 76378.67, 'Total Cost': 76378.67, 'Plan Rows': 1876, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 76378.67, 'Plan Rows': 1876, 'Plan Width': 30, 'Filter': '((p_size >= 1) AND (((p_brand = \'Brand#12\'::bpchar) AND (p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = \'Brand#23\'::bpchar) AND (p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = \'Brand#34\'::bpchar) AND (p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (p_size <= 15))))'}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 21, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]","[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 83532.82, 'Total Cost': 83532.83, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 83532.6, 'Total Cost': 83532.81, 'Plan Rows': 2, 'Plan Width': 32, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 82532.6, 'Total Cost': 82532.61, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 934.63, 'Total Cost': 82529.43, 'Plan Rows': 422, 'Plan Width': 12, 'Inner Unique': False, 'Plans': [{'Node Type': 'Bitmap Heap Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 934.57, 'Total Cost': 37280.43, 'Plan Rows': 1876, 'Plan Width': 30, 'Recheck Cond': '(((p_brand = \'Brand#12\'::bpchar) AND (p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[]))) OR ((p_brand = \'Brand#23\'::bpchar) AND (p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[]))) OR ((p_brand = \'Brand#34\'::bpchar) AND (p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[]))))', 'Filter': '((p_size >= 1) AND (((p_brand = \'Brand#12\'::bpchar) AND (p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = \'Brand#23\'::bpchar) AND (p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = \'Brand#34\'::bpchar) AND (p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (p_size <= 15))))', 'Plans': [{'Node Type': 'BitmapOr', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 934.57, 'Total Cost': 934.57, 'Plan Rows': 22655, 'Plan Width': 0, 'Plans': [{'Node Type': 'Bitmap Index Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Index Name': '<13411>btree_part_p_brand_p_container', 'Startup Cost': 0.0, 'Total Cost': 317.49, 'Plan Rows': 7728, 'Plan Width': 0, 'Index Cond': '((p_brand = \'Brand#12\'::bpchar) AND (p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])))'}, {'Node Type': 'Bitmap Index Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Index Name': '<13411>btree_part_p_brand_p_container', 'Startup Cost': 0.0, 'Total Cost': 316.89, 'Plan Rows': 7668, 'Plan Width': 0, 'Index Cond': '((p_brand = \'Brand#23\'::bpchar) AND (p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])))'}, {'Node Type': 'Bitmap Index Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Index Name': '<13411>btree_part_p_brand_p_container', 'Startup Cost': 0.0, 'Total Cost': 296.81, 'Plan Rows': 7259, 'Plan Width': 0, 'Index Cond': '((p_brand = \'Brand#34\'::bpchar) AND (p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])))'}]}]}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13412>btree_lineitem_l_shipmode_l_partkey', 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.07, 'Total Cost': 24.11, 'Plan Rows': 1, 'Plan Width': 21, 'Index Cond': '((l_shipmode = ANY (\'{AIR,""AIR REG""}\'::bpchar[])) AND (l_partkey = part.p_partkey))', 'Filter': '((l_shipinstruct = \'DELIVER IN PERSON\'::bpchar) AND (((l_quantity >= \'1\'::numeric) AND (l_quantity <= \'11\'::numeric)) OR ((l_quantity >= \'10\'::numeric) AND (l_quantity <= \'20\'::numeric)) OR ((l_quantity >= \'20\'::numeric) AND (l_quantity <= \'30\'::numeric))) AND (((part.p_brand = \'Brand#12\'::bpchar) AND (part.p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (l_quantity >= \'1\'::numeric) AND (l_quantity <= \'11\'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = \'Brand#23\'::bpchar) AND (part.p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (l_quantity >= \'10\'::numeric) AND (l_quantity <= \'20\'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = \'Brand#34\'::bpchar) AND (part.p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (l_quantity >= \'20\'::numeric) AND (l_quantity <= \'30\'::numeric) AND (part.p_size <= 15))))'}]}]}]}]}}]"
3,"



-- using default substitutions


select
	sum(l_extendedprice* (1 - l_discount)) as revenue
from
	lineitem,
	part
where
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#12'
		and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')
		and l_quantity >= 1 and l_quantity <= 1 + 10
		and p_size between 1 and 5
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#23'
		and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')
		and l_quantity >= 10 and l_quantity <= 10 + 10
		and p_size between 1 and 10
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#34'
		and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')
		and l_quantity >= 20 and l_quantity <= 20 + 10
		and p_size between 1 and 15
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)","['I(C part.p_brand,C part.p_container)', 'I(C part.p_container,C part.p_size)']",1953465.08,1914404.18,34203.915,4098.032,-0.8601925190903771,0.01999569912967174,0.8801882182200488,"[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 1953502.4, 'Total Cost': 1953502.41, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1953502.18, 'Total Cost': 1953502.39, 'Plan Rows': 2, 'Plan Width': 32, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1952502.18, 'Total Cost': 1952502.19, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 76402.12, 'Total Cost': 1952499.01, 'Plan Rows': 422, 'Plan Width': 12, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Join Filter': '(((part.p_brand = \'Brand#12\'::bpchar) AND (part.p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (lineitem.l_quantity >= \'1\'::numeric) AND (lineitem.l_quantity <= \'11\'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = \'Brand#23\'::bpchar) AND (part.p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (lineitem.l_quantity >= \'10\'::numeric) AND (lineitem.l_quantity <= \'20\'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = \'Brand#34\'::bpchar) AND (part.p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (lineitem.l_quantity >= \'20\'::numeric) AND (lineitem.l_quantity <= \'30\'::numeric) AND (part.p_size <= 15)))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1874367.65, 'Plan Rows': 454972, 'Plan Width': 21, 'Filter': '((l_shipmode = ANY (\'{AIR,""AIR REG""}\'::bpchar[])) AND (l_shipinstruct = \'DELIVER IN PERSON\'::bpchar) AND (((l_quantity >= \'1\'::numeric) AND (l_quantity <= \'11\'::numeric)) OR ((l_quantity >= \'10\'::numeric) AND (l_quantity <= \'20\'::numeric)) OR ((l_quantity >= \'20\'::numeric) AND (l_quantity <= \'30\'::numeric))))'}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 76378.67, 'Total Cost': 76378.67, 'Plan Rows': 1876, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 76378.67, 'Plan Rows': 1876, 'Plan Width': 30, 'Filter': '((p_size >= 1) AND (((p_brand = \'Brand#12\'::bpchar) AND (p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = \'Brand#23\'::bpchar) AND (p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = \'Brand#34\'::bpchar) AND (p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (p_size <= 15))))'}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 21, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]","[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 1914404.17, 'Total Cost': 1914404.18, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1914403.94, 'Total Cost': 1914404.15, 'Plan Rows': 2, 'Plan Width': 32, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1913403.94, 'Total Cost': 1913403.95, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 37303.88, 'Total Cost': 1913400.78, 'Plan Rows': 422, 'Plan Width': 12, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Join Filter': '(((part.p_brand = \'Brand#12\'::bpchar) AND (part.p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (lineitem.l_quantity >= \'1\'::numeric) AND (lineitem.l_quantity <= \'11\'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = \'Brand#23\'::bpchar) AND (part.p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (lineitem.l_quantity >= \'10\'::numeric) AND (lineitem.l_quantity <= \'20\'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = \'Brand#34\'::bpchar) AND (part.p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (lineitem.l_quantity >= \'20\'::numeric) AND (lineitem.l_quantity <= \'30\'::numeric) AND (part.p_size <= 15)))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1874367.65, 'Plan Rows': 454972, 'Plan Width': 21, 'Filter': '((l_shipmode = ANY (\'{AIR,""AIR REG""}\'::bpchar[])) AND (l_shipinstruct = \'DELIVER IN PERSON\'::bpchar) AND (((l_quantity >= \'1\'::numeric) AND (l_quantity <= \'11\'::numeric)) OR ((l_quantity >= \'10\'::numeric) AND (l_quantity <= \'20\'::numeric)) OR ((l_quantity >= \'20\'::numeric) AND (l_quantity <= \'30\'::numeric))))'}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 37280.43, 'Total Cost': 37280.43, 'Plan Rows': 1876, 'Plan Width': 30, 'Plans': [{'Node Type': 'Bitmap Heap Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 934.57, 'Total Cost': 37280.43, 'Plan Rows': 1876, 'Plan Width': 30, 'Recheck Cond': '(((p_brand = \'Brand#12\'::bpchar) AND (p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[]))) OR ((p_brand = \'Brand#23\'::bpchar) AND (p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[]))) OR ((p_brand = \'Brand#34\'::bpchar) AND (p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[]))))', 'Filter': '((p_size >= 1) AND (((p_brand = \'Brand#12\'::bpchar) AND (p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = \'Brand#23\'::bpchar) AND (p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = \'Brand#34\'::bpchar) AND (p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (p_size <= 15))))', 'Plans': [{'Node Type': 'BitmapOr', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 934.57, 'Total Cost': 934.57, 'Plan Rows': 22655, 'Plan Width': 0, 'Plans': [{'Node Type': 'Bitmap Index Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Index Name': '<13411>btree_part_p_brand_p_container', 'Startup Cost': 0.0, 'Total Cost': 317.49, 'Plan Rows': 7728, 'Plan Width': 0, 'Index Cond': '((p_brand = \'Brand#12\'::bpchar) AND (p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])))'}, {'Node Type': 'Bitmap Index Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Index Name': '<13411>btree_part_p_brand_p_container', 'Startup Cost': 0.0, 'Total Cost': 316.89, 'Plan Rows': 7668, 'Plan Width': 0, 'Index Cond': '((p_brand = \'Brand#23\'::bpchar) AND (p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])))'}, {'Node Type': 'Bitmap Index Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Index Name': '<13411>btree_part_p_brand_p_container', 'Startup Cost': 0.0, 'Total Cost': 296.81, 'Plan Rows': 7259, 'Plan Width': 0, 'Index Cond': '((p_brand = \'Brand#34\'::bpchar) AND (p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])))'}]}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 23, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]"
4,"



-- using default substitutions


select
	sum(l_extendedprice* (1 - l_discount)) as revenue
from
	lineitem,
	part
where
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#12'
		and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')
		and l_quantity >= 1 and l_quantity <= 1 + 10
		and p_size between 1 and 5
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#23'
		and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')
		and l_quantity >= 10 and l_quantity <= 10 + 10
		and p_size between 1 and 10
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#34'
		and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')
		and l_quantity >= 20 and l_quantity <= 20 + 10
		and p_size between 1 and 15
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)","['I(C part.p_brand,C part.p_container)', 'I(C part.p_brand)']",1953465.08,1914404.18,34203.915,3948.809,-0.864555265284782,0.01999569912967174,0.8845509644144537,"[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 1953502.4, 'Total Cost': 1953502.41, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1953502.18, 'Total Cost': 1953502.39, 'Plan Rows': 2, 'Plan Width': 32, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1952502.18, 'Total Cost': 1952502.19, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 76402.12, 'Total Cost': 1952499.01, 'Plan Rows': 422, 'Plan Width': 12, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Join Filter': '(((part.p_brand = \'Brand#12\'::bpchar) AND (part.p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (lineitem.l_quantity >= \'1\'::numeric) AND (lineitem.l_quantity <= \'11\'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = \'Brand#23\'::bpchar) AND (part.p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (lineitem.l_quantity >= \'10\'::numeric) AND (lineitem.l_quantity <= \'20\'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = \'Brand#34\'::bpchar) AND (part.p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (lineitem.l_quantity >= \'20\'::numeric) AND (lineitem.l_quantity <= \'30\'::numeric) AND (part.p_size <= 15)))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1874367.65, 'Plan Rows': 454972, 'Plan Width': 21, 'Filter': '((l_shipmode = ANY (\'{AIR,""AIR REG""}\'::bpchar[])) AND (l_shipinstruct = \'DELIVER IN PERSON\'::bpchar) AND (((l_quantity >= \'1\'::numeric) AND (l_quantity <= \'11\'::numeric)) OR ((l_quantity >= \'10\'::numeric) AND (l_quantity <= \'20\'::numeric)) OR ((l_quantity >= \'20\'::numeric) AND (l_quantity <= \'30\'::numeric))))'}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 76378.67, 'Total Cost': 76378.67, 'Plan Rows': 1876, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 76378.67, 'Plan Rows': 1876, 'Plan Width': 30, 'Filter': '((p_size >= 1) AND (((p_brand = \'Brand#12\'::bpchar) AND (p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = \'Brand#23\'::bpchar) AND (p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = \'Brand#34\'::bpchar) AND (p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (p_size <= 15))))'}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 21, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]","[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 1914404.17, 'Total Cost': 1914404.18, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1914403.94, 'Total Cost': 1914404.15, 'Plan Rows': 2, 'Plan Width': 32, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1913403.94, 'Total Cost': 1913403.95, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 37303.88, 'Total Cost': 1913400.78, 'Plan Rows': 422, 'Plan Width': 12, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Join Filter': '(((part.p_brand = \'Brand#12\'::bpchar) AND (part.p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (lineitem.l_quantity >= \'1\'::numeric) AND (lineitem.l_quantity <= \'11\'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = \'Brand#23\'::bpchar) AND (part.p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (lineitem.l_quantity >= \'10\'::numeric) AND (lineitem.l_quantity <= \'20\'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = \'Brand#34\'::bpchar) AND (part.p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (lineitem.l_quantity >= \'20\'::numeric) AND (lineitem.l_quantity <= \'30\'::numeric) AND (part.p_size <= 15)))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1874367.65, 'Plan Rows': 454972, 'Plan Width': 21, 'Filter': '((l_shipmode = ANY (\'{AIR,""AIR REG""}\'::bpchar[])) AND (l_shipinstruct = \'DELIVER IN PERSON\'::bpchar) AND (((l_quantity >= \'1\'::numeric) AND (l_quantity <= \'11\'::numeric)) OR ((l_quantity >= \'10\'::numeric) AND (l_quantity <= \'20\'::numeric)) OR ((l_quantity >= \'20\'::numeric) AND (l_quantity <= \'30\'::numeric))))'}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 37280.43, 'Total Cost': 37280.43, 'Plan Rows': 1876, 'Plan Width': 30, 'Plans': [{'Node Type': 'Bitmap Heap Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 934.57, 'Total Cost': 37280.43, 'Plan Rows': 1876, 'Plan Width': 30, 'Recheck Cond': '(((p_brand = \'Brand#12\'::bpchar) AND (p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[]))) OR ((p_brand = \'Brand#23\'::bpchar) AND (p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[]))) OR ((p_brand = \'Brand#34\'::bpchar) AND (p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[]))))', 'Filter': '((p_size >= 1) AND (((p_brand = \'Brand#12\'::bpchar) AND (p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = \'Brand#23\'::bpchar) AND (p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = \'Brand#34\'::bpchar) AND (p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (p_size <= 15))))', 'Plans': [{'Node Type': 'BitmapOr', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 934.57, 'Total Cost': 934.57, 'Plan Rows': 22655, 'Plan Width': 0, 'Plans': [{'Node Type': 'Bitmap Index Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Index Name': '<13411>btree_part_p_brand_p_container', 'Startup Cost': 0.0, 'Total Cost': 317.49, 'Plan Rows': 7728, 'Plan Width': 0, 'Index Cond': '((p_brand = \'Brand#12\'::bpchar) AND (p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])))'}, {'Node Type': 'Bitmap Index Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Index Name': '<13411>btree_part_p_brand_p_container', 'Startup Cost': 0.0, 'Total Cost': 316.89, 'Plan Rows': 7668, 'Plan Width': 0, 'Index Cond': '((p_brand = \'Brand#23\'::bpchar) AND (p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])))'}, {'Node Type': 'Bitmap Index Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Index Name': '<13411>btree_part_p_brand_p_container', 'Startup Cost': 0.0, 'Total Cost': 296.81, 'Plan Rows': 7259, 'Plan Width': 0, 'Index Cond': '((p_brand = \'Brand#34\'::bpchar) AND (p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])))'}]}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 23, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]"
5,"



-- using default substitutions


select
	sum(l_extendedprice* (1 - l_discount)) as revenue
from
	lineitem,
	part
where
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#12'
		and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')
		and l_quantity >= 1 and l_quantity <= 1 + 10
		and p_size between 1 and 5
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#23'
		and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')
		and l_quantity >= 10 and l_quantity <= 10 + 10
		and p_size between 1 and 10
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#34'
		and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')
		and l_quantity >= 20 and l_quantity <= 20 + 10
		and p_size between 1 and 15
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)","['I(C part.p_brand,C part.p_container)', 'I(C part.p_container,C part.p_size)', 'I(C lineitem.l_shipmode,C lineitem.l_partkey)']",1953465.08,83532.83,34203.915,86.139,-0.0402429673899024,0.9572386366896305,0.9974816040795329,"[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 1953502.4, 'Total Cost': 1953502.41, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1953502.18, 'Total Cost': 1953502.39, 'Plan Rows': 2, 'Plan Width': 32, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1952502.18, 'Total Cost': 1952502.19, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 76402.12, 'Total Cost': 1952499.01, 'Plan Rows': 422, 'Plan Width': 12, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Join Filter': '(((part.p_brand = \'Brand#12\'::bpchar) AND (part.p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (lineitem.l_quantity >= \'1\'::numeric) AND (lineitem.l_quantity <= \'11\'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = \'Brand#23\'::bpchar) AND (part.p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (lineitem.l_quantity >= \'10\'::numeric) AND (lineitem.l_quantity <= \'20\'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = \'Brand#34\'::bpchar) AND (part.p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (lineitem.l_quantity >= \'20\'::numeric) AND (lineitem.l_quantity <= \'30\'::numeric) AND (part.p_size <= 15)))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1874367.65, 'Plan Rows': 454972, 'Plan Width': 21, 'Filter': '((l_shipmode = ANY (\'{AIR,""AIR REG""}\'::bpchar[])) AND (l_shipinstruct = \'DELIVER IN PERSON\'::bpchar) AND (((l_quantity >= \'1\'::numeric) AND (l_quantity <= \'11\'::numeric)) OR ((l_quantity >= \'10\'::numeric) AND (l_quantity <= \'20\'::numeric)) OR ((l_quantity >= \'20\'::numeric) AND (l_quantity <= \'30\'::numeric))))'}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 76378.67, 'Total Cost': 76378.67, 'Plan Rows': 1876, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 76378.67, 'Plan Rows': 1876, 'Plan Width': 30, 'Filter': '((p_size >= 1) AND (((p_brand = \'Brand#12\'::bpchar) AND (p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = \'Brand#23\'::bpchar) AND (p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = \'Brand#34\'::bpchar) AND (p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (p_size <= 15))))'}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 21, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]","[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 83532.82, 'Total Cost': 83532.83, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 83532.6, 'Total Cost': 83532.81, 'Plan Rows': 2, 'Plan Width': 32, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 82532.6, 'Total Cost': 82532.61, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 934.63, 'Total Cost': 82529.43, 'Plan Rows': 422, 'Plan Width': 12, 'Inner Unique': False, 'Plans': [{'Node Type': 'Bitmap Heap Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 934.57, 'Total Cost': 37280.43, 'Plan Rows': 1876, 'Plan Width': 30, 'Recheck Cond': '(((p_brand = \'Brand#12\'::bpchar) AND (p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[]))) OR ((p_brand = \'Brand#23\'::bpchar) AND (p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[]))) OR ((p_brand = \'Brand#34\'::bpchar) AND (p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[]))))', 'Filter': '((p_size >= 1) AND (((p_brand = \'Brand#12\'::bpchar) AND (p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = \'Brand#23\'::bpchar) AND (p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = \'Brand#34\'::bpchar) AND (p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (p_size <= 15))))', 'Plans': [{'Node Type': 'BitmapOr', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 934.57, 'Total Cost': 934.57, 'Plan Rows': 22655, 'Plan Width': 0, 'Plans': [{'Node Type': 'Bitmap Index Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Index Name': '<13411>btree_part_p_brand_p_container', 'Startup Cost': 0.0, 'Total Cost': 317.49, 'Plan Rows': 7728, 'Plan Width': 0, 'Index Cond': '((p_brand = \'Brand#12\'::bpchar) AND (p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])))'}, {'Node Type': 'Bitmap Index Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Index Name': '<13411>btree_part_p_brand_p_container', 'Startup Cost': 0.0, 'Total Cost': 316.89, 'Plan Rows': 7668, 'Plan Width': 0, 'Index Cond': '((p_brand = \'Brand#23\'::bpchar) AND (p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])))'}, {'Node Type': 'Bitmap Index Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Index Name': '<13411>btree_part_p_brand_p_container', 'Startup Cost': 0.0, 'Total Cost': 296.81, 'Plan Rows': 7259, 'Plan Width': 0, 'Index Cond': '((p_brand = \'Brand#34\'::bpchar) AND (p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])))'}]}]}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13413>btree_lineitem_l_shipmode_l_partkey', 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.07, 'Total Cost': 24.11, 'Plan Rows': 1, 'Plan Width': 21, 'Index Cond': '((l_shipmode = ANY (\'{AIR,""AIR REG""}\'::bpchar[])) AND (l_partkey = part.p_partkey))', 'Filter': '((l_shipinstruct = \'DELIVER IN PERSON\'::bpchar) AND (((l_quantity >= \'1\'::numeric) AND (l_quantity <= \'11\'::numeric)) OR ((l_quantity >= \'10\'::numeric) AND (l_quantity <= \'20\'::numeric)) OR ((l_quantity >= \'20\'::numeric) AND (l_quantity <= \'30\'::numeric))) AND (((part.p_brand = \'Brand#12\'::bpchar) AND (part.p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (l_quantity >= \'1\'::numeric) AND (l_quantity <= \'11\'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = \'Brand#23\'::bpchar) AND (part.p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (l_quantity >= \'10\'::numeric) AND (l_quantity <= \'20\'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = \'Brand#34\'::bpchar) AND (part.p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (l_quantity >= \'20\'::numeric) AND (l_quantity <= \'30\'::numeric) AND (part.p_size <= 15))))'}]}]}]}]}}]"
6,"



-- using default substitutions


select
	sum(l_extendedprice* (1 - l_discount)) as revenue
from
	lineitem,
	part
where
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#12'
		and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')
		and l_quantity >= 1 and l_quantity <= 1 + 10
		and p_size between 1 and 5
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#23'
		and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')
		and l_quantity >= 10 and l_quantity <= 10 + 10
		and p_size between 1 and 10
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#34'
		and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')
		and l_quantity >= 20 and l_quantity <= 20 + 10
		and p_size between 1 and 15
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)","['I(C part.p_brand,C part.p_container)', 'I(C lineitem.l_shipmode,C lineitem.l_partkey)', 'I(C part.p_brand)']",1953465.08,83532.83,34203.915,88.823,-0.0401644968405517,0.9572386366896305,0.9974031335301823,"[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 1953502.4, 'Total Cost': 1953502.41, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1953502.18, 'Total Cost': 1953502.39, 'Plan Rows': 2, 'Plan Width': 32, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1952502.18, 'Total Cost': 1952502.19, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 76402.12, 'Total Cost': 1952499.01, 'Plan Rows': 422, 'Plan Width': 12, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Join Filter': '(((part.p_brand = \'Brand#12\'::bpchar) AND (part.p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (lineitem.l_quantity >= \'1\'::numeric) AND (lineitem.l_quantity <= \'11\'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = \'Brand#23\'::bpchar) AND (part.p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (lineitem.l_quantity >= \'10\'::numeric) AND (lineitem.l_quantity <= \'20\'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = \'Brand#34\'::bpchar) AND (part.p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (lineitem.l_quantity >= \'20\'::numeric) AND (lineitem.l_quantity <= \'30\'::numeric) AND (part.p_size <= 15)))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1874367.65, 'Plan Rows': 454972, 'Plan Width': 21, 'Filter': '((l_shipmode = ANY (\'{AIR,""AIR REG""}\'::bpchar[])) AND (l_shipinstruct = \'DELIVER IN PERSON\'::bpchar) AND (((l_quantity >= \'1\'::numeric) AND (l_quantity <= \'11\'::numeric)) OR ((l_quantity >= \'10\'::numeric) AND (l_quantity <= \'20\'::numeric)) OR ((l_quantity >= \'20\'::numeric) AND (l_quantity <= \'30\'::numeric))))'}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 76378.67, 'Total Cost': 76378.67, 'Plan Rows': 1876, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 76378.67, 'Plan Rows': 1876, 'Plan Width': 30, 'Filter': '((p_size >= 1) AND (((p_brand = \'Brand#12\'::bpchar) AND (p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = \'Brand#23\'::bpchar) AND (p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = \'Brand#34\'::bpchar) AND (p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (p_size <= 15))))'}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 21, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]","[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 83532.82, 'Total Cost': 83532.83, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 83532.6, 'Total Cost': 83532.81, 'Plan Rows': 2, 'Plan Width': 32, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 82532.6, 'Total Cost': 82532.61, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 934.63, 'Total Cost': 82529.43, 'Plan Rows': 422, 'Plan Width': 12, 'Inner Unique': False, 'Plans': [{'Node Type': 'Bitmap Heap Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 934.57, 'Total Cost': 37280.43, 'Plan Rows': 1876, 'Plan Width': 30, 'Recheck Cond': '(((p_brand = \'Brand#12\'::bpchar) AND (p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[]))) OR ((p_brand = \'Brand#23\'::bpchar) AND (p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[]))) OR ((p_brand = \'Brand#34\'::bpchar) AND (p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[]))))', 'Filter': '((p_size >= 1) AND (((p_brand = \'Brand#12\'::bpchar) AND (p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = \'Brand#23\'::bpchar) AND (p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = \'Brand#34\'::bpchar) AND (p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (p_size <= 15))))', 'Plans': [{'Node Type': 'BitmapOr', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 934.57, 'Total Cost': 934.57, 'Plan Rows': 22655, 'Plan Width': 0, 'Plans': [{'Node Type': 'Bitmap Index Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Index Name': '<13411>btree_part_p_brand_p_container', 'Startup Cost': 0.0, 'Total Cost': 317.49, 'Plan Rows': 7728, 'Plan Width': 0, 'Index Cond': '((p_brand = \'Brand#12\'::bpchar) AND (p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])))'}, {'Node Type': 'Bitmap Index Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Index Name': '<13411>btree_part_p_brand_p_container', 'Startup Cost': 0.0, 'Total Cost': 316.89, 'Plan Rows': 7668, 'Plan Width': 0, 'Index Cond': '((p_brand = \'Brand#23\'::bpchar) AND (p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])))'}, {'Node Type': 'Bitmap Index Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Index Name': '<13411>btree_part_p_brand_p_container', 'Startup Cost': 0.0, 'Total Cost': 296.81, 'Plan Rows': 7259, 'Plan Width': 0, 'Index Cond': '((p_brand = \'Brand#34\'::bpchar) AND (p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])))'}]}]}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13412>btree_lineitem_l_shipmode_l_partkey', 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.07, 'Total Cost': 24.11, 'Plan Rows': 1, 'Plan Width': 21, 'Index Cond': '((l_shipmode = ANY (\'{AIR,""AIR REG""}\'::bpchar[])) AND (l_partkey = part.p_partkey))', 'Filter': '((l_shipinstruct = \'DELIVER IN PERSON\'::bpchar) AND (((l_quantity >= \'1\'::numeric) AND (l_quantity <= \'11\'::numeric)) OR ((l_quantity >= \'10\'::numeric) AND (l_quantity <= \'20\'::numeric)) OR ((l_quantity >= \'20\'::numeric) AND (l_quantity <= \'30\'::numeric))) AND (((part.p_brand = \'Brand#12\'::bpchar) AND (part.p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (l_quantity >= \'1\'::numeric) AND (l_quantity <= \'11\'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = \'Brand#23\'::bpchar) AND (part.p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (l_quantity >= \'10\'::numeric) AND (l_quantity <= \'20\'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = \'Brand#34\'::bpchar) AND (part.p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (l_quantity >= \'20\'::numeric) AND (l_quantity <= \'30\'::numeric) AND (part.p_size <= 15))))'}]}]}]}]}}]"
7,"



-- using default substitutions


select
	sum(l_extendedprice* (1 - l_discount)) as revenue
from
	lineitem,
	part
where
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#12'
		and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')
		and l_quantity >= 1 and l_quantity <= 1 + 10
		and p_size between 1 and 5
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#23'
		and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')
		and l_quantity >= 10 and l_quantity <= 10 + 10
		and p_size between 1 and 10
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#34'
		and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')
		and l_quantity >= 20 and l_quantity <= 20 + 10
		and p_size between 1 and 15
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)","['I(C lineitem.l_shipmode,C lineitem.l_partkey)']",1953465.08,122631.07,34203.915,247.308,-0.0555457768121567,0.9372238228082377,0.9927695996203945,"[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 1953502.4, 'Total Cost': 1953502.41, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1953502.18, 'Total Cost': 1953502.39, 'Plan Rows': 2, 'Plan Width': 32, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1952502.18, 'Total Cost': 1952502.19, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 76402.12, 'Total Cost': 1952499.01, 'Plan Rows': 422, 'Plan Width': 12, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Join Filter': '(((part.p_brand = \'Brand#12\'::bpchar) AND (part.p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (lineitem.l_quantity >= \'1\'::numeric) AND (lineitem.l_quantity <= \'11\'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = \'Brand#23\'::bpchar) AND (part.p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (lineitem.l_quantity >= \'10\'::numeric) AND (lineitem.l_quantity <= \'20\'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = \'Brand#34\'::bpchar) AND (part.p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (lineitem.l_quantity >= \'20\'::numeric) AND (lineitem.l_quantity <= \'30\'::numeric) AND (part.p_size <= 15)))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1874367.65, 'Plan Rows': 454972, 'Plan Width': 21, 'Filter': '((l_shipmode = ANY (\'{AIR,""AIR REG""}\'::bpchar[])) AND (l_shipinstruct = \'DELIVER IN PERSON\'::bpchar) AND (((l_quantity >= \'1\'::numeric) AND (l_quantity <= \'11\'::numeric)) OR ((l_quantity >= \'10\'::numeric) AND (l_quantity <= \'20\'::numeric)) OR ((l_quantity >= \'20\'::numeric) AND (l_quantity <= \'30\'::numeric))))'}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 76378.67, 'Total Cost': 76378.67, 'Plan Rows': 1876, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 76378.67, 'Plan Rows': 1876, 'Plan Width': 30, 'Filter': '((p_size >= 1) AND (((p_brand = \'Brand#12\'::bpchar) AND (p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = \'Brand#23\'::bpchar) AND (p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = \'Brand#34\'::bpchar) AND (p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (p_size <= 15))))'}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 21, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]","[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 122631.06, 'Total Cost': 122631.07, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 122630.84, 'Total Cost': 122631.05, 'Plan Rows': 2, 'Plan Width': 32, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 121630.84, 'Total Cost': 121630.85, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 0.07, 'Total Cost': 121627.67, 'Plan Rows': 422, 'Plan Width': 12, 'Inner Unique': False, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 76378.67, 'Plan Rows': 1876, 'Plan Width': 30, 'Filter': '((p_size >= 1) AND (((p_brand = \'Brand#12\'::bpchar) AND (p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = \'Brand#23\'::bpchar) AND (p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = \'Brand#34\'::bpchar) AND (p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (p_size <= 15))))'}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13411>btree_lineitem_l_shipmode_l_partkey', 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.07, 'Total Cost': 24.11, 'Plan Rows': 1, 'Plan Width': 21, 'Index Cond': '((l_shipmode = ANY (\'{AIR,""AIR REG""}\'::bpchar[])) AND (l_partkey = part.p_partkey))', 'Filter': '((l_shipinstruct = \'DELIVER IN PERSON\'::bpchar) AND (((l_quantity >= \'1\'::numeric) AND (l_quantity <= \'11\'::numeric)) OR ((l_quantity >= \'10\'::numeric) AND (l_quantity <= \'20\'::numeric)) OR ((l_quantity >= \'20\'::numeric) AND (l_quantity <= \'30\'::numeric))) AND (((part.p_brand = \'Brand#12\'::bpchar) AND (part.p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (l_quantity >= \'1\'::numeric) AND (l_quantity <= \'11\'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = \'Brand#23\'::bpchar) AND (part.p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (l_quantity >= \'10\'::numeric) AND (l_quantity <= \'20\'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = \'Brand#34\'::bpchar) AND (part.p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (l_quantity >= \'20\'::numeric) AND (l_quantity <= \'30\'::numeric) AND (part.p_size <= 15))))'}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 12, 'Options': {'Inlining': False, 'Optimization': False, 'Expressions': True, 'Deforming': True}}}]"
8,"



-- using default substitutions


select
	sum(l_extendedprice* (1 - l_discount)) as revenue
from
	lineitem,
	part
where
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#12'
		and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')
		and l_quantity >= 1 and l_quantity <= 1 + 10
		and p_size between 1 and 5
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#23'
		and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')
		and l_quantity >= 10 and l_quantity <= 10 + 10
		and p_size between 1 and 10
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#34'
		and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')
		and l_quantity >= 20 and l_quantity <= 20 + 10
		and p_size between 1 and 15
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)","['I(C part.p_container,C part.p_size)', 'I(C lineitem.l_shipmode,C lineitem.l_partkey)']",1953465.08,93733.22,34203.915,136.383,-0.0439957032137775,0.9520169462153887,0.9960126494291662,"[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 1953502.4, 'Total Cost': 1953502.41, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1953502.18, 'Total Cost': 1953502.39, 'Plan Rows': 2, 'Plan Width': 32, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1952502.18, 'Total Cost': 1952502.19, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 76402.12, 'Total Cost': 1952499.01, 'Plan Rows': 422, 'Plan Width': 12, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Join Filter': '(((part.p_brand = \'Brand#12\'::bpchar) AND (part.p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (lineitem.l_quantity >= \'1\'::numeric) AND (lineitem.l_quantity <= \'11\'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = \'Brand#23\'::bpchar) AND (part.p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (lineitem.l_quantity >= \'10\'::numeric) AND (lineitem.l_quantity <= \'20\'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = \'Brand#34\'::bpchar) AND (part.p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (lineitem.l_quantity >= \'20\'::numeric) AND (lineitem.l_quantity <= \'30\'::numeric) AND (part.p_size <= 15)))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1874367.65, 'Plan Rows': 454972, 'Plan Width': 21, 'Filter': '((l_shipmode = ANY (\'{AIR,""AIR REG""}\'::bpchar[])) AND (l_shipinstruct = \'DELIVER IN PERSON\'::bpchar) AND (((l_quantity >= \'1\'::numeric) AND (l_quantity <= \'11\'::numeric)) OR ((l_quantity >= \'10\'::numeric) AND (l_quantity <= \'20\'::numeric)) OR ((l_quantity >= \'20\'::numeric) AND (l_quantity <= \'30\'::numeric))))'}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 76378.67, 'Total Cost': 76378.67, 'Plan Rows': 1876, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 76378.67, 'Plan Rows': 1876, 'Plan Width': 30, 'Filter': '((p_size >= 1) AND (((p_brand = \'Brand#12\'::bpchar) AND (p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = \'Brand#23\'::bpchar) AND (p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = \'Brand#34\'::bpchar) AND (p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (p_size <= 15))))'}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 21, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]","[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 93733.21, 'Total Cost': 93733.22, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 93732.99, 'Total Cost': 93733.2, 'Plan Rows': 2, 'Plan Width': 32, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 92732.99, 'Total Cost': 92733.0, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 4428.02, 'Total Cost': 92729.82, 'Plan Rows': 422, 'Plan Width': 12, 'Inner Unique': False, 'Plans': [{'Node Type': 'Bitmap Heap Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 4427.96, 'Total Cost': 47480.82, 'Plan Rows': 1876, 'Plan Width': 30, 'Recheck Cond': '(((p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (p_size <= 5) AND (p_size >= 1)) OR ((p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (p_size <= 10) AND (p_size >= 1)) OR ((p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (p_size <= 15) AND (p_size >= 1)))', 'Filter': '(((p_brand = \'Brand#12\'::bpchar) AND (p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = \'Brand#23\'::bpchar) AND (p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = \'Brand#34\'::bpchar) AND (p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (p_size <= 15)))', 'Plans': [{'Node Type': 'BitmapOr', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 4427.96, 'Total Cost': 4427.96, 'Plan Rows': 118072, 'Plan Width': 0, 'Plans': [{'Node Type': 'Bitmap Index Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Index Name': '<13411>btree_part_p_container_p_size', 'Startup Cost': 0.0, 'Total Cost': 764.71, 'Plan Rows': 20200, 'Plan Width': 0, 'Index Cond': '((p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (p_size <= 5) AND (p_size >= 1))'}, {'Node Type': 'Bitmap Index Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Index Name': '<13411>btree_part_p_container_p_size', 'Startup Cost': 0.0, 'Total Cost': 1524.01, 'Plan Rows': 40622, 'Plan Width': 0, 'Index Cond': '((p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (p_size <= 10) AND (p_size >= 1))'}, {'Node Type': 'Bitmap Index Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Index Name': '<13411>btree_part_p_container_p_size', 'Startup Cost': 0.0, 'Total Cost': 2135.86, 'Plan Rows': 57250, 'Plan Width': 0, 'Index Cond': '((p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (p_size <= 15) AND (p_size >= 1))'}]}]}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13412>btree_lineitem_l_shipmode_l_partkey', 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.07, 'Total Cost': 24.11, 'Plan Rows': 1, 'Plan Width': 21, 'Index Cond': '((l_shipmode = ANY (\'{AIR,""AIR REG""}\'::bpchar[])) AND (l_partkey = part.p_partkey))', 'Filter': '((l_shipinstruct = \'DELIVER IN PERSON\'::bpchar) AND (((l_quantity >= \'1\'::numeric) AND (l_quantity <= \'11\'::numeric)) OR ((l_quantity >= \'10\'::numeric) AND (l_quantity <= \'20\'::numeric)) OR ((l_quantity >= \'20\'::numeric) AND (l_quantity <= \'30\'::numeric))) AND (((part.p_brand = \'Brand#12\'::bpchar) AND (part.p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (l_quantity >= \'1\'::numeric) AND (l_quantity <= \'11\'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = \'Brand#23\'::bpchar) AND (part.p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (l_quantity >= \'10\'::numeric) AND (l_quantity <= \'20\'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = \'Brand#34\'::bpchar) AND (part.p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (l_quantity >= \'20\'::numeric) AND (l_quantity <= \'30\'::numeric) AND (part.p_size <= 15))))'}]}]}]}]}}]"
9,"



-- using default substitutions


select
	sum(l_extendedprice* (1 - l_discount)) as revenue
from
	lineitem,
	part
where
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#12'
		and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')
		and l_quantity >= 1 and l_quantity <= 1 + 10
		and p_size between 1 and 5
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#23'
		and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')
		and l_quantity >= 10 and l_quantity <= 10 + 10
		and p_size between 1 and 10
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#34'
		and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')
		and l_quantity >= 20 and l_quantity <= 20 + 10
		and p_size between 1 and 15
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)","['I(C lineitem.l_shipmode,C lineitem.l_partkey)', 'I(C part.p_brand)']",1953465.08,96956.73,34203.915,172.919,-0.0445776711932516,0.950366796421055,0.9949444676143067,"[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 1953502.4, 'Total Cost': 1953502.41, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1953502.18, 'Total Cost': 1953502.39, 'Plan Rows': 2, 'Plan Width': 32, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1952502.18, 'Total Cost': 1952502.19, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 76402.12, 'Total Cost': 1952499.01, 'Plan Rows': 422, 'Plan Width': 12, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Join Filter': '(((part.p_brand = \'Brand#12\'::bpchar) AND (part.p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (lineitem.l_quantity >= \'1\'::numeric) AND (lineitem.l_quantity <= \'11\'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = \'Brand#23\'::bpchar) AND (part.p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (lineitem.l_quantity >= \'10\'::numeric) AND (lineitem.l_quantity <= \'20\'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = \'Brand#34\'::bpchar) AND (part.p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (lineitem.l_quantity >= \'20\'::numeric) AND (lineitem.l_quantity <= \'30\'::numeric) AND (part.p_size <= 15)))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1874367.65, 'Plan Rows': 454972, 'Plan Width': 21, 'Filter': '((l_shipmode = ANY (\'{AIR,""AIR REG""}\'::bpchar[])) AND (l_shipinstruct = \'DELIVER IN PERSON\'::bpchar) AND (((l_quantity >= \'1\'::numeric) AND (l_quantity <= \'11\'::numeric)) OR ((l_quantity >= \'10\'::numeric) AND (l_quantity <= \'20\'::numeric)) OR ((l_quantity >= \'20\'::numeric) AND (l_quantity <= \'30\'::numeric))))'}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 76378.67, 'Total Cost': 76378.67, 'Plan Rows': 1876, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 76378.67, 'Plan Rows': 1876, 'Plan Width': 30, 'Filter': '((p_size >= 1) AND (((p_brand = \'Brand#12\'::bpchar) AND (p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = \'Brand#23\'::bpchar) AND (p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = \'Brand#34\'::bpchar) AND (p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (p_size <= 15))))'}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 21, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]","[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 96956.72, 'Total Cost': 96956.73, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 96956.5, 'Total Cost': 96956.71, 'Plan Rows': 2, 'Plan Width': 32, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 95956.5, 'Total Cost': 95956.51, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 5680.1, 'Total Cost': 95953.33, 'Plan Rows': 422, 'Plan Width': 12, 'Inner Unique': False, 'Plans': [{'Node Type': 'Bitmap Heap Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 5680.03, 'Total Cost': 50704.33, 'Plan Rows': 1876, 'Plan Width': 30, 'Recheck Cond': ""((p_brand = 'Brand#12'::bpchar) OR (p_brand = 'Brand#23'::bpchar) OR (p_brand = 'Brand#34'::bpchar))"", 'Filter': '((p_size >= 1) AND (((p_brand = \'Brand#12\'::bpchar) AND (p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = \'Brand#23\'::bpchar) AND (p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = \'Brand#34\'::bpchar) AND (p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (p_size <= 15))))', 'Plans': [{'Node Type': 'BitmapOr', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 5680.03, 'Total Cost': 5680.03, 'Plan Rows': 229400, 'Plan Width': 0, 'Plans': [{'Node Type': 'Bitmap Index Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Index Name': '<13412>btree_part_p_brand', 'Startup Cost': 0.0, 'Total Cost': 1911.05, 'Plan Rows': 77200, 'Plan Width': 0, 'Index Cond': ""(p_brand = 'Brand#12'::bpchar)""}, {'Node Type': 'Bitmap Index Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Index Name': '<13412>btree_part_p_brand', 'Startup Cost': 0.0, 'Total Cost': 1877.06, 'Plan Rows': 75867, 'Plan Width': 0, 'Index Cond': ""(p_brand = 'Brand#23'::bpchar)""}, {'Node Type': 'Bitmap Index Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Index Name': '<13412>btree_part_p_brand', 'Startup Cost': 0.0, 'Total Cost': 1888.55, 'Plan Rows': 76333, 'Plan Width': 0, 'Index Cond': ""(p_brand = 'Brand#34'::bpchar)""}]}]}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13411>btree_lineitem_l_shipmode_l_partkey', 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.07, 'Total Cost': 24.11, 'Plan Rows': 1, 'Plan Width': 21, 'Index Cond': '((l_shipmode = ANY (\'{AIR,""AIR REG""}\'::bpchar[])) AND (l_partkey = part.p_partkey))', 'Filter': '((l_shipinstruct = \'DELIVER IN PERSON\'::bpchar) AND (((l_quantity >= \'1\'::numeric) AND (l_quantity <= \'11\'::numeric)) OR ((l_quantity >= \'10\'::numeric) AND (l_quantity <= \'20\'::numeric)) OR ((l_quantity >= \'20\'::numeric) AND (l_quantity <= \'30\'::numeric))) AND (((part.p_brand = \'Brand#12\'::bpchar) AND (part.p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (l_quantity >= \'1\'::numeric) AND (l_quantity <= \'11\'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = \'Brand#23\'::bpchar) AND (part.p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (l_quantity >= \'10\'::numeric) AND (l_quantity <= \'20\'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = \'Brand#34\'::bpchar) AND (part.p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (l_quantity >= \'20\'::numeric) AND (l_quantity <= \'30\'::numeric) AND (part.p_size <= 15))))'}]}]}]}]}}]"
10,"



-- using default substitutions


select
	sum(l_extendedprice* (1 - l_discount)) as revenue
from
	lineitem,
	part
where
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#12'
		and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')
		and l_quantity >= 1 and l_quantity <= 1 + 10
		and p_size between 1 and 5
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#23'
		and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')
		and l_quantity >= 10 and l_quantity <= 10 + 10
		and p_size between 1 and 10
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#34'
		and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')
		and l_quantity >= 20 and l_quantity <= 20 + 10
		and p_size between 1 and 15
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)","['I(C part.p_container,C part.p_size)']",1953465.08,1924604.56,34203.915,4352.754,-0.8579670452533534,0.014774013774538533,0.872741059027892,"[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 1953502.4, 'Total Cost': 1953502.41, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1953502.18, 'Total Cost': 1953502.39, 'Plan Rows': 2, 'Plan Width': 32, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1952502.18, 'Total Cost': 1952502.19, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 76402.12, 'Total Cost': 1952499.01, 'Plan Rows': 422, 'Plan Width': 12, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Join Filter': '(((part.p_brand = \'Brand#12\'::bpchar) AND (part.p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (lineitem.l_quantity >= \'1\'::numeric) AND (lineitem.l_quantity <= \'11\'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = \'Brand#23\'::bpchar) AND (part.p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (lineitem.l_quantity >= \'10\'::numeric) AND (lineitem.l_quantity <= \'20\'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = \'Brand#34\'::bpchar) AND (part.p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (lineitem.l_quantity >= \'20\'::numeric) AND (lineitem.l_quantity <= \'30\'::numeric) AND (part.p_size <= 15)))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1874367.65, 'Plan Rows': 454972, 'Plan Width': 21, 'Filter': '((l_shipmode = ANY (\'{AIR,""AIR REG""}\'::bpchar[])) AND (l_shipinstruct = \'DELIVER IN PERSON\'::bpchar) AND (((l_quantity >= \'1\'::numeric) AND (l_quantity <= \'11\'::numeric)) OR ((l_quantity >= \'10\'::numeric) AND (l_quantity <= \'20\'::numeric)) OR ((l_quantity >= \'20\'::numeric) AND (l_quantity <= \'30\'::numeric))))'}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 76378.67, 'Total Cost': 76378.67, 'Plan Rows': 1876, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 76378.67, 'Plan Rows': 1876, 'Plan Width': 30, 'Filter': '((p_size >= 1) AND (((p_brand = \'Brand#12\'::bpchar) AND (p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = \'Brand#23\'::bpchar) AND (p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = \'Brand#34\'::bpchar) AND (p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (p_size <= 15))))'}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 21, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]","[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 1924604.55, 'Total Cost': 1924604.56, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1924604.33, 'Total Cost': 1924604.54, 'Plan Rows': 2, 'Plan Width': 32, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1923604.33, 'Total Cost': 1923604.34, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 47504.27, 'Total Cost': 1923601.16, 'Plan Rows': 422, 'Plan Width': 12, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Join Filter': '(((part.p_brand = \'Brand#12\'::bpchar) AND (part.p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (lineitem.l_quantity >= \'1\'::numeric) AND (lineitem.l_quantity <= \'11\'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = \'Brand#23\'::bpchar) AND (part.p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (lineitem.l_quantity >= \'10\'::numeric) AND (lineitem.l_quantity <= \'20\'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = \'Brand#34\'::bpchar) AND (part.p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (lineitem.l_quantity >= \'20\'::numeric) AND (lineitem.l_quantity <= \'30\'::numeric) AND (part.p_size <= 15)))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1874367.65, 'Plan Rows': 454972, 'Plan Width': 21, 'Filter': '((l_shipmode = ANY (\'{AIR,""AIR REG""}\'::bpchar[])) AND (l_shipinstruct = \'DELIVER IN PERSON\'::bpchar) AND (((l_quantity >= \'1\'::numeric) AND (l_quantity <= \'11\'::numeric)) OR ((l_quantity >= \'10\'::numeric) AND (l_quantity <= \'20\'::numeric)) OR ((l_quantity >= \'20\'::numeric) AND (l_quantity <= \'30\'::numeric))))'}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 47480.82, 'Total Cost': 47480.82, 'Plan Rows': 1876, 'Plan Width': 30, 'Plans': [{'Node Type': 'Bitmap Heap Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 4427.96, 'Total Cost': 47480.82, 'Plan Rows': 1876, 'Plan Width': 30, 'Recheck Cond': '(((p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (p_size <= 5) AND (p_size >= 1)) OR ((p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (p_size <= 10) AND (p_size >= 1)) OR ((p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (p_size <= 15) AND (p_size >= 1)))', 'Filter': '(((p_brand = \'Brand#12\'::bpchar) AND (p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = \'Brand#23\'::bpchar) AND (p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = \'Brand#34\'::bpchar) AND (p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (p_size <= 15)))', 'Plans': [{'Node Type': 'BitmapOr', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 4427.96, 'Total Cost': 4427.96, 'Plan Rows': 118072, 'Plan Width': 0, 'Plans': [{'Node Type': 'Bitmap Index Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Index Name': '<13411>btree_part_p_container_p_size', 'Startup Cost': 0.0, 'Total Cost': 764.71, 'Plan Rows': 20200, 'Plan Width': 0, 'Index Cond': '((p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (p_size <= 5) AND (p_size >= 1))'}, {'Node Type': 'Bitmap Index Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Index Name': '<13411>btree_part_p_container_p_size', 'Startup Cost': 0.0, 'Total Cost': 1524.01, 'Plan Rows': 40622, 'Plan Width': 0, 'Index Cond': '((p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (p_size <= 10) AND (p_size >= 1))'}, {'Node Type': 'Bitmap Index Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Index Name': '<13411>btree_part_p_container_p_size', 'Startup Cost': 0.0, 'Total Cost': 2135.86, 'Plan Rows': 57250, 'Plan Width': 0, 'Index Cond': '((p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (p_size <= 15) AND (p_size >= 1))'}]}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 23, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]"
11,"



-- using default substitutions


select
	sum(l_extendedprice* (1 - l_discount)) as revenue
from
	lineitem,
	part
where
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#12'
		and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')
		and l_quantity >= 1 and l_quantity <= 1 + 10
		and p_size between 1 and 5
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#23'
		and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')
		and l_quantity >= 10 and l_quantity <= 10 + 10
		and p_size between 1 and 10
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#34'
		and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')
		and l_quantity >= 20 and l_quantity <= 20 + 10
		and p_size between 1 and 15
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)","['I(C part.p_container,C part.p_size)', 'I(C part.p_brand)']",1953465.08,1900261.95,34203.915,3924.667,-0.8580215297184159,0.027235260330325493,0.8852567900487415,"[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 1953502.4, 'Total Cost': 1953502.41, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1953502.18, 'Total Cost': 1953502.39, 'Plan Rows': 2, 'Plan Width': 32, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1952502.18, 'Total Cost': 1952502.19, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 76402.12, 'Total Cost': 1952499.01, 'Plan Rows': 422, 'Plan Width': 12, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Join Filter': '(((part.p_brand = \'Brand#12\'::bpchar) AND (part.p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (lineitem.l_quantity >= \'1\'::numeric) AND (lineitem.l_quantity <= \'11\'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = \'Brand#23\'::bpchar) AND (part.p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (lineitem.l_quantity >= \'10\'::numeric) AND (lineitem.l_quantity <= \'20\'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = \'Brand#34\'::bpchar) AND (part.p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (lineitem.l_quantity >= \'20\'::numeric) AND (lineitem.l_quantity <= \'30\'::numeric) AND (part.p_size <= 15)))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1874367.65, 'Plan Rows': 454972, 'Plan Width': 21, 'Filter': '((l_shipmode = ANY (\'{AIR,""AIR REG""}\'::bpchar[])) AND (l_shipinstruct = \'DELIVER IN PERSON\'::bpchar) AND (((l_quantity >= \'1\'::numeric) AND (l_quantity <= \'11\'::numeric)) OR ((l_quantity >= \'10\'::numeric) AND (l_quantity <= \'20\'::numeric)) OR ((l_quantity >= \'20\'::numeric) AND (l_quantity <= \'30\'::numeric))))'}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 76378.67, 'Total Cost': 76378.67, 'Plan Rows': 1876, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 76378.67, 'Plan Rows': 1876, 'Plan Width': 30, 'Filter': '((p_size >= 1) AND (((p_brand = \'Brand#12\'::bpchar) AND (p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = \'Brand#23\'::bpchar) AND (p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = \'Brand#34\'::bpchar) AND (p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (p_size <= 15))))'}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 21, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]","[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 1900261.94, 'Total Cost': 1900261.95, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1900261.72, 'Total Cost': 1900261.93, 'Plan Rows': 2, 'Plan Width': 32, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1899261.72, 'Total Cost': 1899261.73, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 23161.66, 'Total Cost': 1899258.55, 'Plan Rows': 422, 'Plan Width': 12, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Join Filter': '(((part.p_brand = \'Brand#12\'::bpchar) AND (part.p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (lineitem.l_quantity >= \'1\'::numeric) AND (lineitem.l_quantity <= \'11\'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = \'Brand#23\'::bpchar) AND (part.p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (lineitem.l_quantity >= \'10\'::numeric) AND (lineitem.l_quantity <= \'20\'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = \'Brand#34\'::bpchar) AND (part.p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (lineitem.l_quantity >= \'20\'::numeric) AND (lineitem.l_quantity <= \'30\'::numeric) AND (part.p_size <= 15)))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1874367.65, 'Plan Rows': 454972, 'Plan Width': 21, 'Filter': '((l_shipmode = ANY (\'{AIR,""AIR REG""}\'::bpchar[])) AND (l_shipinstruct = \'DELIVER IN PERSON\'::bpchar) AND (((l_quantity >= \'1\'::numeric) AND (l_quantity <= \'11\'::numeric)) OR ((l_quantity >= \'10\'::numeric) AND (l_quantity <= \'20\'::numeric)) OR ((l_quantity >= \'20\'::numeric) AND (l_quantity <= \'30\'::numeric))))'}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 23138.21, 'Total Cost': 23138.21, 'Plan Rows': 1876, 'Plan Width': 30, 'Plans': [{'Node Type': 'Bitmap Heap Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 10109.24, 'Total Cost': 23138.21, 'Plan Rows': 1876, 'Plan Width': 30, 'Recheck Cond': '(((p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (p_size <= 5) AND (p_size >= 1) AND (p_brand = \'Brand#12\'::bpchar)) OR ((p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (p_size <= 10) AND (p_size >= 1) AND (p_brand = \'Brand#23\'::bpchar)) OR ((p_brand = \'Brand#34\'::bpchar) AND (p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (p_size <= 15) AND (p_size >= 1)))', 'Plans': [{'Node Type': 'BitmapOr', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 10109.24, 'Total Cost': 10109.24, 'Plan Rows': 4506, 'Plan Width': 0, 'Plans': [{'Node Type': 'BitmapAnd', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Startup Cost': 2678.26, 'Total Cost': 2678.26, 'Plan Rows': 780, 'Plan Width': 0, 'Plans': [{'Node Type': 'Bitmap Index Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Index Name': '<13411>btree_part_p_container_p_size', 'Startup Cost': 0.0, 'Total Cost': 764.71, 'Plan Rows': 20200, 'Plan Width': 0, 'Index Cond': '((p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (p_size <= 5) AND (p_size >= 1))'}, {'Node Type': 'Bitmap Index Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Index Name': '<13412>btree_part_p_brand', 'Startup Cost': 0.0, 'Total Cost': 1911.05, 'Plan Rows': 77200, 'Plan Width': 0, 'Index Cond': ""(p_brand = 'Brand#12'::bpchar)""}]}, {'Node Type': 'BitmapAnd', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Startup Cost': 3403.57, 'Total Cost': 3403.57, 'Plan Rows': 1541, 'Plan Width': 0, 'Plans': [{'Node Type': 'Bitmap Index Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Index Name': '<13411>btree_part_p_container_p_size', 'Startup Cost': 0.0, 'Total Cost': 1524.01, 'Plan Rows': 40622, 'Plan Width': 0, 'Index Cond': '((p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (p_size <= 10) AND (p_size >= 1))'}, {'Node Type': 'Bitmap Index Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Index Name': '<13412>btree_part_p_brand', 'Startup Cost': 0.0, 'Total Cost': 1877.06, 'Plan Rows': 75867, 'Plan Width': 0, 'Index Cond': ""(p_brand = 'Brand#23'::bpchar)""}]}, {'Node Type': 'BitmapAnd', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Startup Cost': 4026.91, 'Total Cost': 4026.91, 'Plan Rows': 2185, 'Plan Width': 0, 'Plans': [{'Node Type': 'Bitmap Index Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Index Name': '<13412>btree_part_p_brand', 'Startup Cost': 0.0, 'Total Cost': 1888.55, 'Plan Rows': 76333, 'Plan Width': 0, 'Index Cond': ""(p_brand = 'Brand#34'::bpchar)""}, {'Node Type': 'Bitmap Index Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Index Name': '<13411>btree_part_p_container_p_size', 'Startup Cost': 0.0, 'Total Cost': 2135.86, 'Plan Rows': 57250, 'Plan Width': 0, 'Index Cond': '((p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (p_size <= 15) AND (p_size >= 1))'}]}]}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 21, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]"
12,"



-- using default substitutions


select
	sum(l_extendedprice* (1 - l_discount)) as revenue
from
	lineitem,
	part
where
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#12'
		and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')
		and l_quantity >= 1 and l_quantity <= 1 + 10
		and p_size between 1 and 5
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#23'
		and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')
		and l_quantity >= 10 and l_quantity <= 10 + 10
		and p_size between 1 and 10
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#34'
		and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')
		and l_quantity >= 20 and l_quantity <= 20 + 10
		and p_size between 1 and 15
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)","['I(C lineitem.l_shipmode,C lineitem.l_partkey)', 'I(C part.p_container,C part.p_size)', 'I(C part.p_brand)']",1953465.08,69390.61,34203.915,114.042,-0.0321876275011528,0.9644781927711755,0.9966658202723284,"[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 1953502.4, 'Total Cost': 1953502.41, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1953502.18, 'Total Cost': 1953502.39, 'Plan Rows': 2, 'Plan Width': 32, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1952502.18, 'Total Cost': 1952502.19, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 76402.12, 'Total Cost': 1952499.01, 'Plan Rows': 422, 'Plan Width': 12, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Join Filter': '(((part.p_brand = \'Brand#12\'::bpchar) AND (part.p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (lineitem.l_quantity >= \'1\'::numeric) AND (lineitem.l_quantity <= \'11\'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = \'Brand#23\'::bpchar) AND (part.p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (lineitem.l_quantity >= \'10\'::numeric) AND (lineitem.l_quantity <= \'20\'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = \'Brand#34\'::bpchar) AND (part.p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (lineitem.l_quantity >= \'20\'::numeric) AND (lineitem.l_quantity <= \'30\'::numeric) AND (part.p_size <= 15)))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1874367.65, 'Plan Rows': 454972, 'Plan Width': 21, 'Filter': '((l_shipmode = ANY (\'{AIR,""AIR REG""}\'::bpchar[])) AND (l_shipinstruct = \'DELIVER IN PERSON\'::bpchar) AND (((l_quantity >= \'1\'::numeric) AND (l_quantity <= \'11\'::numeric)) OR ((l_quantity >= \'10\'::numeric) AND (l_quantity <= \'20\'::numeric)) OR ((l_quantity >= \'20\'::numeric) AND (l_quantity <= \'30\'::numeric))))'}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 76378.67, 'Total Cost': 76378.67, 'Plan Rows': 1876, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 76378.67, 'Plan Rows': 1876, 'Plan Width': 30, 'Filter': '((p_size >= 1) AND (((p_brand = \'Brand#12\'::bpchar) AND (p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = \'Brand#23\'::bpchar) AND (p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = \'Brand#34\'::bpchar) AND (p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (p_size <= 15))))'}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 21, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]","[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 69390.6, 'Total Cost': 69390.61, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 69390.38, 'Total Cost': 69390.59, 'Plan Rows': 2, 'Plan Width': 32, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 68390.38, 'Total Cost': 68390.39, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 10109.31, 'Total Cost': 68387.21, 'Plan Rows': 422, 'Plan Width': 12, 'Inner Unique': False, 'Plans': [{'Node Type': 'Bitmap Heap Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 10109.24, 'Total Cost': 23138.21, 'Plan Rows': 1876, 'Plan Width': 30, 'Recheck Cond': '(((p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (p_size <= 5) AND (p_size >= 1) AND (p_brand = \'Brand#12\'::bpchar)) OR ((p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (p_size <= 10) AND (p_size >= 1) AND (p_brand = \'Brand#23\'::bpchar)) OR ((p_brand = \'Brand#34\'::bpchar) AND (p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (p_size <= 15) AND (p_size >= 1)))', 'Plans': [{'Node Type': 'BitmapOr', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 10109.24, 'Total Cost': 10109.24, 'Plan Rows': 4506, 'Plan Width': 0, 'Plans': [{'Node Type': 'BitmapAnd', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Startup Cost': 2678.26, 'Total Cost': 2678.26, 'Plan Rows': 780, 'Plan Width': 0, 'Plans': [{'Node Type': 'Bitmap Index Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Index Name': '<13412>btree_part_p_container_p_size', 'Startup Cost': 0.0, 'Total Cost': 764.71, 'Plan Rows': 20200, 'Plan Width': 0, 'Index Cond': '((p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (p_size <= 5) AND (p_size >= 1))'}, {'Node Type': 'Bitmap Index Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Index Name': '<13413>btree_part_p_brand', 'Startup Cost': 0.0, 'Total Cost': 1911.05, 'Plan Rows': 77200, 'Plan Width': 0, 'Index Cond': ""(p_brand = 'Brand#12'::bpchar)""}]}, {'Node Type': 'BitmapAnd', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Startup Cost': 3403.57, 'Total Cost': 3403.57, 'Plan Rows': 1541, 'Plan Width': 0, 'Plans': [{'Node Type': 'Bitmap Index Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Index Name': '<13412>btree_part_p_container_p_size', 'Startup Cost': 0.0, 'Total Cost': 1524.01, 'Plan Rows': 40622, 'Plan Width': 0, 'Index Cond': '((p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (p_size <= 10) AND (p_size >= 1))'}, {'Node Type': 'Bitmap Index Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Index Name': '<13413>btree_part_p_brand', 'Startup Cost': 0.0, 'Total Cost': 1877.06, 'Plan Rows': 75867, 'Plan Width': 0, 'Index Cond': ""(p_brand = 'Brand#23'::bpchar)""}]}, {'Node Type': 'BitmapAnd', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Startup Cost': 4026.91, 'Total Cost': 4026.91, 'Plan Rows': 2185, 'Plan Width': 0, 'Plans': [{'Node Type': 'Bitmap Index Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Index Name': '<13413>btree_part_p_brand', 'Startup Cost': 0.0, 'Total Cost': 1888.55, 'Plan Rows': 76333, 'Plan Width': 0, 'Index Cond': ""(p_brand = 'Brand#34'::bpchar)""}, {'Node Type': 'Bitmap Index Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Index Name': '<13412>btree_part_p_container_p_size', 'Startup Cost': 0.0, 'Total Cost': 2135.86, 'Plan Rows': 57250, 'Plan Width': 0, 'Index Cond': '((p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (p_size <= 15) AND (p_size >= 1))'}]}]}]}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13411>btree_lineitem_l_shipmode_l_partkey', 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.07, 'Total Cost': 24.11, 'Plan Rows': 1, 'Plan Width': 21, 'Index Cond': '((l_shipmode = ANY (\'{AIR,""AIR REG""}\'::bpchar[])) AND (l_partkey = part.p_partkey))', 'Filter': '((l_shipinstruct = \'DELIVER IN PERSON\'::bpchar) AND (((l_quantity >= \'1\'::numeric) AND (l_quantity <= \'11\'::numeric)) OR ((l_quantity >= \'10\'::numeric) AND (l_quantity <= \'20\'::numeric)) OR ((l_quantity >= \'20\'::numeric) AND (l_quantity <= \'30\'::numeric))) AND (((part.p_brand = \'Brand#12\'::bpchar) AND (part.p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (l_quantity >= \'1\'::numeric) AND (l_quantity <= \'11\'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = \'Brand#23\'::bpchar) AND (part.p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (l_quantity >= \'10\'::numeric) AND (l_quantity <= \'20\'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = \'Brand#34\'::bpchar) AND (part.p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (l_quantity >= \'20\'::numeric) AND (l_quantity <= \'30\'::numeric) AND (part.p_size <= 15))))'}]}]}]}]}}]"
13,"



-- using default substitutions


select
	sum(l_extendedprice* (1 - l_discount)) as revenue
from
	lineitem,
	part
where
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#12'
		and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')
		and l_quantity >= 1 and l_quantity <= 1 + 10
		and p_size between 1 and 5
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#23'
		and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')
		and l_quantity >= 10 and l_quantity <= 10 + 10
		and p_size between 1 and 10
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#34'
		and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')
		and l_quantity >= 20 and l_quantity <= 20 + 10
		and p_size between 1 and 15
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)","['I(C part.p_brand,C part.p_container)', 'I(C lineitem.l_shipmode,C lineitem.l_partkey)', 'I(C part.p_container,C part.p_size)', 'I(C part.p_brand)']",1953465.08,69390.61,34203.915,123.305,-0.0319168105493508,0.9644781927711755,0.9963950033205263,"[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 1953502.4, 'Total Cost': 1953502.41, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1953502.18, 'Total Cost': 1953502.39, 'Plan Rows': 2, 'Plan Width': 32, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1952502.18, 'Total Cost': 1952502.19, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 76402.12, 'Total Cost': 1952499.01, 'Plan Rows': 422, 'Plan Width': 12, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Join Filter': '(((part.p_brand = \'Brand#12\'::bpchar) AND (part.p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (lineitem.l_quantity >= \'1\'::numeric) AND (lineitem.l_quantity <= \'11\'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = \'Brand#23\'::bpchar) AND (part.p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (lineitem.l_quantity >= \'10\'::numeric) AND (lineitem.l_quantity <= \'20\'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = \'Brand#34\'::bpchar) AND (part.p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (lineitem.l_quantity >= \'20\'::numeric) AND (lineitem.l_quantity <= \'30\'::numeric) AND (part.p_size <= 15)))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1874367.65, 'Plan Rows': 454972, 'Plan Width': 21, 'Filter': '((l_shipmode = ANY (\'{AIR,""AIR REG""}\'::bpchar[])) AND (l_shipinstruct = \'DELIVER IN PERSON\'::bpchar) AND (((l_quantity >= \'1\'::numeric) AND (l_quantity <= \'11\'::numeric)) OR ((l_quantity >= \'10\'::numeric) AND (l_quantity <= \'20\'::numeric)) OR ((l_quantity >= \'20\'::numeric) AND (l_quantity <= \'30\'::numeric))))'}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 76378.67, 'Total Cost': 76378.67, 'Plan Rows': 1876, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 76378.67, 'Plan Rows': 1876, 'Plan Width': 30, 'Filter': '((p_size >= 1) AND (((p_brand = \'Brand#12\'::bpchar) AND (p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = \'Brand#23\'::bpchar) AND (p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = \'Brand#34\'::bpchar) AND (p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (p_size <= 15))))'}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 21, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]","[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 69390.6, 'Total Cost': 69390.61, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 69390.38, 'Total Cost': 69390.59, 'Plan Rows': 2, 'Plan Width': 32, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 68390.38, 'Total Cost': 68390.39, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 10109.31, 'Total Cost': 68387.21, 'Plan Rows': 422, 'Plan Width': 12, 'Inner Unique': False, 'Plans': [{'Node Type': 'Bitmap Heap Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 10109.24, 'Total Cost': 23138.21, 'Plan Rows': 1876, 'Plan Width': 30, 'Recheck Cond': '(((p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (p_size <= 5) AND (p_size >= 1) AND (p_brand = \'Brand#12\'::bpchar)) OR ((p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (p_size <= 10) AND (p_size >= 1) AND (p_brand = \'Brand#23\'::bpchar)) OR ((p_brand = \'Brand#34\'::bpchar) AND (p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (p_size <= 15) AND (p_size >= 1)))', 'Plans': [{'Node Type': 'BitmapOr', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 10109.24, 'Total Cost': 10109.24, 'Plan Rows': 4506, 'Plan Width': 0, 'Plans': [{'Node Type': 'BitmapAnd', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Startup Cost': 2678.26, 'Total Cost': 2678.26, 'Plan Rows': 780, 'Plan Width': 0, 'Plans': [{'Node Type': 'Bitmap Index Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Index Name': '<13413>btree_part_p_container_p_size', 'Startup Cost': 0.0, 'Total Cost': 764.71, 'Plan Rows': 20200, 'Plan Width': 0, 'Index Cond': '((p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (p_size <= 5) AND (p_size >= 1))'}, {'Node Type': 'Bitmap Index Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Index Name': '<13414>btree_part_p_brand', 'Startup Cost': 0.0, 'Total Cost': 1911.05, 'Plan Rows': 77200, 'Plan Width': 0, 'Index Cond': ""(p_brand = 'Brand#12'::bpchar)""}]}, {'Node Type': 'BitmapAnd', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Startup Cost': 3403.57, 'Total Cost': 3403.57, 'Plan Rows': 1541, 'Plan Width': 0, 'Plans': [{'Node Type': 'Bitmap Index Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Index Name': '<13413>btree_part_p_container_p_size', 'Startup Cost': 0.0, 'Total Cost': 1524.01, 'Plan Rows': 40622, 'Plan Width': 0, 'Index Cond': '((p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (p_size <= 10) AND (p_size >= 1))'}, {'Node Type': 'Bitmap Index Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Index Name': '<13414>btree_part_p_brand', 'Startup Cost': 0.0, 'Total Cost': 1877.06, 'Plan Rows': 75867, 'Plan Width': 0, 'Index Cond': ""(p_brand = 'Brand#23'::bpchar)""}]}, {'Node Type': 'BitmapAnd', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Startup Cost': 4026.91, 'Total Cost': 4026.91, 'Plan Rows': 2185, 'Plan Width': 0, 'Plans': [{'Node Type': 'Bitmap Index Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Index Name': '<13414>btree_part_p_brand', 'Startup Cost': 0.0, 'Total Cost': 1888.55, 'Plan Rows': 76333, 'Plan Width': 0, 'Index Cond': ""(p_brand = 'Brand#34'::bpchar)""}, {'Node Type': 'Bitmap Index Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Index Name': '<13413>btree_part_p_container_p_size', 'Startup Cost': 0.0, 'Total Cost': 2135.86, 'Plan Rows': 57250, 'Plan Width': 0, 'Index Cond': '((p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (p_size <= 15) AND (p_size >= 1))'}]}]}]}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13412>btree_lineitem_l_shipmode_l_partkey', 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.07, 'Total Cost': 24.11, 'Plan Rows': 1, 'Plan Width': 21, 'Index Cond': '((l_shipmode = ANY (\'{AIR,""AIR REG""}\'::bpchar[])) AND (l_partkey = part.p_partkey))', 'Filter': '((l_shipinstruct = \'DELIVER IN PERSON\'::bpchar) AND (((l_quantity >= \'1\'::numeric) AND (l_quantity <= \'11\'::numeric)) OR ((l_quantity >= \'10\'::numeric) AND (l_quantity <= \'20\'::numeric)) OR ((l_quantity >= \'20\'::numeric) AND (l_quantity <= \'30\'::numeric))) AND (((part.p_brand = \'Brand#12\'::bpchar) AND (part.p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (l_quantity >= \'1\'::numeric) AND (l_quantity <= \'11\'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = \'Brand#23\'::bpchar) AND (part.p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (l_quantity >= \'10\'::numeric) AND (l_quantity <= \'20\'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = \'Brand#34\'::bpchar) AND (part.p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (l_quantity >= \'20\'::numeric) AND (l_quantity <= \'30\'::numeric) AND (part.p_size <= 15))))'}]}]}]}]}}]"
14,"



-- using default substitutions


select
	sum(l_extendedprice* (1 - l_discount)) as revenue
from
	lineitem,
	part
where
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#12'
		and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')
		and l_quantity >= 1 and l_quantity <= 1 + 10
		and p_size between 1 and 5
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#23'
		and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')
		and l_quantity >= 10 and l_quantity <= 10 + 10
		and p_size between 1 and 10
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#34'
		and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')
		and l_quantity >= 20 and l_quantity <= 20 + 10
		and p_size between 1 and 15
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)",['I(C part.p_brand)'],1953465.08,1927828.07,34203.915,4033.002,-0.8689655985857032,0.013123863980204861,0.882089462565908,"[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 1953502.4, 'Total Cost': 1953502.41, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1953502.18, 'Total Cost': 1953502.39, 'Plan Rows': 2, 'Plan Width': 32, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1952502.18, 'Total Cost': 1952502.19, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 76402.12, 'Total Cost': 1952499.01, 'Plan Rows': 422, 'Plan Width': 12, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Join Filter': '(((part.p_brand = \'Brand#12\'::bpchar) AND (part.p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (lineitem.l_quantity >= \'1\'::numeric) AND (lineitem.l_quantity <= \'11\'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = \'Brand#23\'::bpchar) AND (part.p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (lineitem.l_quantity >= \'10\'::numeric) AND (lineitem.l_quantity <= \'20\'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = \'Brand#34\'::bpchar) AND (part.p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (lineitem.l_quantity >= \'20\'::numeric) AND (lineitem.l_quantity <= \'30\'::numeric) AND (part.p_size <= 15)))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1874367.65, 'Plan Rows': 454972, 'Plan Width': 21, 'Filter': '((l_shipmode = ANY (\'{AIR,""AIR REG""}\'::bpchar[])) AND (l_shipinstruct = \'DELIVER IN PERSON\'::bpchar) AND (((l_quantity >= \'1\'::numeric) AND (l_quantity <= \'11\'::numeric)) OR ((l_quantity >= \'10\'::numeric) AND (l_quantity <= \'20\'::numeric)) OR ((l_quantity >= \'20\'::numeric) AND (l_quantity <= \'30\'::numeric))))'}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 76378.67, 'Total Cost': 76378.67, 'Plan Rows': 1876, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 76378.67, 'Plan Rows': 1876, 'Plan Width': 30, 'Filter': '((p_size >= 1) AND (((p_brand = \'Brand#12\'::bpchar) AND (p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = \'Brand#23\'::bpchar) AND (p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = \'Brand#34\'::bpchar) AND (p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (p_size <= 15))))'}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 21, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]","[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 1927828.06, 'Total Cost': 1927828.07, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1927827.84, 'Total Cost': 1927828.05, 'Plan Rows': 2, 'Plan Width': 32, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1926827.84, 'Total Cost': 1926827.85, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 50727.78, 'Total Cost': 1926824.67, 'Plan Rows': 422, 'Plan Width': 12, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Join Filter': '(((part.p_brand = \'Brand#12\'::bpchar) AND (part.p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (lineitem.l_quantity >= \'1\'::numeric) AND (lineitem.l_quantity <= \'11\'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = \'Brand#23\'::bpchar) AND (part.p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (lineitem.l_quantity >= \'10\'::numeric) AND (lineitem.l_quantity <= \'20\'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = \'Brand#34\'::bpchar) AND (part.p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (lineitem.l_quantity >= \'20\'::numeric) AND (lineitem.l_quantity <= \'30\'::numeric) AND (part.p_size <= 15)))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1874367.65, 'Plan Rows': 454972, 'Plan Width': 21, 'Filter': '((l_shipmode = ANY (\'{AIR,""AIR REG""}\'::bpchar[])) AND (l_shipinstruct = \'DELIVER IN PERSON\'::bpchar) AND (((l_quantity >= \'1\'::numeric) AND (l_quantity <= \'11\'::numeric)) OR ((l_quantity >= \'10\'::numeric) AND (l_quantity <= \'20\'::numeric)) OR ((l_quantity >= \'20\'::numeric) AND (l_quantity <= \'30\'::numeric))))'}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 50704.33, 'Total Cost': 50704.33, 'Plan Rows': 1876, 'Plan Width': 30, 'Plans': [{'Node Type': 'Bitmap Heap Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 5680.03, 'Total Cost': 50704.33, 'Plan Rows': 1876, 'Plan Width': 30, 'Recheck Cond': ""((p_brand = 'Brand#12'::bpchar) OR (p_brand = 'Brand#23'::bpchar) OR (p_brand = 'Brand#34'::bpchar))"", 'Filter': '((p_size >= 1) AND (((p_brand = \'Brand#12\'::bpchar) AND (p_container = ANY (\'{""SM CASE"",""SM BOX"",""SM PACK"",""SM PKG""}\'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = \'Brand#23\'::bpchar) AND (p_container = ANY (\'{""MED BAG"",""MED BOX"",""MED PKG"",""MED PACK""}\'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = \'Brand#34\'::bpchar) AND (p_container = ANY (\'{""LG CASE"",""LG BOX"",""LG PACK"",""LG PKG""}\'::bpchar[])) AND (p_size <= 15))))', 'Plans': [{'Node Type': 'BitmapOr', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 5680.03, 'Total Cost': 5680.03, 'Plan Rows': 229400, 'Plan Width': 0, 'Plans': [{'Node Type': 'Bitmap Index Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Index Name': '<13411>btree_part_p_brand', 'Startup Cost': 0.0, 'Total Cost': 1911.05, 'Plan Rows': 77200, 'Plan Width': 0, 'Index Cond': ""(p_brand = 'Brand#12'::bpchar)""}, {'Node Type': 'Bitmap Index Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Index Name': '<13411>btree_part_p_brand', 'Startup Cost': 0.0, 'Total Cost': 1877.06, 'Plan Rows': 75867, 'Plan Width': 0, 'Index Cond': ""(p_brand = 'Brand#23'::bpchar)""}, {'Node Type': 'Bitmap Index Scan', 'Parent Relationship': 'Member', 'Parallel Aware': False, 'Index Name': '<13411>btree_part_p_brand', 'Startup Cost': 0.0, 'Total Cost': 1888.55, 'Plan Rows': 76333, 'Plan Width': 0, 'Index Cond': ""(p_brand = 'Brand#34'::bpchar)""}]}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 23, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]"
15,"



-- using default substitutions


select
	100.00 * sum(case
		when p_type like 'PROMO%'
			then l_extendedprice * (1 - l_discount)
		else 0
	end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue
from
	lineitem,
	part
where
	l_partkey = p_partkey
	and l_shipdate >= date '1995-09-01'
	and l_shipdate < date '1995-09-01' + interval '1' month",['I(C lineitem.l_shipdate)'],1567280.41,1109373.4,3361.133,3010.083,0.1877226657123081,0.29216661363106045,0.10444394791875232,"[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 1567280.39, 'Total Cost': 1567280.41, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1567280.16, 'Total Cost': 1567280.37, 'Plan Rows': 2, 'Plan Width': 64, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1566280.16, 'Total Cost': 1566280.17, 'Plan Rows': 1, 'Plan Width': 64, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 59712.0, 'Total Cost': 1561393.94, 'Plan Rows': 279212, 'Plan Width': 33, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1499454.82, 'Plan Rows': 283665, 'Plan Width': 16, 'Filter': ""((l_shipdate >= '1995-09-01'::date) AND (l_shipdate < '1995-10-01 00:00:00'::timestamp without time zone))""}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 49295.33, 'Total Cost': 49295.33, 'Plan Rows': 833333, 'Plan Width': 25, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 49295.33, 'Plan Rows': 833333, 'Plan Width': 25}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 17, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]","[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 1109373.39, 'Total Cost': 1109373.4, 'Plan Rows': 1, 'Plan Width': 32, 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1109373.15, 'Total Cost': 1109373.36, 'Plan Rows': 2, 'Plan Width': 64, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1108373.15, 'Total Cost': 1108373.16, 'Plan Rows': 1, 'Plan Width': 64, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 75378.22, 'Total Cost': 1103486.94, 'Plan Rows': 279212, 'Plan Width': 33, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Plans': [{'Node Type': 'Bitmap Heap Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 15666.22, 'Total Cost': 1041547.82, 'Plan Rows': 283665, 'Plan Width': 16, 'Recheck Cond': ""((l_shipdate >= '1995-09-01'::date) AND (l_shipdate < '1995-10-01 00:00:00'::timestamp without time zone))"", 'Plans': [{'Node Type': 'Bitmap Index Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Index Name': '<13411>btree_lineitem_l_shipdate', 'Startup Cost': 0.0, 'Total Cost': 15496.02, 'Plan Rows': 680796, 'Plan Width': 0, 'Index Cond': ""((l_shipdate >= '1995-09-01'::date) AND (l_shipdate < '1995-10-01 00:00:00'::timestamp without time zone))""}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 49295.33, 'Total Cost': 49295.33, 'Plan Rows': 833333, 'Plan Width': 25, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 49295.33, 'Plan Rows': 833333, 'Plan Width': 25}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 17, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]"
16,"



-- using default substitutions


select
	o_year,
	sum(case
		when nation = 'BRAZIL' then volume
		else 0
	end) / sum(volume) as mkt_share
from
	(
		select
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) as volume,
			n2.n_name as nation
		from
			part,
			supplier,
			lineitem,
			orders,
			customer,
			nation n1,
			nation n2,
			region
		where
			p_partkey = l_partkey
			and s_suppkey = l_suppkey
			and l_orderkey = o_orderkey
			and o_custkey = c_custkey
			and c_nationkey = n1.n_nationkey
			and n1.n_regionkey = r_regionkey
			and r_name = 'AMERICA'
			and s_nationkey = n2.n_nationkey
			and o_orderdate between date '1995-01-01' and date '1996-12-31'
			and p_type = 'ECONOMY ANODIZED STEEL'
	) as all_nations
group by
	o_year
order by
	o_year",['I(C lineitem.l_partkey)'],1936032.45,1058249.9,15659.025,4451.355,-0.2623398233374556,0.4533924780031451,0.7157323013406007,"[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 1935302.87, 'Total Cost': 1936020.08, 'Plan Rows': 2406, 'Plan Width': 40, 'Group Key': [""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1935302.87, 'Total Cost': 1935935.87, 'Plan Rows': 2406, 'Plan Width': 72, 'Workers Planned': 1, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1934302.86, 'Total Cost': 1934665.19, 'Plan Rows': 2406, 'Plan Width': 72, 'Group Key': [""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1934302.86, 'Total Cost': 1934337.77, 'Plan Rows': 13965, 'Plan Width': 46, 'Sort Key': [""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 1929996.54, 'Total Cost': 1933341.4, 'Plan Rows': 13965, 'Plan Width': 46, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = n2.n_nationkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1929994.98, 'Total Cost': 1933077.99, 'Plan Rows': 13965, 'Plan Width': 20, 'Inner Unique': False, 'Hash Cond': '(supplier.s_suppkey = lineitem.l_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1929871.33, 'Total Cost': 1929871.33, 'Plan Rows': 9892, 'Plan Width': 20, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 1884960.57, 'Total Cost': 1929871.33, 'Plan Rows': 9892, 'Plan Width': 20, 'Inner Unique': False, 'Hash Cond': '(customer.c_nationkey = n1.n_nationkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1884958.04, 'Total Cost': 1929584.41, 'Plan Rows': 49458, 'Plan Width': 24, 'Inner Unique': False, 'Hash Cond': '(customer.c_custkey = orders.o_custkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'customer', 'Alias': 'customer', 'Startup Cost': 0.0, 'Total Cost': 42076.67, 'Plan Rows': 624967, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1884339.81, 'Total Cost': 1884339.81, 'Plan Rows': 49458, 'Plan Width': 24, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1522386.94, 'Total Cost': 1884339.81, 'Plan Rows': 49458, 'Plan Width': 24, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = lineitem.l_orderkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.0, 'Total Cost': 354662.0, 'Plan Rows': 1889278, 'Plan Width': 12, 'Filter': ""((o_orderdate >= '1995-01-01'::date) AND (o_orderdate <= '1996-12-31'::date))""}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1520341.75, 'Total Cost': 1520341.75, 'Plan Rows': 163615, 'Plan Width': 20, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 51447.94, 'Total Cost': 1520341.75, 'Plan Rows': 163615, 'Plan Width': 20, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1374483.88, 'Plan Rows': 24994188, 'Plan Width': 24}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 51378.67, 'Total Cost': 51378.67, 'Plan Rows': 5542, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 5542, 'Plan Width': 4, 'Filter': ""((p_type)::text = 'ECONOMY ANODIZED STEEL'::text)""}]}]}]}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 2.47, 'Total Cost': 2.47, 'Plan Rows': 5, 'Plan Width': 4, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 1.07, 'Total Cost': 2.47, 'Plan Rows': 5, 'Plan Width': 4, 'Inner Unique': False, 'Hash Cond': '(n1.n_regionkey = region.r_regionkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'n1', 'Startup Cost': 0.0, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.06, 'Total Cost': 1.06, 'Plan Rows': 1, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'region', 'Alias': 'region', 'Startup Cost': 0.0, 'Total Cost': 1.06, 'Plan Rows': 1, 'Plan Width': 4, 'Filter': ""(r_name = 'AMERICA'::bpchar)""}]}]}]}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.25, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'n2', 'Startup Cost': 0.0, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 74, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]","[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 1057520.31, 'Total Cost': 1058237.53, 'Plan Rows': 2406, 'Plan Width': 40, 'Group Key': [""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1057520.31, 'Total Cost': 1058153.32, 'Plan Rows': 2406, 'Plan Width': 72, 'Workers Planned': 1, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1056520.3, 'Total Cost': 1056882.63, 'Plan Rows': 2406, 'Plan Width': 72, 'Group Key': [""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1056520.3, 'Total Cost': 1056555.21, 'Plan Rows': 13965, 'Plan Width': 46, 'Sort Key': [""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 1052213.98, 'Total Cost': 1055558.84, 'Plan Rows': 13965, 'Plan Width': 46, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = n2.n_nationkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1052212.42, 'Total Cost': 1055295.43, 'Plan Rows': 13965, 'Plan Width': 20, 'Inner Unique': False, 'Hash Cond': '(supplier.s_suppkey = lineitem.l_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1052088.77, 'Total Cost': 1052088.77, 'Plan Rows': 9892, 'Plan Width': 20, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 1007178.01, 'Total Cost': 1052088.77, 'Plan Rows': 9892, 'Plan Width': 20, 'Inner Unique': False, 'Hash Cond': '(customer.c_nationkey = n1.n_nationkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1007175.48, 'Total Cost': 1051801.85, 'Plan Rows': 49458, 'Plan Width': 24, 'Inner Unique': False, 'Hash Cond': '(customer.c_custkey = orders.o_custkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'customer', 'Alias': 'customer', 'Startup Cost': 0.0, 'Total Cost': 42076.67, 'Plan Rows': 624967, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1006557.25, 'Total Cost': 1006557.25, 'Plan Rows': 49458, 'Plan Width': 24, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 644604.38, 'Total Cost': 1006557.25, 'Plan Rows': 49458, 'Plan Width': 24, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = lineitem.l_orderkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.0, 'Total Cost': 354662.0, 'Plan Rows': 1889278, 'Plan Width': 12, 'Filter': ""((o_orderdate >= '1995-01-01'::date) AND (o_orderdate <= '1996-12-31'::date))""}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 642559.19, 'Total Cost': 642559.19, 'Plan Rows': 163615, 'Plan Width': 20, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 0.07, 'Total Cost': 642559.19, 'Plan Rows': 163615, 'Plan Width': 20, 'Inner Unique': False, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 5542, 'Plan Width': 4, 'Filter': ""((p_type)::text = 'ECONOMY ANODIZED STEEL'::text)""}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13411>btree_lineitem_l_partkey', 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.07, 'Total Cost': 106.37, 'Plan Rows': 30, 'Plan Width': 24, 'Index Cond': '(l_partkey = part.p_partkey)'}]}]}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 2.47, 'Total Cost': 2.47, 'Plan Rows': 5, 'Plan Width': 4, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 1.07, 'Total Cost': 2.47, 'Plan Rows': 5, 'Plan Width': 4, 'Inner Unique': False, 'Hash Cond': '(n1.n_regionkey = region.r_regionkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'n1', 'Startup Cost': 0.0, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.06, 'Total Cost': 1.06, 'Plan Rows': 1, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'region', 'Alias': 'region', 'Startup Cost': 0.0, 'Total Cost': 1.06, 'Plan Rows': 1, 'Plan Width': 4, 'Filter': ""(r_name = 'AMERICA'::bpchar)""}]}]}]}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.25, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'n2', 'Startup Cost': 0.0, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 68, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]"
17,"



-- using default substitutions


select
	o_year,
	sum(case
		when nation = 'BRAZIL' then volume
		else 0
	end) / sum(volume) as mkt_share
from
	(
		select
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) as volume,
			n2.n_name as nation
		from
			part,
			supplier,
			lineitem,
			orders,
			customer,
			nation n1,
			nation n2,
			region
		where
			p_partkey = l_partkey
			and s_suppkey = l_suppkey
			and l_orderkey = o_orderkey
			and o_custkey = c_custkey
			and c_nationkey = n1.n_nationkey
			and n1.n_regionkey = r_regionkey
			and r_name = 'AMERICA'
			and s_nationkey = n2.n_nationkey
			and o_orderdate between date '1995-01-01' and date '1996-12-31'
			and p_type = 'ECONOMY ANODIZED STEEL'
	) as all_nations
group by
	o_year
order by
	o_year","['I(C lineitem.l_partkey)', 'I(C part.p_type)']",1936032.45,1034988.95,15659.025,3431.419,-0.3154591392620953,0.4654072301319123,0.7808663693940077,"[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 1935302.87, 'Total Cost': 1936020.08, 'Plan Rows': 2406, 'Plan Width': 40, 'Group Key': [""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1935302.87, 'Total Cost': 1935935.87, 'Plan Rows': 2406, 'Plan Width': 72, 'Workers Planned': 1, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1934302.86, 'Total Cost': 1934665.19, 'Plan Rows': 2406, 'Plan Width': 72, 'Group Key': [""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1934302.86, 'Total Cost': 1934337.77, 'Plan Rows': 13965, 'Plan Width': 46, 'Sort Key': [""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 1929996.54, 'Total Cost': 1933341.4, 'Plan Rows': 13965, 'Plan Width': 46, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = n2.n_nationkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1929994.98, 'Total Cost': 1933077.99, 'Plan Rows': 13965, 'Plan Width': 20, 'Inner Unique': False, 'Hash Cond': '(supplier.s_suppkey = lineitem.l_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1929871.33, 'Total Cost': 1929871.33, 'Plan Rows': 9892, 'Plan Width': 20, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 1884960.57, 'Total Cost': 1929871.33, 'Plan Rows': 9892, 'Plan Width': 20, 'Inner Unique': False, 'Hash Cond': '(customer.c_nationkey = n1.n_nationkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1884958.04, 'Total Cost': 1929584.41, 'Plan Rows': 49458, 'Plan Width': 24, 'Inner Unique': False, 'Hash Cond': '(customer.c_custkey = orders.o_custkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'customer', 'Alias': 'customer', 'Startup Cost': 0.0, 'Total Cost': 42076.67, 'Plan Rows': 624967, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1884339.81, 'Total Cost': 1884339.81, 'Plan Rows': 49458, 'Plan Width': 24, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1522386.94, 'Total Cost': 1884339.81, 'Plan Rows': 49458, 'Plan Width': 24, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = lineitem.l_orderkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.0, 'Total Cost': 354662.0, 'Plan Rows': 1889278, 'Plan Width': 12, 'Filter': ""((o_orderdate >= '1995-01-01'::date) AND (o_orderdate <= '1996-12-31'::date))""}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1520341.75, 'Total Cost': 1520341.75, 'Plan Rows': 163615, 'Plan Width': 20, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 51447.94, 'Total Cost': 1520341.75, 'Plan Rows': 163615, 'Plan Width': 20, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1374483.88, 'Plan Rows': 24994188, 'Plan Width': 24}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 51378.67, 'Total Cost': 51378.67, 'Plan Rows': 5542, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 5542, 'Plan Width': 4, 'Filter': ""((p_type)::text = 'ECONOMY ANODIZED STEEL'::text)""}]}]}]}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 2.47, 'Total Cost': 2.47, 'Plan Rows': 5, 'Plan Width': 4, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 1.07, 'Total Cost': 2.47, 'Plan Rows': 5, 'Plan Width': 4, 'Inner Unique': False, 'Hash Cond': '(n1.n_regionkey = region.r_regionkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'n1', 'Startup Cost': 0.0, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.06, 'Total Cost': 1.06, 'Plan Rows': 1, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'region', 'Alias': 'region', 'Startup Cost': 0.0, 'Total Cost': 1.06, 'Plan Rows': 1, 'Plan Width': 4, 'Filter': ""(r_name = 'AMERICA'::bpchar)""}]}]}]}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.25, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'n2', 'Startup Cost': 0.0, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 74, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]","[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 1034259.36, 'Total Cost': 1034976.58, 'Plan Rows': 2406, 'Plan Width': 40, 'Group Key': [""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1034259.36, 'Total Cost': 1034892.37, 'Plan Rows': 2406, 'Plan Width': 72, 'Workers Planned': 1, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1033259.35, 'Total Cost': 1033621.68, 'Plan Rows': 2406, 'Plan Width': 72, 'Group Key': [""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1033259.35, 'Total Cost': 1033294.26, 'Plan Rows': 13965, 'Plan Width': 46, 'Sort Key': [""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 1028953.03, 'Total Cost': 1032297.89, 'Plan Rows': 13965, 'Plan Width': 46, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = n2.n_nationkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1028951.47, 'Total Cost': 1032034.49, 'Plan Rows': 13965, 'Plan Width': 20, 'Inner Unique': False, 'Hash Cond': '(supplier.s_suppkey = lineitem.l_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1028827.82, 'Total Cost': 1028827.82, 'Plan Rows': 9892, 'Plan Width': 20, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 983917.06, 'Total Cost': 1028827.82, 'Plan Rows': 9892, 'Plan Width': 20, 'Inner Unique': False, 'Hash Cond': '(customer.c_nationkey = n1.n_nationkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 983914.53, 'Total Cost': 1028540.9, 'Plan Rows': 49458, 'Plan Width': 24, 'Inner Unique': False, 'Hash Cond': '(customer.c_custkey = orders.o_custkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'customer', 'Alias': 'customer', 'Startup Cost': 0.0, 'Total Cost': 42076.67, 'Plan Rows': 624967, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 983296.31, 'Total Cost': 983296.31, 'Plan Rows': 49458, 'Plan Width': 24, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 621343.43, 'Total Cost': 983296.31, 'Plan Rows': 49458, 'Plan Width': 24, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = lineitem.l_orderkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.0, 'Total Cost': 354662.0, 'Plan Rows': 1889278, 'Plan Width': 12, 'Filter': ""((o_orderdate >= '1995-01-01'::date) AND (o_orderdate <= '1996-12-31'::date))""}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 619298.25, 'Total Cost': 619298.25, 'Plan Rows': 163615, 'Plan Width': 20, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 419.2, 'Total Cost': 619298.25, 'Plan Rows': 163615, 'Plan Width': 20, 'Inner Unique': False, 'Plans': [{'Node Type': 'Bitmap Heap Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 419.14, 'Total Cost': 28117.72, 'Plan Rows': 5542, 'Plan Width': 4, 'Recheck Cond': ""((p_type)::text = 'ECONOMY ANODIZED STEEL'::text)"", 'Plans': [{'Node Type': 'Bitmap Index Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Index Name': '<13412>btree_part_p_type', 'Startup Cost': 0.0, 'Total Cost': 415.81, 'Plan Rows': 13301, 'Plan Width': 0, 'Index Cond': ""((p_type)::text = 'ECONOMY ANODIZED STEEL'::text)""}]}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13411>btree_lineitem_l_partkey', 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.07, 'Total Cost': 106.37, 'Plan Rows': 30, 'Plan Width': 24, 'Index Cond': '(l_partkey = part.p_partkey)'}]}]}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 2.47, 'Total Cost': 2.47, 'Plan Rows': 5, 'Plan Width': 4, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 1.07, 'Total Cost': 2.47, 'Plan Rows': 5, 'Plan Width': 4, 'Inner Unique': False, 'Hash Cond': '(n1.n_regionkey = region.r_regionkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'n1', 'Startup Cost': 0.0, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.06, 'Total Cost': 1.06, 'Plan Rows': 1, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'region', 'Alias': 'region', 'Startup Cost': 0.0, 'Total Cost': 1.06, 'Plan Rows': 1, 'Plan Width': 4, 'Filter': ""(r_name = 'AMERICA'::bpchar)""}]}]}]}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.25, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'n2', 'Startup Cost': 0.0, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 68, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]"
18,"



-- using default substitutions


select
	o_year,
	sum(case
		when nation = 'BRAZIL' then volume
		else 0
	end) / sum(volume) as mkt_share
from
	(
		select
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) as volume,
			n2.n_name as nation
		from
			part,
			supplier,
			lineitem,
			orders,
			customer,
			nation n1,
			nation n2,
			region
		where
			p_partkey = l_partkey
			and s_suppkey = l_suppkey
			and l_orderkey = o_orderkey
			and o_custkey = c_custkey
			and c_nationkey = n1.n_nationkey
			and n1.n_regionkey = r_regionkey
			and r_name = 'AMERICA'
			and s_nationkey = n2.n_nationkey
			and o_orderdate between date '1995-01-01' and date '1996-12-31'
			and p_type = 'ECONOMY ANODIZED STEEL'
	) as all_nations
group by
	o_year
order by
	o_year",['I(C part.p_type)'],1936032.45,1912771.51,15659.025,9814.766,-0.3612051054857418,0.012014746963564554,0.3732198524493064,"[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 1935302.87, 'Total Cost': 1936020.08, 'Plan Rows': 2406, 'Plan Width': 40, 'Group Key': [""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1935302.87, 'Total Cost': 1935935.87, 'Plan Rows': 2406, 'Plan Width': 72, 'Workers Planned': 1, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1934302.86, 'Total Cost': 1934665.19, 'Plan Rows': 2406, 'Plan Width': 72, 'Group Key': [""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1934302.86, 'Total Cost': 1934337.77, 'Plan Rows': 13965, 'Plan Width': 46, 'Sort Key': [""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 1929996.54, 'Total Cost': 1933341.4, 'Plan Rows': 13965, 'Plan Width': 46, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = n2.n_nationkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1929994.98, 'Total Cost': 1933077.99, 'Plan Rows': 13965, 'Plan Width': 20, 'Inner Unique': False, 'Hash Cond': '(supplier.s_suppkey = lineitem.l_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1929871.33, 'Total Cost': 1929871.33, 'Plan Rows': 9892, 'Plan Width': 20, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 1884960.57, 'Total Cost': 1929871.33, 'Plan Rows': 9892, 'Plan Width': 20, 'Inner Unique': False, 'Hash Cond': '(customer.c_nationkey = n1.n_nationkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1884958.04, 'Total Cost': 1929584.41, 'Plan Rows': 49458, 'Plan Width': 24, 'Inner Unique': False, 'Hash Cond': '(customer.c_custkey = orders.o_custkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'customer', 'Alias': 'customer', 'Startup Cost': 0.0, 'Total Cost': 42076.67, 'Plan Rows': 624967, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1884339.81, 'Total Cost': 1884339.81, 'Plan Rows': 49458, 'Plan Width': 24, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1522386.94, 'Total Cost': 1884339.81, 'Plan Rows': 49458, 'Plan Width': 24, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = lineitem.l_orderkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.0, 'Total Cost': 354662.0, 'Plan Rows': 1889278, 'Plan Width': 12, 'Filter': ""((o_orderdate >= '1995-01-01'::date) AND (o_orderdate <= '1996-12-31'::date))""}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1520341.75, 'Total Cost': 1520341.75, 'Plan Rows': 163615, 'Plan Width': 20, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 51447.94, 'Total Cost': 1520341.75, 'Plan Rows': 163615, 'Plan Width': 20, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1374483.88, 'Plan Rows': 24994188, 'Plan Width': 24}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 51378.67, 'Total Cost': 51378.67, 'Plan Rows': 5542, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 5542, 'Plan Width': 4, 'Filter': ""((p_type)::text = 'ECONOMY ANODIZED STEEL'::text)""}]}]}]}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 2.47, 'Total Cost': 2.47, 'Plan Rows': 5, 'Plan Width': 4, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 1.07, 'Total Cost': 2.47, 'Plan Rows': 5, 'Plan Width': 4, 'Inner Unique': False, 'Hash Cond': '(n1.n_regionkey = region.r_regionkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'n1', 'Startup Cost': 0.0, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.06, 'Total Cost': 1.06, 'Plan Rows': 1, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'region', 'Alias': 'region', 'Startup Cost': 0.0, 'Total Cost': 1.06, 'Plan Rows': 1, 'Plan Width': 4, 'Filter': ""(r_name = 'AMERICA'::bpchar)""}]}]}]}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.25, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'n2', 'Startup Cost': 0.0, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 74, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]","[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 1912041.92, 'Total Cost': 1912759.14, 'Plan Rows': 2406, 'Plan Width': 40, 'Group Key': [""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1912041.92, 'Total Cost': 1912674.93, 'Plan Rows': 2406, 'Plan Width': 72, 'Workers Planned': 1, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1911041.91, 'Total Cost': 1911404.24, 'Plan Rows': 2406, 'Plan Width': 72, 'Group Key': [""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1911041.91, 'Total Cost': 1911076.82, 'Plan Rows': 13965, 'Plan Width': 46, 'Sort Key': [""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 1906735.59, 'Total Cost': 1910080.45, 'Plan Rows': 13965, 'Plan Width': 46, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = n2.n_nationkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1906734.03, 'Total Cost': 1909817.05, 'Plan Rows': 13965, 'Plan Width': 20, 'Inner Unique': False, 'Hash Cond': '(supplier.s_suppkey = lineitem.l_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1906610.38, 'Total Cost': 1906610.38, 'Plan Rows': 9892, 'Plan Width': 20, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 1861699.62, 'Total Cost': 1906610.38, 'Plan Rows': 9892, 'Plan Width': 20, 'Inner Unique': False, 'Hash Cond': '(customer.c_nationkey = n1.n_nationkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1861697.09, 'Total Cost': 1906323.46, 'Plan Rows': 49458, 'Plan Width': 24, 'Inner Unique': False, 'Hash Cond': '(customer.c_custkey = orders.o_custkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'customer', 'Alias': 'customer', 'Startup Cost': 0.0, 'Total Cost': 42076.67, 'Plan Rows': 624967, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1861078.86, 'Total Cost': 1861078.86, 'Plan Rows': 49458, 'Plan Width': 24, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1499125.99, 'Total Cost': 1861078.86, 'Plan Rows': 49458, 'Plan Width': 24, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = lineitem.l_orderkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.0, 'Total Cost': 354662.0, 'Plan Rows': 1889278, 'Plan Width': 12, 'Filter': ""((o_orderdate >= '1995-01-01'::date) AND (o_orderdate <= '1996-12-31'::date))""}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1497080.8, 'Total Cost': 1497080.8, 'Plan Rows': 163615, 'Plan Width': 20, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 28186.99, 'Total Cost': 1497080.8, 'Plan Rows': 163615, 'Plan Width': 20, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1374483.88, 'Plan Rows': 24994188, 'Plan Width': 24}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 28117.72, 'Total Cost': 28117.72, 'Plan Rows': 5542, 'Plan Width': 4, 'Plans': [{'Node Type': 'Bitmap Heap Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 419.14, 'Total Cost': 28117.72, 'Plan Rows': 5542, 'Plan Width': 4, 'Recheck Cond': ""((p_type)::text = 'ECONOMY ANODIZED STEEL'::text)"", 'Plans': [{'Node Type': 'Bitmap Index Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Index Name': '<13411>btree_part_p_type', 'Startup Cost': 0.0, 'Total Cost': 415.81, 'Plan Rows': 13301, 'Plan Width': 0, 'Index Cond': ""((p_type)::text = 'ECONOMY ANODIZED STEEL'::text)""}]}]}]}]}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 2.47, 'Total Cost': 2.47, 'Plan Rows': 5, 'Plan Width': 4, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 1.07, 'Total Cost': 2.47, 'Plan Rows': 5, 'Plan Width': 4, 'Inner Unique': False, 'Hash Cond': '(n1.n_regionkey = region.r_regionkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'n1', 'Startup Cost': 0.0, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.06, 'Total Cost': 1.06, 'Plan Rows': 1, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'region', 'Alias': 'region', 'Startup Cost': 0.0, 'Total Cost': 1.06, 'Plan Rows': 1, 'Plan Width': 4, 'Filter': ""(r_name = 'AMERICA'::bpchar)""}]}]}]}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.25, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'n2', 'Startup Cost': 0.0, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 74, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]"
19,"



-- using default substitutions


select
	o_orderpriority,
	count(*) as order_count
from
	orders
where
	o_orderdate >= date '1993-07-01'
	and o_orderdate < date '1993-07-01' + interval '3' month
	and exists (
		select
			*
		from
			lineitem
		where
			l_orderkey = o_orderkey
			and l_commitdate < l_receiptdate
	)
group by
	o_orderpriority
order by
	o_orderpriority",['I(C lineitem.l_orderkey)'],1897996.44,429080.88,9367.513,3500.018,0.1475632075733697,0.7739295654316402,0.6263663578582704,"[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 1897932.45, 'Total Cost': 1897984.86, 'Plan Rows': 5, 'Plan Width': 24, 'Group Key': ['orders.o_orderpriority'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1897932.45, 'Total Cost': 1897984.76, 'Plan Rows': 10, 'Plan Width': 24, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1896932.42, 'Total Cost': 1896983.59, 'Plan Rows': 5, 'Plan Width': 24, 'Group Key': ['orders.o_orderpriority'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1896932.42, 'Total Cost': 1896949.46, 'Plan Rows': 6815, 'Plan Width': 16, 'Sort Key': ['orders.o_orderpriority'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Semi', 'Startup Cost': 1541111.8, 'Total Cost': 1896498.49, 'Plan Rows': 6815, 'Plan Width': 16, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = lineitem.l_orderkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.0, 'Total Cost': 354662.0, 'Plan Rows': 243940, 'Plan Width': 20, 'Filter': ""((o_orderdate >= '1993-07-01'::date) AND (o_orderdate < '1993-10-01 00:00:00'::timestamp without time zone))""}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1436969.35, 'Total Cost': 1436969.35, 'Plan Rows': 8331396, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1436969.35, 'Plan Rows': 8331396, 'Plan Width': 4, 'Filter': '(l_commitdate < l_receiptdate)'}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 21, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]","[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 429010.93, 'Total Cost': 429063.35, 'Plan Rows': 5, 'Plan Width': 24, 'Group Key': ['orders.o_orderpriority'], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 429010.93, 'Total Cost': 429063.25, 'Plan Rows': 10, 'Plan Width': 24, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 428010.91, 'Total Cost': 428062.07, 'Plan Rows': 5, 'Plan Width': 24, 'Group Key': ['orders.o_orderpriority'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 428010.91, 'Total Cost': 428027.95, 'Plan Rows': 6815, 'Plan Width': 16, 'Sort Key': ['orders.o_orderpriority'], 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Semi', 'Startup Cost': 0.07, 'Total Cost': 427576.98, 'Plan Rows': 6815, 'Plan Width': 16, 'Inner Unique': False, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.0, 'Total Cost': 354662.0, 'Plan Rows': 243940, 'Plan Width': 20, 'Filter': ""((o_orderdate >= '1993-07-01'::date) AND (o_orderdate < '1993-10-01 00:00:00'::timestamp without time zone))""}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13411>btree_lineitem_l_orderkey', 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.07, 'Total Cost': 10.97, 'Plan Rows': 48, 'Plan Width': 4, 'Index Cond': '(l_orderkey = orders.o_orderkey)', 'Filter': '(l_commitdate < l_receiptdate)'}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 15, 'Options': {'Inlining': False, 'Optimization': False, 'Expressions': True, 'Deforming': True}}}]"
20,"



-- using default substitutions


select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%green%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc",['I(C partsupp.ps_partkey)'],2122683.97,2122683.97,24510.436,22937.411,-0.0641777649324557,0.0,0.06417776493245576,"[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 2122662.98, 'Total Cost': 2122673.42, 'Plan Rows': 94, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2122662.98, 'Total Cost': 2122671.23, 'Plan Rows': 55, 'Plan Width': 66, 'Workers Planned': 1, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.97, 'Total Cost': 2121665.03, 'Plan Rows': 55, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.97, 'Total Cost': 2121663.11, 'Plan Rows': 55, 'Plan Width': 57, 'Sort Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC""], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 2118635.28, 'Total Cost': 2121661.38, 'Plan Rows': 55, 'Plan Width': 57, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = nation.n_nationkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 2118633.72, 'Total Cost': 2121658.79, 'Plan Rows': 55, 'Plan Width': 31, 'Inner Unique': False, 'Hash Cond': '(supplier.s_suppkey = lineitem.l_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 2118633.22, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1771783.55, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = lineitem.l_orderkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.0, 'Total Cost': 323412.0, 'Plan Rows': 6250000, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1771783.05, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1539063.56, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '((partsupp.ps_suppkey = lineitem.l_suppkey) AND (partsupp.ps_partkey = lineitem.l_partkey))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'partsupp', 'Alias': 'partsupp', 'Startup Cost': 0.0, 'Total Cost': 207719.33, 'Plan Rows': 3333333, 'Plan Width': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1524153.35, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 51799.54, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1374483.88, 'Plan Rows': 24994188, 'Plan Width': 29}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 51378.67, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Filter': ""((p_name)::text ~~ '%green%'::text)""}]}]}]}]}]}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.25, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.0, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 59, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]","[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 2122662.98, 'Total Cost': 2122673.42, 'Plan Rows': 94, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2122662.98, 'Total Cost': 2122671.23, 'Plan Rows': 55, 'Plan Width': 66, 'Workers Planned': 1, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.97, 'Total Cost': 2121665.03, 'Plan Rows': 55, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.97, 'Total Cost': 2121663.11, 'Plan Rows': 55, 'Plan Width': 57, 'Sort Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC""], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 2118635.28, 'Total Cost': 2121661.38, 'Plan Rows': 55, 'Plan Width': 57, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = nation.n_nationkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 2118633.72, 'Total Cost': 2121658.79, 'Plan Rows': 55, 'Plan Width': 31, 'Inner Unique': False, 'Hash Cond': '(supplier.s_suppkey = lineitem.l_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 2118633.22, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1771783.55, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = lineitem.l_orderkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.0, 'Total Cost': 323412.0, 'Plan Rows': 6250000, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1771783.05, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1539063.56, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '((partsupp.ps_suppkey = lineitem.l_suppkey) AND (partsupp.ps_partkey = lineitem.l_partkey))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'partsupp', 'Alias': 'partsupp', 'Startup Cost': 0.0, 'Total Cost': 207719.33, 'Plan Rows': 3333333, 'Plan Width': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1524153.35, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 51799.54, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1374483.88, 'Plan Rows': 24994188, 'Plan Width': 29}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 51378.67, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Filter': ""((p_name)::text ~~ '%green%'::text)""}]}]}]}]}]}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.25, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.0, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 59, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]"
21,"



-- using default substitutions


select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%green%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc","['I(C partsupp.ps_partkey)', 'I(C lineitem.l_partkey,C lineitem.l_suppkey)']",2122683.97,681888.7,24510.436,15913.382,0.3280103250791111,0.6787610828379695,0.3507507577588584,"[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 2122662.98, 'Total Cost': 2122673.42, 'Plan Rows': 94, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2122662.98, 'Total Cost': 2122671.23, 'Plan Rows': 55, 'Plan Width': 66, 'Workers Planned': 1, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.97, 'Total Cost': 2121665.03, 'Plan Rows': 55, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.97, 'Total Cost': 2121663.11, 'Plan Rows': 55, 'Plan Width': 57, 'Sort Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC""], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 2118635.28, 'Total Cost': 2121661.38, 'Plan Rows': 55, 'Plan Width': 57, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = nation.n_nationkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 2118633.72, 'Total Cost': 2121658.79, 'Plan Rows': 55, 'Plan Width': 31, 'Inner Unique': False, 'Hash Cond': '(supplier.s_suppkey = lineitem.l_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 2118633.22, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1771783.55, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = lineitem.l_orderkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.0, 'Total Cost': 323412.0, 'Plan Rows': 6250000, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1771783.05, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1539063.56, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '((partsupp.ps_suppkey = lineitem.l_suppkey) AND (partsupp.ps_partkey = lineitem.l_partkey))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'partsupp', 'Alias': 'partsupp', 'Startup Cost': 0.0, 'Total Cost': 207719.33, 'Plan Rows': 3333333, 'Plan Width': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1524153.35, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 51799.54, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1374483.88, 'Plan Rows': 24994188, 'Plan Width': 29}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 51378.67, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Filter': ""((p_name)::text ~~ '%green%'::text)""}]}]}]}]}]}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.25, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.0, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 59, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]","[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 681867.71, 'Total Cost': 681878.16, 'Plan Rows': 94, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 681867.71, 'Total Cost': 681875.96, 'Plan Rows': 55, 'Plan Width': 66, 'Workers Planned': 1, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 680867.7, 'Total Cost': 680869.76, 'Plan Rows': 55, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 680867.7, 'Total Cost': 680867.84, 'Plan Rows': 55, 'Plan Width': 57, 'Sort Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC""], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 677840.01, 'Total Cost': 680866.11, 'Plan Rows': 55, 'Plan Width': 57, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = nation.n_nationkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 677838.45, 'Total Cost': 680863.52, 'Plan Rows': 55, 'Plan Width': 31, 'Inner Unique': False, 'Hash Cond': '(supplier.s_suppkey = lineitem.l_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 677837.95, 'Total Cost': 677837.95, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 330988.28, 'Total Cost': 677837.95, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = lineitem.l_orderkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.0, 'Total Cost': 323412.0, 'Plan Rows': 6250000, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 330987.78, 'Total Cost': 330987.78, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 0.12, 'Total Cost': 330987.78, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 0.06, 'Total Cost': 221853.01, 'Plan Rows': 134680, 'Plan Width': 18, 'Inner Unique': False, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Filter': ""((p_name)::text ~~ '%green%'::text)""}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13411>btree_partsupp_ps_partkey', 'Relation Name': 'partsupp', 'Alias': 'partsupp', 'Startup Cost': 0.06, 'Total Cost': 4.88, 'Plan Rows': 18, 'Plan Width': 14, 'Index Cond': '(ps_partkey = part.p_partkey)'}]}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13412>btree_lineitem_l_partkey_l_suppkey', 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.07, 'Total Cost': 0.8, 'Plan Rows': 1, 'Plan Width': 29, 'Index Cond': '((l_partkey = partsupp.ps_partkey) AND (l_suppkey = partsupp.ps_suppkey))'}]}]}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.25, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.0, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 45, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]"
22,"



-- using default substitutions


select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%green%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc","['I(C partsupp.ps_partkey)', 'I(C supplier.s_suppkey,C supplier.s_nationkey)']",2122683.97,2119662.79,24510.436,18446.507,-0.2459786400054683,0.0014232829958197534,0.2474019230012881,"[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 2122662.98, 'Total Cost': 2122673.42, 'Plan Rows': 94, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2122662.98, 'Total Cost': 2122671.23, 'Plan Rows': 55, 'Plan Width': 66, 'Workers Planned': 1, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.97, 'Total Cost': 2121665.03, 'Plan Rows': 55, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.97, 'Total Cost': 2121663.11, 'Plan Rows': 55, 'Plan Width': 57, 'Sort Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC""], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 2118635.28, 'Total Cost': 2121661.38, 'Plan Rows': 55, 'Plan Width': 57, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = nation.n_nationkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 2118633.72, 'Total Cost': 2121658.79, 'Plan Rows': 55, 'Plan Width': 31, 'Inner Unique': False, 'Hash Cond': '(supplier.s_suppkey = lineitem.l_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 2118633.22, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1771783.55, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = lineitem.l_orderkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.0, 'Total Cost': 323412.0, 'Plan Rows': 6250000, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1771783.05, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1539063.56, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '((partsupp.ps_suppkey = lineitem.l_suppkey) AND (partsupp.ps_partkey = lineitem.l_partkey))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'partsupp', 'Alias': 'partsupp', 'Startup Cost': 0.0, 'Total Cost': 207719.33, 'Plan Rows': 3333333, 'Plan Width': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1524153.35, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 51799.54, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1374483.88, 'Plan Rows': 24994188, 'Plan Width': 29}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 51378.67, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Filter': ""((p_name)::text ~~ '%green%'::text)""}]}]}]}]}]}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.25, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.0, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 59, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]","[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 2119639.35, 'Total Cost': 2119652.24, 'Plan Rows': 94, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2119639.35, 'Total Cost': 2119649.82, 'Plan Rows': 78, 'Plan Width': 66, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2118639.33, 'Total Cost': 2118640.79, 'Plan Rows': 39, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2118639.33, 'Total Cost': 2118639.43, 'Plan Rows': 39, 'Plan Width': 57, 'Sort Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC""], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 1771787.91, 'Total Cost': 2118638.3, 'Plan Rows': 39, 'Plan Width': 57, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = nation.n_nationkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1771786.35, 'Total Cost': 2118636.01, 'Plan Rows': 39, 'Plan Width': 31, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = lineitem.l_orderkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.0, 'Total Cost': 323412.0, 'Plan Rows': 6250000, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1771785.86, 'Total Cost': 1771785.86, 'Plan Rows': 39, 'Plan Width': 31, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 1539063.6, 'Total Cost': 1771785.86, 'Plan Rows': 39, 'Plan Width': 31, 'Inner Unique': False, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1539063.56, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '((partsupp.ps_suppkey = lineitem.l_suppkey) AND (partsupp.ps_partkey = lineitem.l_partkey))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'partsupp', 'Alias': 'partsupp', 'Startup Cost': 0.0, 'Total Cost': 207719.33, 'Plan Rows': 3333333, 'Plan Width': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1524153.35, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 51799.54, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1374483.88, 'Plan Rows': 24994188, 'Plan Width': 29}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 51378.67, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Filter': ""((p_name)::text ~~ '%green%'::text)""}]}]}]}]}, {'Node Type': 'Index Only Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13412>btree_supplier_s_suppkey_s_nationkey', 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.04, 'Total Cost': 0.06, 'Plan Rows': 1, 'Plan Width': 8, 'Index Cond': '(s_suppkey = lineitem.l_suppkey)'}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.25, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.0, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 52, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]"
23,"



-- using default substitutions


select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%green%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc","['I(C partsupp.ps_partkey)', 'I(C nation.n_nationkey,C nation.n_name)']",2122683.97,2122683.85,24510.436,24825.946,0.0128725325664925,5.6532202535904906e-08,0.0,"[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 2122662.98, 'Total Cost': 2122673.42, 'Plan Rows': 94, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2122662.98, 'Total Cost': 2122671.23, 'Plan Rows': 55, 'Plan Width': 66, 'Workers Planned': 1, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.97, 'Total Cost': 2121665.03, 'Plan Rows': 55, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.97, 'Total Cost': 2121663.11, 'Plan Rows': 55, 'Plan Width': 57, 'Sort Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC""], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 2118635.28, 'Total Cost': 2121661.38, 'Plan Rows': 55, 'Plan Width': 57, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = nation.n_nationkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 2118633.72, 'Total Cost': 2121658.79, 'Plan Rows': 55, 'Plan Width': 31, 'Inner Unique': False, 'Hash Cond': '(supplier.s_suppkey = lineitem.l_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 2118633.22, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1771783.55, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = lineitem.l_orderkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.0, 'Total Cost': 323412.0, 'Plan Rows': 6250000, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1771783.05, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1539063.56, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '((partsupp.ps_suppkey = lineitem.l_suppkey) AND (partsupp.ps_partkey = lineitem.l_partkey))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'partsupp', 'Alias': 'partsupp', 'Startup Cost': 0.0, 'Total Cost': 207719.33, 'Plan Rows': 3333333, 'Plan Width': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1524153.35, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 51799.54, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1374483.88, 'Plan Rows': 24994188, 'Plan Width': 29}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 51378.67, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Filter': ""((p_name)::text ~~ '%green%'::text)""}]}]}]}]}]}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.25, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.0, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 59, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]","[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 2122662.87, 'Total Cost': 2122673.31, 'Plan Rows': 94, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2122662.87, 'Total Cost': 2122671.12, 'Plan Rows': 55, 'Plan Width': 66, 'Workers Planned': 1, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.86, 'Total Cost': 2121664.92, 'Plan Rows': 55, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.86, 'Total Cost': 2121662.99, 'Plan Rows': 55, 'Plan Width': 57, 'Sort Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC""], 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 2118633.73, 'Total Cost': 2121661.27, 'Plan Rows': 55, 'Plan Width': 57, 'Inner Unique': False, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 2118633.72, 'Total Cost': 2121658.79, 'Plan Rows': 55, 'Plan Width': 31, 'Inner Unique': False, 'Hash Cond': '(supplier.s_suppkey = lineitem.l_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 2118633.22, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1771783.55, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = lineitem.l_orderkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.0, 'Total Cost': 323412.0, 'Plan Rows': 6250000, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1771783.05, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1539063.56, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '((partsupp.ps_suppkey = lineitem.l_suppkey) AND (partsupp.ps_partkey = lineitem.l_partkey))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'partsupp', 'Alias': 'partsupp', 'Startup Cost': 0.0, 'Total Cost': 207719.33, 'Plan Rows': 3333333, 'Plan Width': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1524153.35, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 51799.54, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1374483.88, 'Plan Rows': 24994188, 'Plan Width': 29}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 51378.67, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Filter': ""((p_name)::text ~~ '%green%'::text)""}]}]}]}]}]}]}]}]}, {'Node Type': 'Index Only Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13412>btree_nation_n_nationkey_n_name', 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.01, 'Total Cost': 0.03, 'Plan Rows': 1, 'Plan Width': 30, 'Index Cond': '(n_nationkey = supplier.s_nationkey)'}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 53, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]"
24,"



-- using default substitutions


select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%green%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc","['I(C partsupp.ps_partkey)', 'I(C orders.o_orderkey)']",2122683.97,1775827.58,24510.436,28872.208,0.3413603389365865,0.16340463060075783,0.0,"[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 2122662.98, 'Total Cost': 2122673.42, 'Plan Rows': 94, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2122662.98, 'Total Cost': 2122671.23, 'Plan Rows': 55, 'Plan Width': 66, 'Workers Planned': 1, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.97, 'Total Cost': 2121665.03, 'Plan Rows': 55, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.97, 'Total Cost': 2121663.11, 'Plan Rows': 55, 'Plan Width': 57, 'Sort Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC""], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 2118635.28, 'Total Cost': 2121661.38, 'Plan Rows': 55, 'Plan Width': 57, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = nation.n_nationkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 2118633.72, 'Total Cost': 2121658.79, 'Plan Rows': 55, 'Plan Width': 31, 'Inner Unique': False, 'Hash Cond': '(supplier.s_suppkey = lineitem.l_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 2118633.22, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1771783.55, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = lineitem.l_orderkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.0, 'Total Cost': 323412.0, 'Plan Rows': 6250000, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1771783.05, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1539063.56, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '((partsupp.ps_suppkey = lineitem.l_suppkey) AND (partsupp.ps_partkey = lineitem.l_partkey))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'partsupp', 'Alias': 'partsupp', 'Startup Cost': 0.0, 'Total Cost': 207719.33, 'Plan Rows': 3333333, 'Plan Width': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1524153.35, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 51799.54, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1374483.88, 'Plan Rows': 24994188, 'Plan Width': 29}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 51378.67, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Filter': ""((p_name)::text ~~ '%green%'::text)""}]}]}]}]}]}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.25, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.0, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 59, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]","[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 1775817.13, 'Total Cost': 1775827.58, 'Plan Rows': 94, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1775817.13, 'Total Cost': 1775825.38, 'Plan Rows': 55, 'Plan Width': 66, 'Workers Planned': 1, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1774817.12, 'Total Cost': 1774819.19, 'Plan Rows': 55, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1774817.12, 'Total Cost': 1774817.26, 'Plan Rows': 55, 'Plan Width': 57, 'Sort Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC""], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 1771789.44, 'Total Cost': 1774815.53, 'Plan Rows': 55, 'Plan Width': 57, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = nation.n_nationkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1771787.87, 'Total Cost': 1774812.94, 'Plan Rows': 55, 'Plan Width': 31, 'Inner Unique': False, 'Hash Cond': '(supplier.s_suppkey = lineitem.l_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1771787.37, 'Total Cost': 1771787.37, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 1539063.62, 'Total Cost': 1771787.37, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1539063.56, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '((partsupp.ps_suppkey = lineitem.l_suppkey) AND (partsupp.ps_partkey = lineitem.l_partkey))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'partsupp', 'Alias': 'partsupp', 'Startup Cost': 0.0, 'Total Cost': 207719.33, 'Plan Rows': 3333333, 'Plan Width': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1524153.35, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 51799.54, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1374483.88, 'Plan Rows': 24994188, 'Plan Width': 29}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 51378.67, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Filter': ""((p_name)::text ~~ '%green%'::text)""}]}]}]}]}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13412>btree_orders_o_orderkey', 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.06, 'Total Cost': 0.1, 'Plan Rows': 1, 'Plan Width': 8, 'Index Cond': '(o_orderkey = lineitem.l_orderkey)'}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.25, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.0, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 54, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]"
25,"



-- using default substitutions


select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%green%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc","['I(C partsupp.ps_partkey)', 'I(C supplier.s_suppkey,C supplier.s_nationkey)', 'I(C lineitem.l_partkey,C lineitem.l_suppkey)']",2122683.97,678856.97,24510.436,12233.284,0.1792944518345784,0.6801893359565909,0.5008948841220124,"[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 2122662.98, 'Total Cost': 2122673.42, 'Plan Rows': 94, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2122662.98, 'Total Cost': 2122671.23, 'Plan Rows': 55, 'Plan Width': 66, 'Workers Planned': 1, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.97, 'Total Cost': 2121665.03, 'Plan Rows': 55, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.97, 'Total Cost': 2121663.11, 'Plan Rows': 55, 'Plan Width': 57, 'Sort Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC""], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 2118635.28, 'Total Cost': 2121661.38, 'Plan Rows': 55, 'Plan Width': 57, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = nation.n_nationkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 2118633.72, 'Total Cost': 2121658.79, 'Plan Rows': 55, 'Plan Width': 31, 'Inner Unique': False, 'Hash Cond': '(supplier.s_suppkey = lineitem.l_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 2118633.22, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1771783.55, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = lineitem.l_orderkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.0, 'Total Cost': 323412.0, 'Plan Rows': 6250000, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1771783.05, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1539063.56, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '((partsupp.ps_suppkey = lineitem.l_suppkey) AND (partsupp.ps_partkey = lineitem.l_partkey))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'partsupp', 'Alias': 'partsupp', 'Startup Cost': 0.0, 'Total Cost': 207719.33, 'Plan Rows': 3333333, 'Plan Width': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1524153.35, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 51799.54, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1374483.88, 'Plan Rows': 24994188, 'Plan Width': 29}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 51378.67, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Filter': ""((p_name)::text ~~ '%green%'::text)""}]}]}]}]}]}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.25, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.0, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 59, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]","[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 678844.08, 'Total Cost': 678856.97, 'Plan Rows': 94, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 678844.08, 'Total Cost': 678854.55, 'Plan Rows': 78, 'Plan Width': 66, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 677844.06, 'Total Cost': 677845.52, 'Plan Rows': 39, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 677844.06, 'Total Cost': 677844.16, 'Plan Rows': 39, 'Plan Width': 57, 'Sort Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC""], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 330992.64, 'Total Cost': 677843.03, 'Plan Rows': 39, 'Plan Width': 57, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = nation.n_nationkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 330991.08, 'Total Cost': 677840.74, 'Plan Rows': 39, 'Plan Width': 31, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = lineitem.l_orderkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.0, 'Total Cost': 323412.0, 'Plan Rows': 6250000, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 330990.59, 'Total Cost': 330990.59, 'Plan Rows': 39, 'Plan Width': 31, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 0.17, 'Total Cost': 330990.59, 'Plan Rows': 39, 'Plan Width': 31, 'Inner Unique': False, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 0.12, 'Total Cost': 330987.78, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 0.06, 'Total Cost': 221853.01, 'Plan Rows': 134680, 'Plan Width': 18, 'Inner Unique': False, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Filter': ""((p_name)::text ~~ '%green%'::text)""}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13411>btree_partsupp_ps_partkey', 'Relation Name': 'partsupp', 'Alias': 'partsupp', 'Startup Cost': 0.06, 'Total Cost': 4.88, 'Plan Rows': 18, 'Plan Width': 14, 'Index Cond': '(ps_partkey = part.p_partkey)'}]}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13413>btree_lineitem_l_partkey_l_suppkey', 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.07, 'Total Cost': 0.8, 'Plan Rows': 1, 'Plan Width': 29, 'Index Cond': '((l_partkey = partsupp.ps_partkey) AND (l_suppkey = partsupp.ps_suppkey))'}]}, {'Node Type': 'Index Only Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13412>btree_supplier_s_suppkey_s_nationkey', 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.04, 'Total Cost': 0.06, 'Plan Rows': 1, 'Plan Width': 8, 'Index Cond': '(s_suppkey = lineitem.l_suppkey)'}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.25, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.0, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 38, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]"
26,"



-- using default substitutions


select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%green%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc","['I(C partsupp.ps_partkey)', 'I(C nation.n_nationkey,C nation.n_name)', 'I(C lineitem.l_partkey,C lineitem.l_suppkey)']",2122683.97,681878.04,24510.436,15407.07,0.3073583501422595,0.6787661047819568,0.3714077546396972,"[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 2122662.98, 'Total Cost': 2122673.42, 'Plan Rows': 94, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2122662.98, 'Total Cost': 2122671.23, 'Plan Rows': 55, 'Plan Width': 66, 'Workers Planned': 1, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.97, 'Total Cost': 2121665.03, 'Plan Rows': 55, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.97, 'Total Cost': 2121663.11, 'Plan Rows': 55, 'Plan Width': 57, 'Sort Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC""], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 2118635.28, 'Total Cost': 2121661.38, 'Plan Rows': 55, 'Plan Width': 57, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = nation.n_nationkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 2118633.72, 'Total Cost': 2121658.79, 'Plan Rows': 55, 'Plan Width': 31, 'Inner Unique': False, 'Hash Cond': '(supplier.s_suppkey = lineitem.l_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 2118633.22, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1771783.55, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = lineitem.l_orderkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.0, 'Total Cost': 323412.0, 'Plan Rows': 6250000, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1771783.05, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1539063.56, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '((partsupp.ps_suppkey = lineitem.l_suppkey) AND (partsupp.ps_partkey = lineitem.l_partkey))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'partsupp', 'Alias': 'partsupp', 'Startup Cost': 0.0, 'Total Cost': 207719.33, 'Plan Rows': 3333333, 'Plan Width': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1524153.35, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 51799.54, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1374483.88, 'Plan Rows': 24994188, 'Plan Width': 29}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 51378.67, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Filter': ""((p_name)::text ~~ '%green%'::text)""}]}]}]}]}]}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.25, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.0, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 59, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]","[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 681867.6, 'Total Cost': 681878.04, 'Plan Rows': 94, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 681867.6, 'Total Cost': 681875.85, 'Plan Rows': 55, 'Plan Width': 66, 'Workers Planned': 1, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 680867.59, 'Total Cost': 680869.65, 'Plan Rows': 55, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 680867.59, 'Total Cost': 680867.72, 'Plan Rows': 55, 'Plan Width': 57, 'Sort Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC""], 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 677838.46, 'Total Cost': 680866.0, 'Plan Rows': 55, 'Plan Width': 57, 'Inner Unique': False, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 677838.45, 'Total Cost': 680863.52, 'Plan Rows': 55, 'Plan Width': 31, 'Inner Unique': False, 'Hash Cond': '(supplier.s_suppkey = lineitem.l_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 677837.95, 'Total Cost': 677837.95, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 330988.28, 'Total Cost': 677837.95, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = lineitem.l_orderkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.0, 'Total Cost': 323412.0, 'Plan Rows': 6250000, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 330987.78, 'Total Cost': 330987.78, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 0.12, 'Total Cost': 330987.78, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 0.06, 'Total Cost': 221853.01, 'Plan Rows': 134680, 'Plan Width': 18, 'Inner Unique': False, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Filter': ""((p_name)::text ~~ '%green%'::text)""}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13411>btree_partsupp_ps_partkey', 'Relation Name': 'partsupp', 'Alias': 'partsupp', 'Startup Cost': 0.06, 'Total Cost': 4.88, 'Plan Rows': 18, 'Plan Width': 14, 'Index Cond': '(ps_partkey = part.p_partkey)'}]}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13413>btree_lineitem_l_partkey_l_suppkey', 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.07, 'Total Cost': 0.8, 'Plan Rows': 1, 'Plan Width': 29, 'Index Cond': '((l_partkey = partsupp.ps_partkey) AND (l_suppkey = partsupp.ps_suppkey))'}]}]}]}]}]}, {'Node Type': 'Index Only Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13412>btree_nation_n_nationkey_n_name', 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.01, 'Total Cost': 0.03, 'Plan Rows': 1, 'Plan Width': 30, 'Index Cond': '(n_nationkey = supplier.s_nationkey)'}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 39, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]"
27,"



-- using default substitutions


select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%green%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc","['I(C partsupp.ps_partkey)', 'I(C lineitem.l_partkey,C lineitem.l_suppkey)', 'I(C orders.o_orderkey)']",2122683.97,335032.31,24510.436,18456.647,0.5951774917685783,0.8421657134387273,0.246988221670149,"[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 2122662.98, 'Total Cost': 2122673.42, 'Plan Rows': 94, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2122662.98, 'Total Cost': 2122671.23, 'Plan Rows': 55, 'Plan Width': 66, 'Workers Planned': 1, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.97, 'Total Cost': 2121665.03, 'Plan Rows': 55, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.97, 'Total Cost': 2121663.11, 'Plan Rows': 55, 'Plan Width': 57, 'Sort Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC""], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 2118635.28, 'Total Cost': 2121661.38, 'Plan Rows': 55, 'Plan Width': 57, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = nation.n_nationkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 2118633.72, 'Total Cost': 2121658.79, 'Plan Rows': 55, 'Plan Width': 31, 'Inner Unique': False, 'Hash Cond': '(supplier.s_suppkey = lineitem.l_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 2118633.22, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1771783.55, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = lineitem.l_orderkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.0, 'Total Cost': 323412.0, 'Plan Rows': 6250000, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1771783.05, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1539063.56, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '((partsupp.ps_suppkey = lineitem.l_suppkey) AND (partsupp.ps_partkey = lineitem.l_partkey))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'partsupp', 'Alias': 'partsupp', 'Startup Cost': 0.0, 'Total Cost': 207719.33, 'Plan Rows': 3333333, 'Plan Width': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1524153.35, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 51799.54, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1374483.88, 'Plan Rows': 24994188, 'Plan Width': 29}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 51378.67, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Filter': ""((p_name)::text ~~ '%green%'::text)""}]}]}]}]}]}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.25, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.0, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 59, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]","[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 335021.86, 'Total Cost': 335032.31, 'Plan Rows': 94, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 335021.86, 'Total Cost': 335030.11, 'Plan Rows': 55, 'Plan Width': 66, 'Workers Planned': 1, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 334021.85, 'Total Cost': 334023.92, 'Plan Rows': 55, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 334021.85, 'Total Cost': 334021.99, 'Plan Rows': 55, 'Plan Width': 57, 'Sort Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC""], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 330994.17, 'Total Cost': 334020.26, 'Plan Rows': 55, 'Plan Width': 57, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = nation.n_nationkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 330992.6, 'Total Cost': 334017.67, 'Plan Rows': 55, 'Plan Width': 31, 'Inner Unique': False, 'Hash Cond': '(supplier.s_suppkey = lineitem.l_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 330992.1, 'Total Cost': 330992.1, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 0.18, 'Total Cost': 330992.1, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 0.12, 'Total Cost': 330987.78, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 0.06, 'Total Cost': 221853.01, 'Plan Rows': 134680, 'Plan Width': 18, 'Inner Unique': False, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Filter': ""((p_name)::text ~~ '%green%'::text)""}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13411>btree_partsupp_ps_partkey', 'Relation Name': 'partsupp', 'Alias': 'partsupp', 'Startup Cost': 0.06, 'Total Cost': 4.88, 'Plan Rows': 18, 'Plan Width': 14, 'Index Cond': '(ps_partkey = part.p_partkey)'}]}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13412>btree_lineitem_l_partkey_l_suppkey', 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.07, 'Total Cost': 0.8, 'Plan Rows': 1, 'Plan Width': 29, 'Index Cond': '((l_partkey = partsupp.ps_partkey) AND (l_suppkey = partsupp.ps_suppkey))'}]}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13413>btree_orders_o_orderkey', 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.06, 'Total Cost': 0.1, 'Plan Rows': 1, 'Plan Width': 8, 'Index Cond': '(o_orderkey = lineitem.l_orderkey)'}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.25, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.0, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 40, 'Options': {'Inlining': False, 'Optimization': False, 'Expressions': True, 'Deforming': True}}}]"
28,"



-- using default substitutions


select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%green%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc","['I(C partsupp.ps_partkey)', 'I(C supplier.s_suppkey,C supplier.s_nationkey)', 'I(C lineitem.l_partkey,C lineitem.l_suppkey)', 'I(C orders.o_orderkey)']",2122683.97,332011.04,24510.436,14183.231,0.4222499406634337,0.8435890388336988,0.42133909817026516,"[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 2122662.98, 'Total Cost': 2122673.42, 'Plan Rows': 94, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2122662.98, 'Total Cost': 2122671.23, 'Plan Rows': 55, 'Plan Width': 66, 'Workers Planned': 1, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.97, 'Total Cost': 2121665.03, 'Plan Rows': 55, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.97, 'Total Cost': 2121663.11, 'Plan Rows': 55, 'Plan Width': 57, 'Sort Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC""], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 2118635.28, 'Total Cost': 2121661.38, 'Plan Rows': 55, 'Plan Width': 57, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = nation.n_nationkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 2118633.72, 'Total Cost': 2121658.79, 'Plan Rows': 55, 'Plan Width': 31, 'Inner Unique': False, 'Hash Cond': '(supplier.s_suppkey = lineitem.l_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 2118633.22, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1771783.55, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = lineitem.l_orderkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.0, 'Total Cost': 323412.0, 'Plan Rows': 6250000, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1771783.05, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1539063.56, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '((partsupp.ps_suppkey = lineitem.l_suppkey) AND (partsupp.ps_partkey = lineitem.l_partkey))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'partsupp', 'Alias': 'partsupp', 'Startup Cost': 0.0, 'Total Cost': 207719.33, 'Plan Rows': 3333333, 'Plan Width': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1524153.35, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 51799.54, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1374483.88, 'Plan Rows': 24994188, 'Plan Width': 29}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 51378.67, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Filter': ""((p_name)::text ~~ '%green%'::text)""}]}]}]}]}]}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.25, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.0, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 59, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]","[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 331998.15, 'Total Cost': 332011.04, 'Plan Rows': 94, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 331998.15, 'Total Cost': 332008.62, 'Plan Rows': 78, 'Plan Width': 66, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 330998.13, 'Total Cost': 330999.59, 'Plan Rows': 39, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 330998.13, 'Total Cost': 330998.23, 'Plan Rows': 39, 'Plan Width': 57, 'Sort Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC""], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 1.79, 'Total Cost': 330997.1, 'Plan Rows': 39, 'Plan Width': 57, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = nation.n_nationkey)', 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 0.23, 'Total Cost': 330994.8, 'Plan Rows': 39, 'Plan Width': 31, 'Inner Unique': False, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 0.17, 'Total Cost': 330990.59, 'Plan Rows': 39, 'Plan Width': 31, 'Inner Unique': False, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 0.12, 'Total Cost': 330987.78, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 0.06, 'Total Cost': 221853.01, 'Plan Rows': 134680, 'Plan Width': 18, 'Inner Unique': False, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Filter': ""((p_name)::text ~~ '%green%'::text)""}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13411>btree_partsupp_ps_partkey', 'Relation Name': 'partsupp', 'Alias': 'partsupp', 'Startup Cost': 0.06, 'Total Cost': 4.88, 'Plan Rows': 18, 'Plan Width': 14, 'Index Cond': '(ps_partkey = part.p_partkey)'}]}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13413>btree_lineitem_l_partkey_l_suppkey', 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.07, 'Total Cost': 0.8, 'Plan Rows': 1, 'Plan Width': 29, 'Index Cond': '((l_partkey = partsupp.ps_partkey) AND (l_suppkey = partsupp.ps_suppkey))'}]}, {'Node Type': 'Index Only Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13412>btree_supplier_s_suppkey_s_nationkey', 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.04, 'Total Cost': 0.06, 'Plan Rows': 1, 'Plan Width': 8, 'Index Cond': '(s_suppkey = lineitem.l_suppkey)'}]}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13414>btree_orders_o_orderkey', 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.06, 'Total Cost': 0.1, 'Plan Rows': 1, 'Plan Width': 8, 'Index Cond': '(o_orderkey = lineitem.l_orderkey)'}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.25, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.0, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 33, 'Options': {'Inlining': False, 'Optimization': False, 'Expressions': True, 'Deforming': True}}}]"
29,"



-- using default substitutions


select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%green%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc","['I(C partsupp.ps_partkey)', 'I(C nation.n_nationkey,C nation.n_name)', 'I(C lineitem.l_partkey,C lineitem.l_suppkey)', 'I(C orders.o_orderkey)']",2122683.97,335032.19,24510.436,18382.359,0.5921466760633387,0.8421657699709298,0.2500190939075911,"[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 2122662.98, 'Total Cost': 2122673.42, 'Plan Rows': 94, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2122662.98, 'Total Cost': 2122671.23, 'Plan Rows': 55, 'Plan Width': 66, 'Workers Planned': 1, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.97, 'Total Cost': 2121665.03, 'Plan Rows': 55, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.97, 'Total Cost': 2121663.11, 'Plan Rows': 55, 'Plan Width': 57, 'Sort Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC""], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 2118635.28, 'Total Cost': 2121661.38, 'Plan Rows': 55, 'Plan Width': 57, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = nation.n_nationkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 2118633.72, 'Total Cost': 2121658.79, 'Plan Rows': 55, 'Plan Width': 31, 'Inner Unique': False, 'Hash Cond': '(supplier.s_suppkey = lineitem.l_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 2118633.22, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1771783.55, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = lineitem.l_orderkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.0, 'Total Cost': 323412.0, 'Plan Rows': 6250000, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1771783.05, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1539063.56, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '((partsupp.ps_suppkey = lineitem.l_suppkey) AND (partsupp.ps_partkey = lineitem.l_partkey))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'partsupp', 'Alias': 'partsupp', 'Startup Cost': 0.0, 'Total Cost': 207719.33, 'Plan Rows': 3333333, 'Plan Width': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1524153.35, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 51799.54, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1374483.88, 'Plan Rows': 24994188, 'Plan Width': 29}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 51378.67, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Filter': ""((p_name)::text ~~ '%green%'::text)""}]}]}]}]}]}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.25, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.0, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 59, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]","[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 335021.75, 'Total Cost': 335032.19, 'Plan Rows': 94, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 335021.75, 'Total Cost': 335030.0, 'Plan Rows': 55, 'Plan Width': 66, 'Workers Planned': 1, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 334021.74, 'Total Cost': 334023.8, 'Plan Rows': 55, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 334021.74, 'Total Cost': 334021.88, 'Plan Rows': 55, 'Plan Width': 57, 'Sort Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC""], 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 330992.62, 'Total Cost': 334020.15, 'Plan Rows': 55, 'Plan Width': 57, 'Inner Unique': False, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 330992.6, 'Total Cost': 334017.67, 'Plan Rows': 55, 'Plan Width': 31, 'Inner Unique': False, 'Hash Cond': '(supplier.s_suppkey = lineitem.l_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 330992.1, 'Total Cost': 330992.1, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 0.18, 'Total Cost': 330992.1, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 0.12, 'Total Cost': 330987.78, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 0.06, 'Total Cost': 221853.01, 'Plan Rows': 134680, 'Plan Width': 18, 'Inner Unique': False, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Filter': ""((p_name)::text ~~ '%green%'::text)""}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13411>btree_partsupp_ps_partkey', 'Relation Name': 'partsupp', 'Alias': 'partsupp', 'Startup Cost': 0.06, 'Total Cost': 4.88, 'Plan Rows': 18, 'Plan Width': 14, 'Index Cond': '(ps_partkey = part.p_partkey)'}]}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13413>btree_lineitem_l_partkey_l_suppkey', 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.07, 'Total Cost': 0.8, 'Plan Rows': 1, 'Plan Width': 29, 'Index Cond': '((l_partkey = partsupp.ps_partkey) AND (l_suppkey = partsupp.ps_suppkey))'}]}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13414>btree_orders_o_orderkey', 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.06, 'Total Cost': 0.1, 'Plan Rows': 1, 'Plan Width': 8, 'Index Cond': '(o_orderkey = lineitem.l_orderkey)'}]}]}]}, {'Node Type': 'Index Only Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13412>btree_nation_n_nationkey_n_name', 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.01, 'Total Cost': 0.03, 'Plan Rows': 1, 'Plan Width': 30, 'Index Cond': '(n_nationkey = supplier.s_nationkey)'}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 34, 'Options': {'Inlining': False, 'Optimization': False, 'Expressions': True, 'Deforming': True}}}]"
30,"



-- using default substitutions


select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%green%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc","['I(C supplier.s_suppkey,C supplier.s_nationkey)', 'I(C nation.n_nationkey,C nation.n_name)', 'I(C orders.o_orderkey)', 'I(C partsupp.ps_partkey)', 'I(C lineitem.l_partkey,C lineitem.l_suppkey)']",2122683.97,332010.51,24510.436,14545.695,0.4370383401786896,0.8435892885175932,0.40655094833890354,"[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 2122662.98, 'Total Cost': 2122673.42, 'Plan Rows': 94, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2122662.98, 'Total Cost': 2122671.23, 'Plan Rows': 55, 'Plan Width': 66, 'Workers Planned': 1, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.97, 'Total Cost': 2121665.03, 'Plan Rows': 55, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.97, 'Total Cost': 2121663.11, 'Plan Rows': 55, 'Plan Width': 57, 'Sort Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC""], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 2118635.28, 'Total Cost': 2121661.38, 'Plan Rows': 55, 'Plan Width': 57, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = nation.n_nationkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 2118633.72, 'Total Cost': 2121658.79, 'Plan Rows': 55, 'Plan Width': 31, 'Inner Unique': False, 'Hash Cond': '(supplier.s_suppkey = lineitem.l_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 2118633.22, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1771783.55, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = lineitem.l_orderkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.0, 'Total Cost': 323412.0, 'Plan Rows': 6250000, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1771783.05, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1539063.56, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '((partsupp.ps_suppkey = lineitem.l_suppkey) AND (partsupp.ps_partkey = lineitem.l_partkey))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'partsupp', 'Alias': 'partsupp', 'Startup Cost': 0.0, 'Total Cost': 207719.33, 'Plan Rows': 3333333, 'Plan Width': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1524153.35, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 51799.54, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1374483.88, 'Plan Rows': 24994188, 'Plan Width': 29}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 51378.67, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Filter': ""((p_name)::text ~~ '%green%'::text)""}]}]}]}]}]}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.25, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.0, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 59, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]","[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 331997.62, 'Total Cost': 332010.51, 'Plan Rows': 94, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 331997.62, 'Total Cost': 332008.08, 'Plan Rows': 78, 'Plan Width': 66, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 330997.59, 'Total Cost': 330999.06, 'Plan Rows': 39, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 330997.59, 'Total Cost': 330997.69, 'Plan Rows': 39, 'Plan Width': 57, 'Sort Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC""], 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 0.24, 'Total Cost': 330996.56, 'Plan Rows': 39, 'Plan Width': 57, 'Inner Unique': False, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 0.23, 'Total Cost': 330994.8, 'Plan Rows': 39, 'Plan Width': 31, 'Inner Unique': False, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 0.17, 'Total Cost': 330990.59, 'Plan Rows': 39, 'Plan Width': 31, 'Inner Unique': False, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 0.12, 'Total Cost': 330987.78, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 0.06, 'Total Cost': 221853.01, 'Plan Rows': 134680, 'Plan Width': 18, 'Inner Unique': False, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Filter': ""((p_name)::text ~~ '%green%'::text)""}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13414>btree_partsupp_ps_partkey', 'Relation Name': 'partsupp', 'Alias': 'partsupp', 'Startup Cost': 0.06, 'Total Cost': 4.88, 'Plan Rows': 18, 'Plan Width': 14, 'Index Cond': '(ps_partkey = part.p_partkey)'}]}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13415>btree_lineitem_l_partkey_l_suppkey', 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.07, 'Total Cost': 0.8, 'Plan Rows': 1, 'Plan Width': 29, 'Index Cond': '((l_partkey = partsupp.ps_partkey) AND (l_suppkey = partsupp.ps_suppkey))'}]}, {'Node Type': 'Index Only Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13411>btree_supplier_s_suppkey_s_nationkey', 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.04, 'Total Cost': 0.06, 'Plan Rows': 1, 'Plan Width': 8, 'Index Cond': '(s_suppkey = lineitem.l_suppkey)'}]}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13413>btree_orders_o_orderkey', 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.06, 'Total Cost': 0.1, 'Plan Rows': 1, 'Plan Width': 8, 'Index Cond': '(o_orderkey = lineitem.l_orderkey)'}]}, {'Node Type': 'Index Only Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13412>btree_nation_n_nationkey_n_name', 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.01, 'Total Cost': 0.03, 'Plan Rows': 1, 'Plan Width': 30, 'Index Cond': '(n_nationkey = supplier.s_nationkey)'}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 27, 'Options': {'Inlining': False, 'Optimization': False, 'Expressions': True, 'Deforming': True}}}]"
31,"



-- using default substitutions


select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%green%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc","['I(C lineitem.l_partkey,C lineitem.l_suppkey)']",2122683.97,732605.19,24510.436,15810.203,0.2999081064235055,0.6548684588219696,0.35496035239846413,"[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 2122662.98, 'Total Cost': 2122673.42, 'Plan Rows': 94, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2122662.98, 'Total Cost': 2122671.23, 'Plan Rows': 55, 'Plan Width': 66, 'Workers Planned': 1, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.97, 'Total Cost': 2121665.03, 'Plan Rows': 55, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.97, 'Total Cost': 2121663.11, 'Plan Rows': 55, 'Plan Width': 57, 'Sort Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC""], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 2118635.28, 'Total Cost': 2121661.38, 'Plan Rows': 55, 'Plan Width': 57, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = nation.n_nationkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 2118633.72, 'Total Cost': 2121658.79, 'Plan Rows': 55, 'Plan Width': 31, 'Inner Unique': False, 'Hash Cond': '(supplier.s_suppkey = lineitem.l_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 2118633.22, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1771783.55, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = lineitem.l_orderkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.0, 'Total Cost': 323412.0, 'Plan Rows': 6250000, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1771783.05, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1539063.56, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '((partsupp.ps_suppkey = lineitem.l_suppkey) AND (partsupp.ps_partkey = lineitem.l_partkey))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'partsupp', 'Alias': 'partsupp', 'Startup Cost': 0.0, 'Total Cost': 207719.33, 'Plan Rows': 3333333, 'Plan Width': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1524153.35, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 51799.54, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1374483.88, 'Plan Rows': 24994188, 'Plan Width': 29}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 51378.67, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Filter': ""((p_name)::text ~~ '%green%'::text)""}]}]}]}]}]}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.25, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.0, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 59, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]","[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 732594.75, 'Total Cost': 732605.19, 'Plan Rows': 94, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 732594.75, 'Total Cost': 732603.0, 'Plan Rows': 55, 'Plan Width': 66, 'Workers Planned': 1, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 731594.74, 'Total Cost': 731596.8, 'Plan Rows': 55, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 731594.74, 'Total Cost': 731594.87, 'Plan Rows': 55, 'Plan Width': 57, 'Sort Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC""], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 728567.05, 'Total Cost': 731593.15, 'Plan Rows': 55, 'Plan Width': 57, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = nation.n_nationkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 728565.49, 'Total Cost': 731590.55, 'Plan Rows': 55, 'Plan Width': 31, 'Inner Unique': False, 'Hash Cond': '(supplier.s_suppkey = lineitem.l_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 728564.99, 'Total Cost': 728564.99, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 381715.32, 'Total Cost': 728564.99, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = lineitem.l_orderkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.0, 'Total Cost': 323412.0, 'Plan Rows': 6250000, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 381714.82, 'Total Cost': 381714.82, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 51799.61, 'Total Cost': 381714.82, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 51799.54, 'Total Cost': 272580.04, 'Plan Rows': 134680, 'Plan Width': 18, 'Inner Unique': False, 'Hash Cond': '(partsupp.ps_partkey = part.p_partkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'partsupp', 'Alias': 'partsupp', 'Startup Cost': 0.0, 'Total Cost': 207719.33, 'Plan Rows': 3333333, 'Plan Width': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 51378.67, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Filter': ""((p_name)::text ~~ '%green%'::text)""}]}]}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13411>btree_lineitem_l_partkey_l_suppkey', 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.07, 'Total Cost': 0.8, 'Plan Rows': 1, 'Plan Width': 29, 'Index Cond': '((l_partkey = partsupp.ps_partkey) AND (l_suppkey = partsupp.ps_suppkey))'}]}]}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.25, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.0, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 51, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]"
32,"



-- using default substitutions


select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%green%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc","['I(C lineitem.l_partkey,C lineitem.l_suppkey)', 'I(C supplier.s_suppkey,C supplier.s_nationkey)']",2122683.97,729584.01,24510.436,12916.354,0.1832653949996421,0.6562917418177894,0.47302634681814726,"[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 2122662.98, 'Total Cost': 2122673.42, 'Plan Rows': 94, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2122662.98, 'Total Cost': 2122671.23, 'Plan Rows': 55, 'Plan Width': 66, 'Workers Planned': 1, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.97, 'Total Cost': 2121665.03, 'Plan Rows': 55, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.97, 'Total Cost': 2121663.11, 'Plan Rows': 55, 'Plan Width': 57, 'Sort Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC""], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 2118635.28, 'Total Cost': 2121661.38, 'Plan Rows': 55, 'Plan Width': 57, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = nation.n_nationkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 2118633.72, 'Total Cost': 2121658.79, 'Plan Rows': 55, 'Plan Width': 31, 'Inner Unique': False, 'Hash Cond': '(supplier.s_suppkey = lineitem.l_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 2118633.22, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1771783.55, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = lineitem.l_orderkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.0, 'Total Cost': 323412.0, 'Plan Rows': 6250000, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1771783.05, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1539063.56, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '((partsupp.ps_suppkey = lineitem.l_suppkey) AND (partsupp.ps_partkey = lineitem.l_partkey))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'partsupp', 'Alias': 'partsupp', 'Startup Cost': 0.0, 'Total Cost': 207719.33, 'Plan Rows': 3333333, 'Plan Width': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1524153.35, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 51799.54, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1374483.88, 'Plan Rows': 24994188, 'Plan Width': 29}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 51378.67, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Filter': ""((p_name)::text ~~ '%green%'::text)""}]}]}]}]}]}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.25, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.0, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 59, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]","[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 729571.12, 'Total Cost': 729584.01, 'Plan Rows': 94, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 729571.12, 'Total Cost': 729581.59, 'Plan Rows': 78, 'Plan Width': 66, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 728571.1, 'Total Cost': 728572.56, 'Plan Rows': 39, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 728571.1, 'Total Cost': 728571.19, 'Plan Rows': 39, 'Plan Width': 57, 'Sort Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC""], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 381719.67, 'Total Cost': 728570.07, 'Plan Rows': 39, 'Plan Width': 57, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = nation.n_nationkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 381718.11, 'Total Cost': 728567.77, 'Plan Rows': 39, 'Plan Width': 31, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = lineitem.l_orderkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.0, 'Total Cost': 323412.0, 'Plan Rows': 6250000, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 381717.62, 'Total Cost': 381717.62, 'Plan Rows': 39, 'Plan Width': 31, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 51799.65, 'Total Cost': 381717.62, 'Plan Rows': 39, 'Plan Width': 31, 'Inner Unique': False, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 51799.61, 'Total Cost': 381714.82, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 51799.54, 'Total Cost': 272580.04, 'Plan Rows': 134680, 'Plan Width': 18, 'Inner Unique': False, 'Hash Cond': '(partsupp.ps_partkey = part.p_partkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'partsupp', 'Alias': 'partsupp', 'Startup Cost': 0.0, 'Total Cost': 207719.33, 'Plan Rows': 3333333, 'Plan Width': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 51378.67, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Filter': ""((p_name)::text ~~ '%green%'::text)""}]}]}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13411>btree_lineitem_l_partkey_l_suppkey', 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.07, 'Total Cost': 0.8, 'Plan Rows': 1, 'Plan Width': 29, 'Index Cond': '((l_partkey = partsupp.ps_partkey) AND (l_suppkey = partsupp.ps_suppkey))'}]}, {'Node Type': 'Index Only Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13412>btree_supplier_s_suppkey_s_nationkey', 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.04, 'Total Cost': 0.06, 'Plan Rows': 1, 'Plan Width': 8, 'Index Cond': '(s_suppkey = lineitem.l_suppkey)'}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.25, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.0, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 44, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]"
33,"



-- using default substitutions


select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%green%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc","['I(C lineitem.l_partkey,C lineitem.l_suppkey)', 'I(C nation.n_nationkey,C nation.n_name)']",2122683.97,732605.08,24510.436,16033.352,0.3090124026571528,0.6548685106431552,0.34585610798600236,"[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 2122662.98, 'Total Cost': 2122673.42, 'Plan Rows': 94, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2122662.98, 'Total Cost': 2122671.23, 'Plan Rows': 55, 'Plan Width': 66, 'Workers Planned': 1, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.97, 'Total Cost': 2121665.03, 'Plan Rows': 55, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.97, 'Total Cost': 2121663.11, 'Plan Rows': 55, 'Plan Width': 57, 'Sort Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC""], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 2118635.28, 'Total Cost': 2121661.38, 'Plan Rows': 55, 'Plan Width': 57, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = nation.n_nationkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 2118633.72, 'Total Cost': 2121658.79, 'Plan Rows': 55, 'Plan Width': 31, 'Inner Unique': False, 'Hash Cond': '(supplier.s_suppkey = lineitem.l_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 2118633.22, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1771783.55, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = lineitem.l_orderkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.0, 'Total Cost': 323412.0, 'Plan Rows': 6250000, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1771783.05, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1539063.56, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '((partsupp.ps_suppkey = lineitem.l_suppkey) AND (partsupp.ps_partkey = lineitem.l_partkey))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'partsupp', 'Alias': 'partsupp', 'Startup Cost': 0.0, 'Total Cost': 207719.33, 'Plan Rows': 3333333, 'Plan Width': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1524153.35, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 51799.54, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1374483.88, 'Plan Rows': 24994188, 'Plan Width': 29}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 51378.67, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Filter': ""((p_name)::text ~~ '%green%'::text)""}]}]}]}]}]}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.25, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.0, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 59, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]","[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 732594.63, 'Total Cost': 732605.08, 'Plan Rows': 94, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 732594.63, 'Total Cost': 732602.88, 'Plan Rows': 55, 'Plan Width': 66, 'Workers Planned': 1, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 731594.62, 'Total Cost': 731596.68, 'Plan Rows': 55, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 731594.62, 'Total Cost': 731594.76, 'Plan Rows': 55, 'Plan Width': 57, 'Sort Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC""], 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 728565.5, 'Total Cost': 731593.03, 'Plan Rows': 55, 'Plan Width': 57, 'Inner Unique': False, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 728565.49, 'Total Cost': 731590.55, 'Plan Rows': 55, 'Plan Width': 31, 'Inner Unique': False, 'Hash Cond': '(supplier.s_suppkey = lineitem.l_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 728564.99, 'Total Cost': 728564.99, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 381715.32, 'Total Cost': 728564.99, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = lineitem.l_orderkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.0, 'Total Cost': 323412.0, 'Plan Rows': 6250000, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 381714.82, 'Total Cost': 381714.82, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 51799.61, 'Total Cost': 381714.82, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 51799.54, 'Total Cost': 272580.04, 'Plan Rows': 134680, 'Plan Width': 18, 'Inner Unique': False, 'Hash Cond': '(partsupp.ps_partkey = part.p_partkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'partsupp', 'Alias': 'partsupp', 'Startup Cost': 0.0, 'Total Cost': 207719.33, 'Plan Rows': 3333333, 'Plan Width': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 51378.67, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Filter': ""((p_name)::text ~~ '%green%'::text)""}]}]}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13411>btree_lineitem_l_partkey_l_suppkey', 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.07, 'Total Cost': 0.8, 'Plan Rows': 1, 'Plan Width': 29, 'Index Cond': '((l_partkey = partsupp.ps_partkey) AND (l_suppkey = partsupp.ps_suppkey))'}]}]}]}]}]}, {'Node Type': 'Index Only Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13412>btree_nation_n_nationkey_n_name', 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.01, 'Total Cost': 0.03, 'Plan Rows': 1, 'Plan Width': 30, 'Index Cond': '(n_nationkey = supplier.s_nationkey)'}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 45, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]"
34,"



-- using default substitutions


select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%green%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc","['I(C lineitem.l_partkey,C lineitem.l_suppkey)', 'I(C orders.o_orderkey)']",2122683.97,385759.34,24510.436,19262.373,0.6041526753914239,0.8182681240109426,0.2141154486195187,"[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 2122662.98, 'Total Cost': 2122673.42, 'Plan Rows': 94, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2122662.98, 'Total Cost': 2122671.23, 'Plan Rows': 55, 'Plan Width': 66, 'Workers Planned': 1, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.97, 'Total Cost': 2121665.03, 'Plan Rows': 55, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.97, 'Total Cost': 2121663.11, 'Plan Rows': 55, 'Plan Width': 57, 'Sort Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC""], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 2118635.28, 'Total Cost': 2121661.38, 'Plan Rows': 55, 'Plan Width': 57, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = nation.n_nationkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 2118633.72, 'Total Cost': 2121658.79, 'Plan Rows': 55, 'Plan Width': 31, 'Inner Unique': False, 'Hash Cond': '(supplier.s_suppkey = lineitem.l_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 2118633.22, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1771783.55, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = lineitem.l_orderkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.0, 'Total Cost': 323412.0, 'Plan Rows': 6250000, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1771783.05, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1539063.56, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '((partsupp.ps_suppkey = lineitem.l_suppkey) AND (partsupp.ps_partkey = lineitem.l_partkey))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'partsupp', 'Alias': 'partsupp', 'Startup Cost': 0.0, 'Total Cost': 207719.33, 'Plan Rows': 3333333, 'Plan Width': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1524153.35, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 51799.54, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1374483.88, 'Plan Rows': 24994188, 'Plan Width': 29}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 51378.67, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Filter': ""((p_name)::text ~~ '%green%'::text)""}]}]}]}]}]}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.25, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.0, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 59, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]","[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 385748.9, 'Total Cost': 385759.34, 'Plan Rows': 94, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 385748.9, 'Total Cost': 385757.15, 'Plan Rows': 55, 'Plan Width': 66, 'Workers Planned': 1, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 384748.89, 'Total Cost': 384750.95, 'Plan Rows': 55, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 384748.89, 'Total Cost': 384749.03, 'Plan Rows': 55, 'Plan Width': 57, 'Sort Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC""], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 381721.2, 'Total Cost': 384747.3, 'Plan Rows': 55, 'Plan Width': 57, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = nation.n_nationkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 381719.64, 'Total Cost': 384744.71, 'Plan Rows': 55, 'Plan Width': 31, 'Inner Unique': False, 'Hash Cond': '(supplier.s_suppkey = lineitem.l_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 381719.14, 'Total Cost': 381719.14, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 51799.67, 'Total Cost': 381719.14, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 51799.61, 'Total Cost': 381714.82, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 51799.54, 'Total Cost': 272580.04, 'Plan Rows': 134680, 'Plan Width': 18, 'Inner Unique': False, 'Hash Cond': '(partsupp.ps_partkey = part.p_partkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'partsupp', 'Alias': 'partsupp', 'Startup Cost': 0.0, 'Total Cost': 207719.33, 'Plan Rows': 3333333, 'Plan Width': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 51378.67, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Filter': ""((p_name)::text ~~ '%green%'::text)""}]}]}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13411>btree_lineitem_l_partkey_l_suppkey', 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.07, 'Total Cost': 0.8, 'Plan Rows': 1, 'Plan Width': 29, 'Index Cond': '((l_partkey = partsupp.ps_partkey) AND (l_suppkey = partsupp.ps_suppkey))'}]}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13412>btree_orders_o_orderkey', 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.06, 'Total Cost': 0.1, 'Plan Rows': 1, 'Plan Width': 8, 'Index Cond': '(o_orderkey = lineitem.l_orderkey)'}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.25, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.0, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 46, 'Options': {'Inlining': False, 'Optimization': False, 'Expressions': True, 'Deforming': True}}}]"
35,"



-- using default substitutions


select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%green%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc","['I(C lineitem.l_partkey,C lineitem.l_suppkey)', 'I(C supplier.s_suppkey,C supplier.s_nationkey)', 'I(C orders.o_orderkey)']",2122683.97,382738.08,24510.436,15017.763,0.4324003740668595,0.8196914446948973,0.3872910706280378,"[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 2122662.98, 'Total Cost': 2122673.42, 'Plan Rows': 94, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2122662.98, 'Total Cost': 2122671.23, 'Plan Rows': 55, 'Plan Width': 66, 'Workers Planned': 1, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.97, 'Total Cost': 2121665.03, 'Plan Rows': 55, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.97, 'Total Cost': 2121663.11, 'Plan Rows': 55, 'Plan Width': 57, 'Sort Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC""], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 2118635.28, 'Total Cost': 2121661.38, 'Plan Rows': 55, 'Plan Width': 57, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = nation.n_nationkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 2118633.72, 'Total Cost': 2121658.79, 'Plan Rows': 55, 'Plan Width': 31, 'Inner Unique': False, 'Hash Cond': '(supplier.s_suppkey = lineitem.l_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 2118633.22, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1771783.55, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = lineitem.l_orderkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.0, 'Total Cost': 323412.0, 'Plan Rows': 6250000, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1771783.05, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1539063.56, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '((partsupp.ps_suppkey = lineitem.l_suppkey) AND (partsupp.ps_partkey = lineitem.l_partkey))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'partsupp', 'Alias': 'partsupp', 'Startup Cost': 0.0, 'Total Cost': 207719.33, 'Plan Rows': 3333333, 'Plan Width': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1524153.35, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 51799.54, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1374483.88, 'Plan Rows': 24994188, 'Plan Width': 29}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 51378.67, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Filter': ""((p_name)::text ~~ '%green%'::text)""}]}]}]}]}]}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.25, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.0, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 59, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]","[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 382725.19, 'Total Cost': 382738.08, 'Plan Rows': 94, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 382725.19, 'Total Cost': 382735.65, 'Plan Rows': 78, 'Plan Width': 66, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 381725.16, 'Total Cost': 381726.63, 'Plan Rows': 39, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 381725.16, 'Total Cost': 381725.26, 'Plan Rows': 39, 'Plan Width': 57, 'Sort Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC""], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 51801.27, 'Total Cost': 381724.13, 'Plan Rows': 39, 'Plan Width': 57, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = nation.n_nationkey)', 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 51799.71, 'Total Cost': 381721.84, 'Plan Rows': 39, 'Plan Width': 31, 'Inner Unique': False, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 51799.65, 'Total Cost': 381717.62, 'Plan Rows': 39, 'Plan Width': 31, 'Inner Unique': False, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 51799.61, 'Total Cost': 381714.82, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 51799.54, 'Total Cost': 272580.04, 'Plan Rows': 134680, 'Plan Width': 18, 'Inner Unique': False, 'Hash Cond': '(partsupp.ps_partkey = part.p_partkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'partsupp', 'Alias': 'partsupp', 'Startup Cost': 0.0, 'Total Cost': 207719.33, 'Plan Rows': 3333333, 'Plan Width': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 51378.67, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Filter': ""((p_name)::text ~~ '%green%'::text)""}]}]}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13411>btree_lineitem_l_partkey_l_suppkey', 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.07, 'Total Cost': 0.8, 'Plan Rows': 1, 'Plan Width': 29, 'Index Cond': '((l_partkey = partsupp.ps_partkey) AND (l_suppkey = partsupp.ps_suppkey))'}]}, {'Node Type': 'Index Only Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13412>btree_supplier_s_suppkey_s_nationkey', 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.04, 'Total Cost': 0.06, 'Plan Rows': 1, 'Plan Width': 8, 'Index Cond': '(s_suppkey = lineitem.l_suppkey)'}]}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13413>btree_orders_o_orderkey', 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.06, 'Total Cost': 0.1, 'Plan Rows': 1, 'Plan Width': 8, 'Index Cond': '(o_orderkey = lineitem.l_orderkey)'}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.25, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.0, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 39, 'Options': {'Inlining': False, 'Optimization': False, 'Expressions': True, 'Deforming': True}}}]"
36,"



-- using default substitutions


select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%green%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc","['I(C lineitem.l_partkey,C lineitem.l_suppkey)', 'I(C nation.n_nationkey,C nation.n_name)', 'I(C orders.o_orderkey)']",2122683.97,385759.23,24510.436,19302.364,0.6057843179358429,0.8182681758321283,0.2124838578962855,"[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 2122662.98, 'Total Cost': 2122673.42, 'Plan Rows': 94, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2122662.98, 'Total Cost': 2122671.23, 'Plan Rows': 55, 'Plan Width': 66, 'Workers Planned': 1, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.97, 'Total Cost': 2121665.03, 'Plan Rows': 55, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.97, 'Total Cost': 2121663.11, 'Plan Rows': 55, 'Plan Width': 57, 'Sort Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC""], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 2118635.28, 'Total Cost': 2121661.38, 'Plan Rows': 55, 'Plan Width': 57, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = nation.n_nationkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 2118633.72, 'Total Cost': 2121658.79, 'Plan Rows': 55, 'Plan Width': 31, 'Inner Unique': False, 'Hash Cond': '(supplier.s_suppkey = lineitem.l_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 2118633.22, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1771783.55, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = lineitem.l_orderkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.0, 'Total Cost': 323412.0, 'Plan Rows': 6250000, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1771783.05, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1539063.56, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '((partsupp.ps_suppkey = lineitem.l_suppkey) AND (partsupp.ps_partkey = lineitem.l_partkey))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'partsupp', 'Alias': 'partsupp', 'Startup Cost': 0.0, 'Total Cost': 207719.33, 'Plan Rows': 3333333, 'Plan Width': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1524153.35, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 51799.54, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1374483.88, 'Plan Rows': 24994188, 'Plan Width': 29}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 51378.67, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Filter': ""((p_name)::text ~~ '%green%'::text)""}]}]}]}]}]}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.25, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.0, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 59, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]","[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 385748.78, 'Total Cost': 385759.23, 'Plan Rows': 94, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 385748.78, 'Total Cost': 385757.03, 'Plan Rows': 55, 'Plan Width': 66, 'Workers Planned': 1, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 384748.77, 'Total Cost': 384750.84, 'Plan Rows': 55, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 384748.77, 'Total Cost': 384748.91, 'Plan Rows': 55, 'Plan Width': 57, 'Sort Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC""], 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 381719.65, 'Total Cost': 384747.18, 'Plan Rows': 55, 'Plan Width': 57, 'Inner Unique': False, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 381719.64, 'Total Cost': 384744.71, 'Plan Rows': 55, 'Plan Width': 31, 'Inner Unique': False, 'Hash Cond': '(supplier.s_suppkey = lineitem.l_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 381719.14, 'Total Cost': 381719.14, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 51799.67, 'Total Cost': 381719.14, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 51799.61, 'Total Cost': 381714.82, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 51799.54, 'Total Cost': 272580.04, 'Plan Rows': 134680, 'Plan Width': 18, 'Inner Unique': False, 'Hash Cond': '(partsupp.ps_partkey = part.p_partkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'partsupp', 'Alias': 'partsupp', 'Startup Cost': 0.0, 'Total Cost': 207719.33, 'Plan Rows': 3333333, 'Plan Width': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 51378.67, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Filter': ""((p_name)::text ~~ '%green%'::text)""}]}]}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13411>btree_lineitem_l_partkey_l_suppkey', 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.07, 'Total Cost': 0.8, 'Plan Rows': 1, 'Plan Width': 29, 'Index Cond': '((l_partkey = partsupp.ps_partkey) AND (l_suppkey = partsupp.ps_suppkey))'}]}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13413>btree_orders_o_orderkey', 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.06, 'Total Cost': 0.1, 'Plan Rows': 1, 'Plan Width': 8, 'Index Cond': '(o_orderkey = lineitem.l_orderkey)'}]}]}]}, {'Node Type': 'Index Only Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13412>btree_nation_n_nationkey_n_name', 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.01, 'Total Cost': 0.03, 'Plan Rows': 1, 'Plan Width': 30, 'Index Cond': '(n_nationkey = supplier.s_nationkey)'}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 40, 'Options': {'Inlining': False, 'Optimization': False, 'Expressions': True, 'Deforming': True}}}]"
37,"



-- using default substitutions


select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%green%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc","['I(C lineitem.l_partkey,C lineitem.l_suppkey)', 'I(C nation.n_nationkey,C nation.n_name)', 'I(C supplier.s_suppkey,C supplier.s_nationkey)', 'I(C orders.o_orderkey)']",2122683.97,382737.54,24510.436,14763.414,0.4220234568765732,0.8196916990898084,0.3976682422132352,"[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 2122662.98, 'Total Cost': 2122673.42, 'Plan Rows': 94, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2122662.98, 'Total Cost': 2122671.23, 'Plan Rows': 55, 'Plan Width': 66, 'Workers Planned': 1, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.97, 'Total Cost': 2121665.03, 'Plan Rows': 55, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.97, 'Total Cost': 2121663.11, 'Plan Rows': 55, 'Plan Width': 57, 'Sort Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC""], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 2118635.28, 'Total Cost': 2121661.38, 'Plan Rows': 55, 'Plan Width': 57, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = nation.n_nationkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 2118633.72, 'Total Cost': 2121658.79, 'Plan Rows': 55, 'Plan Width': 31, 'Inner Unique': False, 'Hash Cond': '(supplier.s_suppkey = lineitem.l_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 2118633.22, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1771783.55, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = lineitem.l_orderkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.0, 'Total Cost': 323412.0, 'Plan Rows': 6250000, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1771783.05, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1539063.56, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '((partsupp.ps_suppkey = lineitem.l_suppkey) AND (partsupp.ps_partkey = lineitem.l_partkey))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'partsupp', 'Alias': 'partsupp', 'Startup Cost': 0.0, 'Total Cost': 207719.33, 'Plan Rows': 3333333, 'Plan Width': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1524153.35, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 51799.54, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1374483.88, 'Plan Rows': 24994188, 'Plan Width': 29}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 51378.67, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Filter': ""((p_name)::text ~~ '%green%'::text)""}]}]}]}]}]}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.25, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.0, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 59, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]","[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 382724.65, 'Total Cost': 382737.54, 'Plan Rows': 94, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 382724.65, 'Total Cost': 382735.12, 'Plan Rows': 78, 'Plan Width': 66, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 381724.63, 'Total Cost': 381726.09, 'Plan Rows': 39, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 381724.63, 'Total Cost': 381724.73, 'Plan Rows': 39, 'Plan Width': 57, 'Sort Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC""], 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 51799.72, 'Total Cost': 381723.6, 'Plan Rows': 39, 'Plan Width': 57, 'Inner Unique': False, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 51799.71, 'Total Cost': 381721.84, 'Plan Rows': 39, 'Plan Width': 31, 'Inner Unique': False, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 51799.65, 'Total Cost': 381717.62, 'Plan Rows': 39, 'Plan Width': 31, 'Inner Unique': False, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 51799.61, 'Total Cost': 381714.82, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 51799.54, 'Total Cost': 272580.04, 'Plan Rows': 134680, 'Plan Width': 18, 'Inner Unique': False, 'Hash Cond': '(partsupp.ps_partkey = part.p_partkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'partsupp', 'Alias': 'partsupp', 'Startup Cost': 0.0, 'Total Cost': 207719.33, 'Plan Rows': 3333333, 'Plan Width': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 51378.67, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Filter': ""((p_name)::text ~~ '%green%'::text)""}]}]}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13411>btree_lineitem_l_partkey_l_suppkey', 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.07, 'Total Cost': 0.8, 'Plan Rows': 1, 'Plan Width': 29, 'Index Cond': '((l_partkey = partsupp.ps_partkey) AND (l_suppkey = partsupp.ps_suppkey))'}]}, {'Node Type': 'Index Only Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13413>btree_supplier_s_suppkey_s_nationkey', 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.04, 'Total Cost': 0.06, 'Plan Rows': 1, 'Plan Width': 8, 'Index Cond': '(s_suppkey = lineitem.l_suppkey)'}]}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13414>btree_orders_o_orderkey', 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.06, 'Total Cost': 0.1, 'Plan Rows': 1, 'Plan Width': 8, 'Index Cond': '(o_orderkey = lineitem.l_orderkey)'}]}, {'Node Type': 'Index Only Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13412>btree_nation_n_nationkey_n_name', 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.01, 'Total Cost': 0.03, 'Plan Rows': 1, 'Plan Width': 30, 'Index Cond': '(n_nationkey = supplier.s_nationkey)'}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 33, 'Options': {'Inlining': False, 'Optimization': False, 'Expressions': True, 'Deforming': True}}}]"
38,"



-- using default substitutions


select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%green%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc","['I(C supplier.s_suppkey,C supplier.s_nationkey)']",2122683.97,2119652.24,24510.436,18560.074,-0.2413402557728566,0.0014282531186213185,0.2427685088914779,"[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 2122662.98, 'Total Cost': 2122673.42, 'Plan Rows': 94, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2122662.98, 'Total Cost': 2122671.23, 'Plan Rows': 55, 'Plan Width': 66, 'Workers Planned': 1, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.97, 'Total Cost': 2121665.03, 'Plan Rows': 55, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.97, 'Total Cost': 2121663.11, 'Plan Rows': 55, 'Plan Width': 57, 'Sort Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC""], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 2118635.28, 'Total Cost': 2121661.38, 'Plan Rows': 55, 'Plan Width': 57, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = nation.n_nationkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 2118633.72, 'Total Cost': 2121658.79, 'Plan Rows': 55, 'Plan Width': 31, 'Inner Unique': False, 'Hash Cond': '(supplier.s_suppkey = lineitem.l_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 2118633.22, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1771783.55, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = lineitem.l_orderkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.0, 'Total Cost': 323412.0, 'Plan Rows': 6250000, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1771783.05, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1539063.56, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '((partsupp.ps_suppkey = lineitem.l_suppkey) AND (partsupp.ps_partkey = lineitem.l_partkey))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'partsupp', 'Alias': 'partsupp', 'Startup Cost': 0.0, 'Total Cost': 207719.33, 'Plan Rows': 3333333, 'Plan Width': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1524153.35, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 51799.54, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1374483.88, 'Plan Rows': 24994188, 'Plan Width': 29}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 51378.67, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Filter': ""((p_name)::text ~~ '%green%'::text)""}]}]}]}]}]}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.25, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.0, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 59, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]","[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 2119639.35, 'Total Cost': 2119652.24, 'Plan Rows': 94, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2119639.35, 'Total Cost': 2119649.82, 'Plan Rows': 78, 'Plan Width': 66, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2118639.33, 'Total Cost': 2118640.79, 'Plan Rows': 39, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2118639.33, 'Total Cost': 2118639.43, 'Plan Rows': 39, 'Plan Width': 57, 'Sort Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC""], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 1771787.91, 'Total Cost': 2118638.3, 'Plan Rows': 39, 'Plan Width': 57, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = nation.n_nationkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1771786.35, 'Total Cost': 2118636.01, 'Plan Rows': 39, 'Plan Width': 31, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = lineitem.l_orderkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.0, 'Total Cost': 323412.0, 'Plan Rows': 6250000, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1771785.86, 'Total Cost': 1771785.86, 'Plan Rows': 39, 'Plan Width': 31, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 1539063.6, 'Total Cost': 1771785.86, 'Plan Rows': 39, 'Plan Width': 31, 'Inner Unique': False, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1539063.56, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '((partsupp.ps_suppkey = lineitem.l_suppkey) AND (partsupp.ps_partkey = lineitem.l_partkey))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'partsupp', 'Alias': 'partsupp', 'Startup Cost': 0.0, 'Total Cost': 207719.33, 'Plan Rows': 3333333, 'Plan Width': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1524153.35, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 51799.54, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1374483.88, 'Plan Rows': 24994188, 'Plan Width': 29}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 51378.67, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Filter': ""((p_name)::text ~~ '%green%'::text)""}]}]}]}]}, {'Node Type': 'Index Only Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13411>btree_supplier_s_suppkey_s_nationkey', 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.04, 'Total Cost': 0.06, 'Plan Rows': 1, 'Plan Width': 8, 'Index Cond': '(s_suppkey = lineitem.l_suppkey)'}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.25, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.0, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 52, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]"
39,"



-- using default substitutions


select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%green%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc","['I(C nation.n_nationkey,C nation.n_name)', 'I(C supplier.s_suppkey,C supplier.s_nationkey)']",2122683.97,2119651.71,24510.436,18634.665,-0.2382967717703233,0.0014285028025157423,0.2397252745728391,"[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 2122662.98, 'Total Cost': 2122673.42, 'Plan Rows': 94, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2122662.98, 'Total Cost': 2122671.23, 'Plan Rows': 55, 'Plan Width': 66, 'Workers Planned': 1, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.97, 'Total Cost': 2121665.03, 'Plan Rows': 55, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.97, 'Total Cost': 2121663.11, 'Plan Rows': 55, 'Plan Width': 57, 'Sort Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC""], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 2118635.28, 'Total Cost': 2121661.38, 'Plan Rows': 55, 'Plan Width': 57, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = nation.n_nationkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 2118633.72, 'Total Cost': 2121658.79, 'Plan Rows': 55, 'Plan Width': 31, 'Inner Unique': False, 'Hash Cond': '(supplier.s_suppkey = lineitem.l_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 2118633.22, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1771783.55, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = lineitem.l_orderkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.0, 'Total Cost': 323412.0, 'Plan Rows': 6250000, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1771783.05, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1539063.56, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '((partsupp.ps_suppkey = lineitem.l_suppkey) AND (partsupp.ps_partkey = lineitem.l_partkey))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'partsupp', 'Alias': 'partsupp', 'Startup Cost': 0.0, 'Total Cost': 207719.33, 'Plan Rows': 3333333, 'Plan Width': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1524153.35, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 51799.54, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1374483.88, 'Plan Rows': 24994188, 'Plan Width': 29}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 51378.67, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Filter': ""((p_name)::text ~~ '%green%'::text)""}]}]}]}]}]}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.25, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.0, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 59, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]","[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 2119638.82, 'Total Cost': 2119651.71, 'Plan Rows': 94, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2119638.82, 'Total Cost': 2119649.28, 'Plan Rows': 78, 'Plan Width': 66, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2118638.79, 'Total Cost': 2118640.26, 'Plan Rows': 39, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2118638.79, 'Total Cost': 2118638.89, 'Plan Rows': 39, 'Plan Width': 57, 'Sort Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC""], 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 1771786.36, 'Total Cost': 2118637.76, 'Plan Rows': 39, 'Plan Width': 57, 'Inner Unique': False, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1771786.35, 'Total Cost': 2118636.01, 'Plan Rows': 39, 'Plan Width': 31, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = lineitem.l_orderkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.0, 'Total Cost': 323412.0, 'Plan Rows': 6250000, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1771785.86, 'Total Cost': 1771785.86, 'Plan Rows': 39, 'Plan Width': 31, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 1539063.6, 'Total Cost': 1771785.86, 'Plan Rows': 39, 'Plan Width': 31, 'Inner Unique': False, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1539063.56, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '((partsupp.ps_suppkey = lineitem.l_suppkey) AND (partsupp.ps_partkey = lineitem.l_partkey))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'partsupp', 'Alias': 'partsupp', 'Startup Cost': 0.0, 'Total Cost': 207719.33, 'Plan Rows': 3333333, 'Plan Width': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1524153.35, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 51799.54, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1374483.88, 'Plan Rows': 24994188, 'Plan Width': 29}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 51378.67, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Filter': ""((p_name)::text ~~ '%green%'::text)""}]}]}]}]}, {'Node Type': 'Index Only Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13412>btree_supplier_s_suppkey_s_nationkey', 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.04, 'Total Cost': 0.06, 'Plan Rows': 1, 'Plan Width': 8, 'Index Cond': '(s_suppkey = lineitem.l_suppkey)'}]}]}]}, {'Node Type': 'Index Only Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13411>btree_nation_n_nationkey_n_name', 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.01, 'Total Cost': 0.03, 'Plan Rows': 1, 'Plan Width': 30, 'Index Cond': '(n_nationkey = supplier.s_nationkey)'}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 46, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]"
40,"



-- using default substitutions


select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%green%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc","['I(C supplier.s_suppkey,C supplier.s_nationkey)', 'I(C orders.o_orderkey)']",2122683.97,1772806.31,24510.436,21579.523,0.0452497893731527,0.16482795599572936,0.11957816662257661,"[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 2122662.98, 'Total Cost': 2122673.42, 'Plan Rows': 94, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2122662.98, 'Total Cost': 2122671.23, 'Plan Rows': 55, 'Plan Width': 66, 'Workers Planned': 1, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.97, 'Total Cost': 2121665.03, 'Plan Rows': 55, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.97, 'Total Cost': 2121663.11, 'Plan Rows': 55, 'Plan Width': 57, 'Sort Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC""], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 2118635.28, 'Total Cost': 2121661.38, 'Plan Rows': 55, 'Plan Width': 57, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = nation.n_nationkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 2118633.72, 'Total Cost': 2121658.79, 'Plan Rows': 55, 'Plan Width': 31, 'Inner Unique': False, 'Hash Cond': '(supplier.s_suppkey = lineitem.l_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 2118633.22, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1771783.55, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = lineitem.l_orderkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.0, 'Total Cost': 323412.0, 'Plan Rows': 6250000, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1771783.05, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1539063.56, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '((partsupp.ps_suppkey = lineitem.l_suppkey) AND (partsupp.ps_partkey = lineitem.l_partkey))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'partsupp', 'Alias': 'partsupp', 'Startup Cost': 0.0, 'Total Cost': 207719.33, 'Plan Rows': 3333333, 'Plan Width': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1524153.35, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 51799.54, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1374483.88, 'Plan Rows': 24994188, 'Plan Width': 29}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 51378.67, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Filter': ""((p_name)::text ~~ '%green%'::text)""}]}]}]}]}]}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.25, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.0, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 59, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]","[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 1772793.42, 'Total Cost': 1772806.31, 'Plan Rows': 94, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1772793.42, 'Total Cost': 1772803.89, 'Plan Rows': 78, 'Plan Width': 66, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1771793.4, 'Total Cost': 1771794.86, 'Plan Rows': 39, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1771793.4, 'Total Cost': 1771793.5, 'Plan Rows': 39, 'Plan Width': 57, 'Sort Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC""], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 1539065.23, 'Total Cost': 1771792.37, 'Plan Rows': 39, 'Plan Width': 57, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = nation.n_nationkey)', 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 1539063.66, 'Total Cost': 1771790.07, 'Plan Rows': 39, 'Plan Width': 31, 'Inner Unique': False, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 1539063.6, 'Total Cost': 1771785.86, 'Plan Rows': 39, 'Plan Width': 31, 'Inner Unique': False, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1539063.56, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '((partsupp.ps_suppkey = lineitem.l_suppkey) AND (partsupp.ps_partkey = lineitem.l_partkey))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'partsupp', 'Alias': 'partsupp', 'Startup Cost': 0.0, 'Total Cost': 207719.33, 'Plan Rows': 3333333, 'Plan Width': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1524153.35, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 51799.54, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1374483.88, 'Plan Rows': 24994188, 'Plan Width': 29}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 51378.67, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Filter': ""((p_name)::text ~~ '%green%'::text)""}]}]}]}]}, {'Node Type': 'Index Only Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13411>btree_supplier_s_suppkey_s_nationkey', 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.04, 'Total Cost': 0.06, 'Plan Rows': 1, 'Plan Width': 8, 'Index Cond': '(s_suppkey = lineitem.l_suppkey)'}]}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13412>btree_orders_o_orderkey', 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.06, 'Total Cost': 0.1, 'Plan Rows': 1, 'Plan Width': 8, 'Index Cond': '(o_orderkey = lineitem.l_orderkey)'}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.25, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.0, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 47, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]"
41,"



-- using default substitutions


select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%green%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc","['I(C lineitem.l_partkey,C lineitem.l_suppkey)', 'I(C nation.n_nationkey,C nation.n_name)', 'I(C supplier.s_suppkey,C supplier.s_nationkey)']",2122683.97,729583.47,24510.436,13226.231,0.1959083049556375,0.6562919962127005,0.46038369125706297,"[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 2122662.98, 'Total Cost': 2122673.42, 'Plan Rows': 94, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2122662.98, 'Total Cost': 2122671.23, 'Plan Rows': 55, 'Plan Width': 66, 'Workers Planned': 1, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.97, 'Total Cost': 2121665.03, 'Plan Rows': 55, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.97, 'Total Cost': 2121663.11, 'Plan Rows': 55, 'Plan Width': 57, 'Sort Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC""], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 2118635.28, 'Total Cost': 2121661.38, 'Plan Rows': 55, 'Plan Width': 57, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = nation.n_nationkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 2118633.72, 'Total Cost': 2121658.79, 'Plan Rows': 55, 'Plan Width': 31, 'Inner Unique': False, 'Hash Cond': '(supplier.s_suppkey = lineitem.l_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 2118633.22, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1771783.55, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = lineitem.l_orderkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.0, 'Total Cost': 323412.0, 'Plan Rows': 6250000, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1771783.05, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1539063.56, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '((partsupp.ps_suppkey = lineitem.l_suppkey) AND (partsupp.ps_partkey = lineitem.l_partkey))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'partsupp', 'Alias': 'partsupp', 'Startup Cost': 0.0, 'Total Cost': 207719.33, 'Plan Rows': 3333333, 'Plan Width': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1524153.35, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 51799.54, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1374483.88, 'Plan Rows': 24994188, 'Plan Width': 29}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 51378.67, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Filter': ""((p_name)::text ~~ '%green%'::text)""}]}]}]}]}]}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.25, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.0, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 59, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]","[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 729570.58, 'Total Cost': 729583.47, 'Plan Rows': 94, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 729570.58, 'Total Cost': 729581.05, 'Plan Rows': 78, 'Plan Width': 66, 'Workers Planned': 2, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 728570.56, 'Total Cost': 728572.02, 'Plan Rows': 39, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 728570.56, 'Total Cost': 728570.66, 'Plan Rows': 39, 'Plan Width': 57, 'Sort Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC""], 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 381718.12, 'Total Cost': 728569.53, 'Plan Rows': 39, 'Plan Width': 57, 'Inner Unique': False, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 381718.11, 'Total Cost': 728567.77, 'Plan Rows': 39, 'Plan Width': 31, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = lineitem.l_orderkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.0, 'Total Cost': 323412.0, 'Plan Rows': 6250000, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 381717.62, 'Total Cost': 381717.62, 'Plan Rows': 39, 'Plan Width': 31, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 51799.65, 'Total Cost': 381717.62, 'Plan Rows': 39, 'Plan Width': 31, 'Inner Unique': False, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 51799.61, 'Total Cost': 381714.82, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 51799.54, 'Total Cost': 272580.04, 'Plan Rows': 134680, 'Plan Width': 18, 'Inner Unique': False, 'Hash Cond': '(partsupp.ps_partkey = part.p_partkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'partsupp', 'Alias': 'partsupp', 'Startup Cost': 0.0, 'Total Cost': 207719.33, 'Plan Rows': 3333333, 'Plan Width': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 51378.67, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Filter': ""((p_name)::text ~~ '%green%'::text)""}]}]}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13411>btree_lineitem_l_partkey_l_suppkey', 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.07, 'Total Cost': 0.8, 'Plan Rows': 1, 'Plan Width': 29, 'Index Cond': '((l_partkey = partsupp.ps_partkey) AND (l_suppkey = partsupp.ps_suppkey))'}]}, {'Node Type': 'Index Only Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13413>btree_supplier_s_suppkey_s_nationkey', 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.04, 'Total Cost': 0.06, 'Plan Rows': 1, 'Plan Width': 8, 'Index Cond': '(s_suppkey = lineitem.l_suppkey)'}]}]}]}, {'Node Type': 'Index Only Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13412>btree_nation_n_nationkey_n_name', 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.01, 'Total Cost': 0.03, 'Plan Rows': 1, 'Plan Width': 30, 'Index Cond': '(n_nationkey = supplier.s_nationkey)'}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 38, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]"
42,"



-- using default substitutions


select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%green%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc","['I(C nation.n_nationkey,C nation.n_name)']",2122683.97,2122673.31,24510.436,26636.446,0.0867439930500092,5.021943987332702e-06,0.0,"[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 2122662.98, 'Total Cost': 2122673.42, 'Plan Rows': 94, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2122662.98, 'Total Cost': 2122671.23, 'Plan Rows': 55, 'Plan Width': 66, 'Workers Planned': 1, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.97, 'Total Cost': 2121665.03, 'Plan Rows': 55, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.97, 'Total Cost': 2121663.11, 'Plan Rows': 55, 'Plan Width': 57, 'Sort Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC""], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 2118635.28, 'Total Cost': 2121661.38, 'Plan Rows': 55, 'Plan Width': 57, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = nation.n_nationkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 2118633.72, 'Total Cost': 2121658.79, 'Plan Rows': 55, 'Plan Width': 31, 'Inner Unique': False, 'Hash Cond': '(supplier.s_suppkey = lineitem.l_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 2118633.22, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1771783.55, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = lineitem.l_orderkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.0, 'Total Cost': 323412.0, 'Plan Rows': 6250000, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1771783.05, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1539063.56, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '((partsupp.ps_suppkey = lineitem.l_suppkey) AND (partsupp.ps_partkey = lineitem.l_partkey))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'partsupp', 'Alias': 'partsupp', 'Startup Cost': 0.0, 'Total Cost': 207719.33, 'Plan Rows': 3333333, 'Plan Width': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1524153.35, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 51799.54, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1374483.88, 'Plan Rows': 24994188, 'Plan Width': 29}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 51378.67, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Filter': ""((p_name)::text ~~ '%green%'::text)""}]}]}]}]}]}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.25, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.0, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 59, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]","[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 2122662.87, 'Total Cost': 2122673.31, 'Plan Rows': 94, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2122662.87, 'Total Cost': 2122671.12, 'Plan Rows': 55, 'Plan Width': 66, 'Workers Planned': 1, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.86, 'Total Cost': 2121664.92, 'Plan Rows': 55, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.86, 'Total Cost': 2121662.99, 'Plan Rows': 55, 'Plan Width': 57, 'Sort Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC""], 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 2118633.73, 'Total Cost': 2121661.27, 'Plan Rows': 55, 'Plan Width': 57, 'Inner Unique': False, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 2118633.72, 'Total Cost': 2121658.79, 'Plan Rows': 55, 'Plan Width': 31, 'Inner Unique': False, 'Hash Cond': '(supplier.s_suppkey = lineitem.l_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 2118633.22, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1771783.55, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = lineitem.l_orderkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.0, 'Total Cost': 323412.0, 'Plan Rows': 6250000, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1771783.05, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1539063.56, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '((partsupp.ps_suppkey = lineitem.l_suppkey) AND (partsupp.ps_partkey = lineitem.l_partkey))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'partsupp', 'Alias': 'partsupp', 'Startup Cost': 0.0, 'Total Cost': 207719.33, 'Plan Rows': 3333333, 'Plan Width': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1524153.35, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 51799.54, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1374483.88, 'Plan Rows': 24994188, 'Plan Width': 29}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 51378.67, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Filter': ""((p_name)::text ~~ '%green%'::text)""}]}]}]}]}]}]}]}]}, {'Node Type': 'Index Only Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13411>btree_nation_n_nationkey_n_name', 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.01, 'Total Cost': 0.03, 'Plan Rows': 1, 'Plan Width': 30, 'Index Cond': '(n_nationkey = supplier.s_nationkey)'}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 53, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]"
43,"



-- using default substitutions


select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%green%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc","['I(C nation.n_nationkey,C nation.n_name)', 'I(C orders.o_orderkey)']",2122683.97,1775827.46,24510.436,29632.642,0.3723853025736648,0.16340468713296036,0.0,"[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 2122662.98, 'Total Cost': 2122673.42, 'Plan Rows': 94, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2122662.98, 'Total Cost': 2122671.23, 'Plan Rows': 55, 'Plan Width': 66, 'Workers Planned': 1, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.97, 'Total Cost': 2121665.03, 'Plan Rows': 55, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.97, 'Total Cost': 2121663.11, 'Plan Rows': 55, 'Plan Width': 57, 'Sort Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC""], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 2118635.28, 'Total Cost': 2121661.38, 'Plan Rows': 55, 'Plan Width': 57, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = nation.n_nationkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 2118633.72, 'Total Cost': 2121658.79, 'Plan Rows': 55, 'Plan Width': 31, 'Inner Unique': False, 'Hash Cond': '(supplier.s_suppkey = lineitem.l_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 2118633.22, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1771783.55, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = lineitem.l_orderkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.0, 'Total Cost': 323412.0, 'Plan Rows': 6250000, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1771783.05, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1539063.56, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '((partsupp.ps_suppkey = lineitem.l_suppkey) AND (partsupp.ps_partkey = lineitem.l_partkey))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'partsupp', 'Alias': 'partsupp', 'Startup Cost': 0.0, 'Total Cost': 207719.33, 'Plan Rows': 3333333, 'Plan Width': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1524153.35, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 51799.54, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1374483.88, 'Plan Rows': 24994188, 'Plan Width': 29}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 51378.67, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Filter': ""((p_name)::text ~~ '%green%'::text)""}]}]}]}]}]}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.25, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.0, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 59, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]","[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 1775817.02, 'Total Cost': 1775827.46, 'Plan Rows': 94, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1775817.02, 'Total Cost': 1775825.27, 'Plan Rows': 55, 'Plan Width': 66, 'Workers Planned': 1, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1774817.01, 'Total Cost': 1774819.07, 'Plan Rows': 55, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1774817.01, 'Total Cost': 1774817.15, 'Plan Rows': 55, 'Plan Width': 57, 'Sort Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC""], 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 1771787.89, 'Total Cost': 1774815.42, 'Plan Rows': 55, 'Plan Width': 57, 'Inner Unique': False, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1771787.87, 'Total Cost': 1774812.94, 'Plan Rows': 55, 'Plan Width': 31, 'Inner Unique': False, 'Hash Cond': '(supplier.s_suppkey = lineitem.l_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1771787.37, 'Total Cost': 1771787.37, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 1539063.62, 'Total Cost': 1771787.37, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1539063.56, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '((partsupp.ps_suppkey = lineitem.l_suppkey) AND (partsupp.ps_partkey = lineitem.l_partkey))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'partsupp', 'Alias': 'partsupp', 'Startup Cost': 0.0, 'Total Cost': 207719.33, 'Plan Rows': 3333333, 'Plan Width': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1524153.35, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 51799.54, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1374483.88, 'Plan Rows': 24994188, 'Plan Width': 29}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 51378.67, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Filter': ""((p_name)::text ~~ '%green%'::text)""}]}]}]}]}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13412>btree_orders_o_orderkey', 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.06, 'Total Cost': 0.1, 'Plan Rows': 1, 'Plan Width': 8, 'Index Cond': '(o_orderkey = lineitem.l_orderkey)'}]}]}]}, {'Node Type': 'Index Only Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13411>btree_nation_n_nationkey_n_name', 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.01, 'Total Cost': 0.03, 'Plan Rows': 1, 'Plan Width': 30, 'Index Cond': '(n_nationkey = supplier.s_nationkey)'}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 48, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]"
44,"



-- using default substitutions


select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%green%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc",['I(C orders.o_orderkey)'],2122683.97,1775827.58,24510.436,30762.358,0.4184764702041006,0.16340463060075783,0.0,"[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 2122662.98, 'Total Cost': 2122673.42, 'Plan Rows': 94, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2122662.98, 'Total Cost': 2122671.23, 'Plan Rows': 55, 'Plan Width': 66, 'Workers Planned': 1, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.97, 'Total Cost': 2121665.03, 'Plan Rows': 55, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 2121662.97, 'Total Cost': 2121663.11, 'Plan Rows': 55, 'Plan Width': 57, 'Sort Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC""], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 2118635.28, 'Total Cost': 2121661.38, 'Plan Rows': 55, 'Plan Width': 57, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = nation.n_nationkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 2118633.72, 'Total Cost': 2121658.79, 'Plan Rows': 55, 'Plan Width': 31, 'Inner Unique': False, 'Hash Cond': '(supplier.s_suppkey = lineitem.l_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 2118633.22, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1771783.55, 'Total Cost': 2118633.22, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = lineitem.l_orderkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.0, 'Total Cost': 323412.0, 'Plan Rows': 6250000, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1771783.05, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1539063.56, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '((partsupp.ps_suppkey = lineitem.l_suppkey) AND (partsupp.ps_partkey = lineitem.l_partkey))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'partsupp', 'Alias': 'partsupp', 'Startup Cost': 0.0, 'Total Cost': 207719.33, 'Plan Rows': 3333333, 'Plan Width': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1524153.35, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 51799.54, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1374483.88, 'Plan Rows': 24994188, 'Plan Width': 29}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 51378.67, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Filter': ""((p_name)::text ~~ '%green%'::text)""}]}]}]}]}]}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.25, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.0, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 59, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]","[{'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Finalize', 'Parallel Aware': False, 'Startup Cost': 1775817.13, 'Total Cost': 1775827.58, 'Plan Rows': 94, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1775817.13, 'Total Cost': 1775825.38, 'Plan Rows': 55, 'Plan Width': 66, 'Workers Planned': 1, 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Partial', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1774817.12, 'Total Cost': 1774819.19, 'Plan Rows': 55, 'Plan Width': 66, 'Group Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))""], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1774817.12, 'Total Cost': 1774817.26, 'Plan Rows': 55, 'Plan Width': 57, 'Sort Key': ['nation.n_name', ""(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC""], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 1771789.44, 'Total Cost': 1774815.53, 'Plan Rows': 55, 'Plan Width': 57, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = nation.n_nationkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1771787.87, 'Total Cost': 1774812.94, 'Plan Rows': 55, 'Plan Width': 31, 'Inner Unique': False, 'Hash Cond': '(supplier.s_suppkey = lineitem.l_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 8}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1771787.37, 'Total Cost': 1771787.37, 'Plan Rows': 40, 'Plan Width': 35, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 1539063.62, 'Total Cost': 1771787.37, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1539063.56, 'Total Cost': 1771783.05, 'Plan Rows': 40, 'Plan Width': 35, 'Inner Unique': False, 'Hash Cond': '((partsupp.ps_suppkey = lineitem.l_suppkey) AND (partsupp.ps_partkey = lineitem.l_partkey))', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'partsupp', 'Alias': 'partsupp', 'Startup Cost': 0.0, 'Total Cost': 207719.33, 'Plan Rows': 3333333, 'Plan Width': 14}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1524153.35, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 51799.54, 'Total Cost': 1524153.35, 'Plan Rows': 994014, 'Plan Width': 33, 'Inner Unique': False, 'Hash Cond': '(lineitem.l_partkey = part.p_partkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'lineitem', 'Startup Cost': 0.0, 'Total Cost': 1374483.88, 'Plan Rows': 24994188, 'Plan Width': 29}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 51378.67, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'part', 'Alias': 'part', 'Startup Cost': 0.0, 'Total Cost': 51378.67, 'Plan Rows': 33670, 'Plan Width': 4, 'Filter': ""((p_name)::text ~~ '%green%'::text)""}]}]}]}]}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13411>btree_orders_o_orderkey', 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.06, 'Total Cost': 0.1, 'Plan Rows': 1, 'Plan Width': 8, 'Index Cond': '(o_orderkey = lineitem.l_orderkey)'}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.25, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.0, 'Total Cost': 1.25, 'Plan Rows': 25, 'Plan Width': 30}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 54, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]"
45,"



-- using default substitutions


select
	s_name,
	count(*) as numwait
from
	supplier,
	lineitem l1,
	orders,
	nation
where
	s_suppkey = l1.l_suppkey
	and o_orderkey = l1.l_orderkey
	and o_orderstatus = 'F'
	and l1.l_receiptdate > l1.l_commitdate
	and exists (
		select
			*
		from
			lineitem l2
		where
			l2.l_orderkey = l1.l_orderkey
			and l2.l_suppkey <> l1.l_suppkey
	)
	and not exists (
		select
			*
		from
			lineitem l3
		where
			l3.l_orderkey = l1.l_orderkey
			and l3.l_suppkey <> l1.l_suppkey
			and l3.l_receiptdate > l3.l_commitdate
	)
	and s_nationkey = n_nationkey
	and n_name = 'SAUDI ARABIA'
group by
	s_name
order by
	numwait desc,
	s_name",['I(C lineitem.l_orderkey)'],5054466.33,1870643.55,26317.715,9207.075,-0.0202538914021614,0.629902856628585,0.6501567480307465,"[{'Plan': {'Node Type': 'Sort', 'Parallel Aware': False, 'Startup Cost': 5054466.33, 'Total Cost': 5054466.33, 'Plan Rows': 1, 'Plan Width': 34, 'Sort Key': ['(count(*)) DESC', 'supplier.s_name'], 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Simple', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 5054466.3, 'Total Cost': 5054466.32, 'Plan Rows': 1, 'Plan Width': 34, 'Group Key': ['supplier.s_name'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 5054466.3, 'Total Cost': 5054466.3, 'Plan Rows': 1, 'Plan Width': 26, 'Sort Key': ['supplier.s_name'], 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 4703940.89, 'Total Cost': 5054466.29, 'Plan Rows': 1, 'Plan Width': 26, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Semi', 'Startup Cost': 4702940.89, 'Total Cost': 5053466.19, 'Plan Rows': 1, 'Plan Width': 26, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = l2.l_orderkey)', 'Join Filter': '(l2.l_suppkey <> l1.l_suppkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 3016029.66, 'Total Cost': 3366554.95, 'Plan Rows': 1, 'Plan Width': 38, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = l1.l_orderkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.0, 'Total Cost': 339037.0, 'Plan Rows': 3063542, 'Plan Width': 4, 'Filter': ""(o_orderstatus = 'F'::bpchar)""}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 3016029.65, 'Total Cost': 3016029.65, 'Plan Rows': 1, 'Plan Width': 34, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Anti', 'Startup Cost': 1544190.9, 'Total Cost': 3016029.65, 'Plan Rows': 1, 'Plan Width': 34, 'Inner Unique': False, 'Hash Cond': '(l1.l_orderkey = l3.l_orderkey)', 'Join Filter': '(l3.l_suppkey <> l1.l_suppkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 3079.09, 'Total Cost': 1473251.56, 'Plan Rows': 333256, 'Plan Width': 34, 'Inner Unique': False, 'Hash Cond': '(l1.l_suppkey = supplier.s_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'l1', 'Startup Cost': 0.0, 'Total Cost': 1436969.35, 'Plan Rows': 8331396, 'Plan Width': 8, 'Filter': '(l_receiptdate > l_commitdate)'}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 3049.68, 'Total Cost': 3049.68, 'Plan Rows': 2353, 'Plan Width': 30, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 1.32, 'Total Cost': 3049.68, 'Plan Rows': 2353, 'Plan Width': 30, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = nation.n_nationkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 34}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.31, 'Total Cost': 1.31, 'Plan Rows': 1, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.0, 'Total Cost': 1.31, 'Plan Rows': 1, 'Plan Width': 4, 'Filter': ""(n_name = 'SAUDI ARABIA'::bpchar)""}]}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1436969.35, 'Total Cost': 1436969.35, 'Plan Rows': 8331396, 'Plan Width': 8, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'l3', 'Startup Cost': 0.0, 'Total Cost': 1436969.35, 'Plan Rows': 8331396, 'Plan Width': 8, 'Filter': '(l_receiptdate > l_commitdate)'}]}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1374483.88, 'Total Cost': 1374483.88, 'Plan Rows': 24994188, 'Plan Width': 8, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'l2', 'Startup Cost': 0.0, 'Total Cost': 1374483.88, 'Plan Rows': 24994188, 'Plan Width': 8}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 58, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]","[{'Plan': {'Node Type': 'Sort', 'Parallel Aware': False, 'Startup Cost': 1870643.55, 'Total Cost': 1870643.55, 'Plan Rows': 1, 'Plan Width': 34, 'Sort Key': ['(count(*)) DESC', 'supplier.s_name'], 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Simple', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1870643.52, 'Total Cost': 1870643.54, 'Plan Rows': 1, 'Plan Width': 34, 'Group Key': ['supplier.s_name'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1870643.52, 'Total Cost': 1870643.52, 'Plan Rows': 1, 'Plan Width': 26, 'Sort Key': ['supplier.s_name'], 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Semi', 'Startup Cost': 1478417.39, 'Total Cost': 1870643.51, 'Plan Rows': 1, 'Plan Width': 26, 'Inner Unique': False, 'Join Filter': '(orders.o_orderkey = l2.l_orderkey)', 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1478417.33, 'Total Cost': 1870638.53, 'Plan Rows': 1, 'Plan Width': 38, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Anti', 'Startup Cost': 1477417.33, 'Total Cost': 1869638.43, 'Plan Rows': 1, 'Plan Width': 38, 'Inner Unique': False, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 1477417.26, 'Total Cost': 1832452.6, 'Plan Rows': 163351, 'Plan Width': 38, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = l1.l_orderkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.0, 'Total Cost': 339037.0, 'Plan Rows': 3063542, 'Plan Width': 4, 'Filter': ""(o_orderstatus = 'F'::bpchar)""}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1473251.56, 'Total Cost': 1473251.56, 'Plan Rows': 333256, 'Plan Width': 34, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 3079.09, 'Total Cost': 1473251.56, 'Plan Rows': 333256, 'Plan Width': 34, 'Inner Unique': False, 'Hash Cond': '(l1.l_suppkey = supplier.s_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'l1', 'Startup Cost': 0.0, 'Total Cost': 1436969.35, 'Plan Rows': 8331396, 'Plan Width': 8, 'Filter': '(l_receiptdate > l_commitdate)'}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 3049.68, 'Total Cost': 3049.68, 'Plan Rows': 2353, 'Plan Width': 30, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 1.32, 'Total Cost': 3049.68, 'Plan Rows': 2353, 'Plan Width': 30, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = nation.n_nationkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 34}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.31, 'Total Cost': 1.31, 'Plan Rows': 1, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.0, 'Total Cost': 1.31, 'Plan Rows': 1, 'Plan Width': 4, 'Filter': ""(n_name = 'SAUDI ARABIA'::bpchar)""}]}]}]}]}]}]}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13411>btree_lineitem_l_orderkey', 'Relation Name': 'lineitem', 'Alias': 'l3', 'Startup Cost': 0.07, 'Total Cost': 3.55, 'Plan Rows': 48, 'Plan Width': 8, 'Index Cond': '(l_orderkey = l1.l_orderkey)', 'Filter': '((l_receiptdate > l_commitdate) AND (l_suppkey <> l1.l_suppkey))'}]}]}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13411>btree_lineitem_l_orderkey', 'Relation Name': 'lineitem', 'Alias': 'l2', 'Startup Cost': 0.07, 'Total Cost': 3.19, 'Plan Rows': 143, 'Plan Width': 8, 'Index Cond': '(l_orderkey = l1.l_orderkey)', 'Filter': '(l_suppkey <> l1.l_suppkey)'}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 50, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]"
46,"



-- using default substitutions


select
	s_name,
	count(*) as numwait
from
	supplier,
	lineitem l1,
	orders,
	nation
where
	s_suppkey = l1.l_suppkey
	and o_orderkey = l1.l_orderkey
	and o_orderstatus = 'F'
	and l1.l_receiptdate > l1.l_commitdate
	and exists (
		select
			*
		from
			lineitem l2
		where
			l2.l_orderkey = l1.l_orderkey
			and l2.l_suppkey <> l1.l_suppkey
	)
	and not exists (
		select
			*
		from
			lineitem l3
		where
			l3.l_orderkey = l1.l_orderkey
			and l3.l_suppkey <> l1.l_suppkey
			and l3.l_receiptdate > l3.l_commitdate
	)
	and s_nationkey = n_nationkey
	and n_name = 'SAUDI ARABIA'
group by
	s_name
order by
	numwait desc,
	s_name","['I(C lineitem.l_orderkey)', 'I(C orders.o_orderkey)']",5054466.33,1550115.23,26317.715,8657.253,0.0222692702080852,0.6933177255926047,0.6710484553845195,"[{'Plan': {'Node Type': 'Sort', 'Parallel Aware': False, 'Startup Cost': 5054466.33, 'Total Cost': 5054466.33, 'Plan Rows': 1, 'Plan Width': 34, 'Sort Key': ['(count(*)) DESC', 'supplier.s_name'], 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Simple', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 5054466.3, 'Total Cost': 5054466.32, 'Plan Rows': 1, 'Plan Width': 34, 'Group Key': ['supplier.s_name'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 5054466.3, 'Total Cost': 5054466.3, 'Plan Rows': 1, 'Plan Width': 26, 'Sort Key': ['supplier.s_name'], 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 4703940.89, 'Total Cost': 5054466.29, 'Plan Rows': 1, 'Plan Width': 26, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Semi', 'Startup Cost': 4702940.89, 'Total Cost': 5053466.19, 'Plan Rows': 1, 'Plan Width': 26, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = l2.l_orderkey)', 'Join Filter': '(l2.l_suppkey <> l1.l_suppkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 3016029.66, 'Total Cost': 3366554.95, 'Plan Rows': 1, 'Plan Width': 38, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = l1.l_orderkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.0, 'Total Cost': 339037.0, 'Plan Rows': 3063542, 'Plan Width': 4, 'Filter': ""(o_orderstatus = 'F'::bpchar)""}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 3016029.65, 'Total Cost': 3016029.65, 'Plan Rows': 1, 'Plan Width': 34, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Anti', 'Startup Cost': 1544190.9, 'Total Cost': 3016029.65, 'Plan Rows': 1, 'Plan Width': 34, 'Inner Unique': False, 'Hash Cond': '(l1.l_orderkey = l3.l_orderkey)', 'Join Filter': '(l3.l_suppkey <> l1.l_suppkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 3079.09, 'Total Cost': 1473251.56, 'Plan Rows': 333256, 'Plan Width': 34, 'Inner Unique': False, 'Hash Cond': '(l1.l_suppkey = supplier.s_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'l1', 'Startup Cost': 0.0, 'Total Cost': 1436969.35, 'Plan Rows': 8331396, 'Plan Width': 8, 'Filter': '(l_receiptdate > l_commitdate)'}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 3049.68, 'Total Cost': 3049.68, 'Plan Rows': 2353, 'Plan Width': 30, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 1.32, 'Total Cost': 3049.68, 'Plan Rows': 2353, 'Plan Width': 30, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = nation.n_nationkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 34}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.31, 'Total Cost': 1.31, 'Plan Rows': 1, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.0, 'Total Cost': 1.31, 'Plan Rows': 1, 'Plan Width': 4, 'Filter': ""(n_name = 'SAUDI ARABIA'::bpchar)""}]}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1436969.35, 'Total Cost': 1436969.35, 'Plan Rows': 8331396, 'Plan Width': 8, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'l3', 'Startup Cost': 0.0, 'Total Cost': 1436969.35, 'Plan Rows': 8331396, 'Plan Width': 8, 'Filter': '(l_receiptdate > l_commitdate)'}]}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1374483.88, 'Total Cost': 1374483.88, 'Plan Rows': 24994188, 'Plan Width': 8, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'l2', 'Startup Cost': 0.0, 'Total Cost': 1374483.88, 'Plan Rows': 24994188, 'Plan Width': 8}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 58, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]","[{'Plan': {'Node Type': 'Sort', 'Parallel Aware': False, 'Startup Cost': 1550115.23, 'Total Cost': 1550115.23, 'Plan Rows': 1, 'Plan Width': 34, 'Sort Key': ['(count(*)) DESC', 'supplier.s_name'], 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Simple', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1550115.2, 'Total Cost': 1550115.22, 'Plan Rows': 1, 'Plan Width': 34, 'Group Key': ['supplier.s_name'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1550115.2, 'Total Cost': 1550115.2, 'Plan Rows': 1, 'Plan Width': 26, 'Sort Key': ['supplier.s_name'], 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 4079.28, 'Total Cost': 1550115.19, 'Plan Rows': 1, 'Plan Width': 26, 'Inner Unique': False, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Semi', 'Startup Cost': 4079.22, 'Total Cost': 1550115.04, 'Plan Rows': 1, 'Plan Width': 34, 'Inner Unique': False, 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 4079.16, 'Total Cost': 1550111.83, 'Plan Rows': 1, 'Plan Width': 34, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Anti', 'Startup Cost': 3079.16, 'Total Cost': 1549111.73, 'Plan Rows': 1, 'Plan Width': 34, 'Inner Unique': False, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 3079.09, 'Total Cost': 1473251.56, 'Plan Rows': 333256, 'Plan Width': 34, 'Inner Unique': False, 'Hash Cond': '(l1.l_suppkey = supplier.s_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'l1', 'Startup Cost': 0.0, 'Total Cost': 1436969.35, 'Plan Rows': 8331396, 'Plan Width': 8, 'Filter': '(l_receiptdate > l_commitdate)'}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 3049.68, 'Total Cost': 3049.68, 'Plan Rows': 2353, 'Plan Width': 30, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 1.32, 'Total Cost': 3049.68, 'Plan Rows': 2353, 'Plan Width': 30, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = nation.n_nationkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 34}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.31, 'Total Cost': 1.31, 'Plan Rows': 1, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.0, 'Total Cost': 1.31, 'Plan Rows': 1, 'Plan Width': 4, 'Filter': ""(n_name = 'SAUDI ARABIA'::bpchar)""}]}]}]}]}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13411>btree_lineitem_l_orderkey', 'Relation Name': 'lineitem', 'Alias': 'l3', 'Startup Cost': 0.07, 'Total Cost': 3.55, 'Plan Rows': 48, 'Plan Width': 8, 'Index Cond': '(l_orderkey = l1.l_orderkey)', 'Filter': '((l_receiptdate > l_commitdate) AND (l_suppkey <> l1.l_suppkey))'}]}]}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13411>btree_lineitem_l_orderkey', 'Relation Name': 'lineitem', 'Alias': 'l2', 'Startup Cost': 0.07, 'Total Cost': 3.19, 'Plan Rows': 143, 'Plan Width': 8, 'Index Cond': '(l_orderkey = l1.l_orderkey)', 'Filter': '(l_suppkey <> l1.l_suppkey)'}]}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13412>btree_orders_o_orderkey', 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.06, 'Total Cost': 0.14, 'Plan Rows': 1, 'Plan Width': 4, 'Index Cond': '(o_orderkey = l1.l_orderkey)', 'Filter': ""(o_orderstatus = 'F'::bpchar)""}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 43, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]"
47,"



-- using default substitutions


select
	s_name,
	count(*) as numwait
from
	supplier,
	lineitem l1,
	orders,
	nation
where
	s_suppkey = l1.l_suppkey
	and o_orderkey = l1.l_orderkey
	and o_orderstatus = 'F'
	and l1.l_receiptdate > l1.l_commitdate
	and exists (
		select
			*
		from
			lineitem l2
		where
			l2.l_orderkey = l1.l_orderkey
			and l2.l_suppkey <> l1.l_suppkey
	)
	and not exists (
		select
			*
		from
			lineitem l3
		where
			l3.l_orderkey = l1.l_orderkey
			and l3.l_suppkey <> l1.l_suppkey
			and l3.l_receiptdate > l3.l_commitdate
	)
	and s_nationkey = n_nationkey
	and n_name = 'SAUDI ARABIA'
group by
	s_name
order by
	numwait desc,
	s_name",['I(C orders.o_orderkey)'],5054466.33,4703941.18,26317.715,24934.452,0.0167894383332291,0.06934958650718727,0.05256014817395807,"[{'Plan': {'Node Type': 'Sort', 'Parallel Aware': False, 'Startup Cost': 5054466.33, 'Total Cost': 5054466.33, 'Plan Rows': 1, 'Plan Width': 34, 'Sort Key': ['(count(*)) DESC', 'supplier.s_name'], 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Simple', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 5054466.3, 'Total Cost': 5054466.32, 'Plan Rows': 1, 'Plan Width': 34, 'Group Key': ['supplier.s_name'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 5054466.3, 'Total Cost': 5054466.3, 'Plan Rows': 1, 'Plan Width': 26, 'Sort Key': ['supplier.s_name'], 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 4703940.89, 'Total Cost': 5054466.29, 'Plan Rows': 1, 'Plan Width': 26, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Semi', 'Startup Cost': 4702940.89, 'Total Cost': 5053466.19, 'Plan Rows': 1, 'Plan Width': 26, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = l2.l_orderkey)', 'Join Filter': '(l2.l_suppkey <> l1.l_suppkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 3016029.66, 'Total Cost': 3366554.95, 'Plan Rows': 1, 'Plan Width': 38, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = l1.l_orderkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.0, 'Total Cost': 339037.0, 'Plan Rows': 3063542, 'Plan Width': 4, 'Filter': ""(o_orderstatus = 'F'::bpchar)""}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 3016029.65, 'Total Cost': 3016029.65, 'Plan Rows': 1, 'Plan Width': 34, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Anti', 'Startup Cost': 1544190.9, 'Total Cost': 3016029.65, 'Plan Rows': 1, 'Plan Width': 34, 'Inner Unique': False, 'Hash Cond': '(l1.l_orderkey = l3.l_orderkey)', 'Join Filter': '(l3.l_suppkey <> l1.l_suppkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 3079.09, 'Total Cost': 1473251.56, 'Plan Rows': 333256, 'Plan Width': 34, 'Inner Unique': False, 'Hash Cond': '(l1.l_suppkey = supplier.s_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'l1', 'Startup Cost': 0.0, 'Total Cost': 1436969.35, 'Plan Rows': 8331396, 'Plan Width': 8, 'Filter': '(l_receiptdate > l_commitdate)'}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 3049.68, 'Total Cost': 3049.68, 'Plan Rows': 2353, 'Plan Width': 30, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 1.32, 'Total Cost': 3049.68, 'Plan Rows': 2353, 'Plan Width': 30, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = nation.n_nationkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 34}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.31, 'Total Cost': 1.31, 'Plan Rows': 1, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.0, 'Total Cost': 1.31, 'Plan Rows': 1, 'Plan Width': 4, 'Filter': ""(n_name = 'SAUDI ARABIA'::bpchar)""}]}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1436969.35, 'Total Cost': 1436969.35, 'Plan Rows': 8331396, 'Plan Width': 8, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'l3', 'Startup Cost': 0.0, 'Total Cost': 1436969.35, 'Plan Rows': 8331396, 'Plan Width': 8, 'Filter': '(l_receiptdate > l_commitdate)'}]}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1374483.88, 'Total Cost': 1374483.88, 'Plan Rows': 24994188, 'Plan Width': 8, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'l2', 'Startup Cost': 0.0, 'Total Cost': 1374483.88, 'Plan Rows': 24994188, 'Plan Width': 8}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 58, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]","[{'Plan': {'Node Type': 'Sort', 'Parallel Aware': False, 'Startup Cost': 4703941.17, 'Total Cost': 4703941.18, 'Plan Rows': 1, 'Plan Width': 34, 'Sort Key': ['(count(*)) DESC', 'supplier.s_name'], 'Plans': [{'Node Type': 'Aggregate', 'Strategy': 'Sorted', 'Partial Mode': 'Simple', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 4703941.14, 'Total Cost': 4703941.16, 'Plan Rows': 1, 'Plan Width': 34, 'Group Key': ['supplier.s_name'], 'Plans': [{'Node Type': 'Sort', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 4703941.14, 'Total Cost': 4703941.15, 'Plan Rows': 1, 'Plan Width': 26, 'Sort Key': ['supplier.s_name'], 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 3232102.19, 'Total Cost': 4703941.13, 'Plan Rows': 1, 'Plan Width': 26, 'Workers Planned': 2, 'Single Copy': False, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Semi', 'Startup Cost': 3231102.19, 'Total Cost': 4702941.03, 'Plan Rows': 1, 'Plan Width': 26, 'Inner Unique': False, 'Hash Cond': '(orders.o_orderkey = l2.l_orderkey)', 'Join Filter': '(l2.l_suppkey <> l1.l_suppkey)', 'Plans': [{'Node Type': 'Nested Loop', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 1544190.96, 'Total Cost': 3016029.8, 'Plan Rows': 1, 'Plan Width': 38, 'Inner Unique': False, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Anti', 'Startup Cost': 1544190.9, 'Total Cost': 3016029.65, 'Plan Rows': 1, 'Plan Width': 34, 'Inner Unique': False, 'Hash Cond': '(l1.l_orderkey = l3.l_orderkey)', 'Join Filter': '(l3.l_suppkey <> l1.l_suppkey)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Join Type': 'Inner', 'Startup Cost': 3079.09, 'Total Cost': 1473251.56, 'Plan Rows': 333256, 'Plan Width': 34, 'Inner Unique': False, 'Hash Cond': '(l1.l_suppkey = supplier.s_suppkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'l1', 'Startup Cost': 0.0, 'Total Cost': 1436969.35, 'Plan Rows': 8331396, 'Plan Width': 8, 'Filter': '(l_receiptdate > l_commitdate)'}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 3049.68, 'Total Cost': 3049.68, 'Plan Rows': 2353, 'Plan Width': 30, 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 1.32, 'Total Cost': 3049.68, 'Plan Rows': 2353, 'Plan Width': 30, 'Inner Unique': False, 'Hash Cond': '(supplier.s_nationkey = nation.n_nationkey)', 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'supplier', 'Alias': 'supplier', 'Startup Cost': 0.0, 'Total Cost': 2804.24, 'Plan Rows': 58824, 'Plan Width': 34}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 1.31, 'Total Cost': 1.31, 'Plan Rows': 1, 'Plan Width': 4, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Relation Name': 'nation', 'Alias': 'nation', 'Startup Cost': 0.0, 'Total Cost': 1.31, 'Plan Rows': 1, 'Plan Width': 4, 'Filter': ""(n_name = 'SAUDI ARABIA'::bpchar)""}]}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1436969.35, 'Total Cost': 1436969.35, 'Plan Rows': 8331396, 'Plan Width': 8, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'l3', 'Startup Cost': 0.0, 'Total Cost': 1436969.35, 'Plan Rows': 8331396, 'Plan Width': 8, 'Filter': '(l_receiptdate > l_commitdate)'}]}]}, {'Node Type': 'Index Scan', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': '<13411>btree_orders_o_orderkey', 'Relation Name': 'orders', 'Alias': 'orders', 'Startup Cost': 0.06, 'Total Cost': 0.14, 'Plan Rows': 1, 'Plan Width': 4, 'Index Cond': '(o_orderkey = l1.l_orderkey)', 'Filter': ""(o_orderstatus = 'F'::bpchar)""}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': True, 'Startup Cost': 1374483.88, 'Total Cost': 1374483.88, 'Plan Rows': 24994188, 'Plan Width': 8, 'Plans': [{'Node Type': 'Seq Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Relation Name': 'lineitem', 'Alias': 'l2', 'Startup Cost': 0.0, 'Total Cost': 1374483.88, 'Plan Rows': 24994188, 'Plan Width': 8}]}]}]}]}]}]}, 'JIT': {'Worker Number': -1, 'Functions': 53, 'Options': {'Inlining': True, 'Optimization': True, 'Expressions': True, 'Deforming': True}}}]"
